function ic(T){if(T.__esModule)return T;var A=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(T).forEach(function(E){var P=Object.getOwnPropertyDescriptor(T,E);Object.defineProperty(A,E,P.get?P:{enumerable:!0,get:function(){return T[E]}})}),A}var nc={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Jt=function(T,A){return Jt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,P){E.__proto__=P}||function(E,P){for(var x in P)P.hasOwnProperty(x)&&(E[x]=P[x])},Jt(T,A)};function he(T,A){Jt(T,A);function E(){this.constructor=T}T.prototype=A===null?Object.create(A):(E.prototype=A.prototype,new E)}function ot(T){return typeof T=="function"}var mi=!1,Fe={Promise:void 0,set useDeprecatedSynchronousErrorHandling(T){if(T){var A=new Error;""+A.stack}mi=T},get useDeprecatedSynchronousErrorHandling(){return mi}};function Ke(T){setTimeout(function(){throw T},0)}var At={closed:!0,next:function(T){},error:function(T){if(Fe.useDeprecatedSynchronousErrorHandling)throw T;Ke(T)},complete:function(){}},ze=function(){return Array.isArray||function(T){return T&&typeof T.length=="number"}}();function Qt(T){return T!==null&&typeof T=="object"}var sc=function(){function T(A){return Error.call(this),this.message=A?A.length+` errors occurred during unsubscription:
`+A.map(function(E,P){return P+1+") "+E.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=A,this}return T.prototype=Object.create(Error.prototype),T}(),ct=sc,xe=function(){function T(A){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,A&&(this._ctorUnsubscribe=!0,this._unsubscribe=A)}return T.prototype.unsubscribe=function(){var A;if(!this.closed){var E=this,P=E._parentOrParents,x=E._ctorUnsubscribe,c=E._unsubscribe,_=E._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,P instanceof T)P.remove(this);else if(P!==null)for(var d=0;d<P.length;++d){var l=P[d];l.remove(this)}if(ot(c)){x&&(this._unsubscribe=void 0);try{c.call(this)}catch(p){A=p instanceof ct?vi(p.errors):[p]}}if(ze(_))for(var d=-1,g=_.length;++d<g;){var v=_[d];if(Qt(v))try{v.unsubscribe()}catch(o){A=A||[],o instanceof ct?A=A.concat(vi(o.errors)):A.push(o)}}if(A)throw new ct(A)}},T.prototype.add=function(A){var E=A;if(!A)return T.EMPTY;switch(typeof A){case"function":E=new T(A);case"object":if(E===this||E.closed||typeof E.unsubscribe!="function")return E;if(this.closed)return E.unsubscribe(),E;if(!(E instanceof T)){var P=E;E=new T,E._subscriptions=[P]}break;default:throw new Error("unrecognized teardown "+A+" added to Subscription.")}var x=E._parentOrParents;if(x===null)E._parentOrParents=this;else if(x instanceof T){if(x===this)return E;E._parentOrParents=[x,this]}else if(x.indexOf(this)===-1)x.push(this);else return E;var c=this._subscriptions;return c===null?this._subscriptions=[E]:c.push(E),E},T.prototype.remove=function(A){var E=this._subscriptions;if(E){var P=E.indexOf(A);P!==-1&&E.splice(P,1)}},T.EMPTY=function(A){return A.closed=!0,A}(new T),T}();function vi(T){return T.reduce(function(A,E){return A.concat(E instanceof ct?E.errors:E)},[])}var St=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Me=function(T){he(A,T);function A(E,P,x){var c=T.call(this)||this;switch(c.syncErrorValue=null,c.syncErrorThrown=!1,c.syncErrorThrowable=!1,c.isStopped=!1,arguments.length){case 0:c.destination=At;break;case 1:if(!E){c.destination=At;break}if(typeof E=="object"){E instanceof A?(c.syncErrorThrowable=E.syncErrorThrowable,c.destination=E,E.add(c)):(c.syncErrorThrowable=!0,c.destination=new gi(c,E));break}default:c.syncErrorThrowable=!0,c.destination=new gi(c,E,P,x);break}return c}return A.prototype[St]=function(){return this},A.create=function(E,P,x){var c=new A(E,P,x);return c.syncErrorThrowable=!1,c},A.prototype.next=function(E){this.isStopped||this._next(E)},A.prototype.error=function(E){this.isStopped||(this.isStopped=!0,this._error(E))},A.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},A.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,T.prototype.unsubscribe.call(this))},A.prototype._next=function(E){this.destination.next(E)},A.prototype._error=function(E){this.destination.error(E),this.unsubscribe()},A.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},A.prototype._unsubscribeAndRecycle=function(){var E=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=E,this},A}(xe),gi=function(T){he(A,T);function A(E,P,x,c){var _=T.call(this)||this;_._parentSubscriber=E;var d,l=_;return ot(P)?d=P:P&&(d=P.next,x=P.error,c=P.complete,P!==At&&(l=Object.create(P),ot(l.unsubscribe)&&_.add(l.unsubscribe.bind(l)),l.unsubscribe=_.unsubscribe.bind(_))),_._context=l,_._next=d,_._error=x,_._complete=c,_}return A.prototype.next=function(E){if(!this.isStopped&&this._next){var P=this._parentSubscriber;!Fe.useDeprecatedSynchronousErrorHandling||!P.syncErrorThrowable?this.__tryOrUnsub(this._next,E):this.__tryOrSetError(P,this._next,E)&&this.unsubscribe()}},A.prototype.error=function(E){if(!this.isStopped){var P=this._parentSubscriber,x=Fe.useDeprecatedSynchronousErrorHandling;if(this._error)!x||!P.syncErrorThrowable?(this.__tryOrUnsub(this._error,E),this.unsubscribe()):(this.__tryOrSetError(P,this._error,E),this.unsubscribe());else if(P.syncErrorThrowable)x?(P.syncErrorValue=E,P.syncErrorThrown=!0):Ke(E),this.unsubscribe();else{if(this.unsubscribe(),x)throw E;Ke(E)}}},A.prototype.complete=function(){var E=this;if(!this.isStopped){var P=this._parentSubscriber;if(this._complete){var x=function(){return E._complete.call(E._context)};!Fe.useDeprecatedSynchronousErrorHandling||!P.syncErrorThrowable?(this.__tryOrUnsub(x),this.unsubscribe()):(this.__tryOrSetError(P,x),this.unsubscribe())}else this.unsubscribe()}},A.prototype.__tryOrUnsub=function(E,P){try{E.call(this._context,P)}catch(x){if(this.unsubscribe(),Fe.useDeprecatedSynchronousErrorHandling)throw x;Ke(x)}},A.prototype.__tryOrSetError=function(E,P,x){if(!Fe.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{P.call(this._context,x)}catch(c){return Fe.useDeprecatedSynchronousErrorHandling?(E.syncErrorValue=c,E.syncErrorThrown=!0,!0):(Ke(c),!0)}return!1},A.prototype._unsubscribe=function(){var E=this._parentSubscriber;this._context=null,this._parentSubscriber=null,E.unsubscribe()},A}(Me);function er(T){for(;T;){var A=T,E=A.closed,P=A.destination,x=A.isStopped;if(E||x)return!1;P&&P instanceof Me?T=P:T=null}return!0}function ac(T,A,E){if(T){if(T instanceof Me)return T;if(T[St])return T[St]()}return!T&&!A&&!E?new Me(At):new Me(T,A,E)}var Je=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function ut(T){return T}function oc(){for(var T=[],A=0;A<arguments.length;A++)T[A]=arguments[A];return bi(T)}function bi(T){return T.length===0?ut:T.length===1?T[0]:function(E){return T.reduce(function(P,x){return x(P)},E)}}var le=function(){function T(A){this._isScalar=!1,A&&(this._subscribe=A)}return T.prototype.lift=function(A){var E=new T;return E.source=this,E.operator=A,E},T.prototype.subscribe=function(A,E,P){var x=this.operator,c=ac(A,E,P);if(x?c.add(x.call(c,this.source)):c.add(this.source||Fe.useDeprecatedSynchronousErrorHandling&&!c.syncErrorThrowable?this._subscribe(c):this._trySubscribe(c)),Fe.useDeprecatedSynchronousErrorHandling&&c.syncErrorThrowable&&(c.syncErrorThrowable=!1,c.syncErrorThrown))throw c.syncErrorValue;return c},T.prototype._trySubscribe=function(A){try{return this._subscribe(A)}catch(E){Fe.useDeprecatedSynchronousErrorHandling&&(A.syncErrorThrown=!0,A.syncErrorValue=E),er(A)?A.error(E):console.warn(E)}},T.prototype.forEach=function(A,E){var P=this;return E=Ei(E),new E(function(x,c){var _;_=P.subscribe(function(d){try{A(d)}catch(l){c(l),_&&_.unsubscribe()}},c,x)})},T.prototype._subscribe=function(A){var E=this.source;return E&&E.subscribe(A)},T.prototype[Je]=function(){return this},T.prototype.pipe=function(){for(var A=[],E=0;E<arguments.length;E++)A[E]=arguments[E];return A.length===0?this:bi(A)(this)},T.prototype.toPromise=function(A){var E=this;return A=Ei(A),new A(function(P,x){var c;E.subscribe(function(_){return c=_},function(_){return x(_)},function(){return P(c)})})},T.create=function(A){return new T(A)},T}();function Ei(T){if(T||(T=Fe.Promise||Promise),!T)throw new Error("no Promise impl found");return T}var cc=function(){function T(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return T.prototype=Object.create(Error.prototype),T}(),Ve=cc,yi=function(T){he(A,T);function A(E,P){var x=T.call(this)||this;return x.subject=E,x.subscriber=P,x.closed=!1,x}return A.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var E=this.subject,P=E.observers;if(this.subject=null,!(!P||P.length===0||E.isStopped||E.closed)){var x=P.indexOf(this.subscriber);x!==-1&&P.splice(x,1)}}},A}(xe),xi=function(T){he(A,T);function A(E){var P=T.call(this,E)||this;return P.destination=E,P}return A}(Me),ht=function(T){he(A,T);function A(){var E=T.call(this)||this;return E.observers=[],E.closed=!1,E.isStopped=!1,E.hasError=!1,E.thrownError=null,E}return A.prototype[St]=function(){return new xi(this)},A.prototype.lift=function(E){var P=new Ti(this,this);return P.operator=E,P},A.prototype.next=function(E){if(this.closed)throw new Ve;if(!this.isStopped)for(var P=this.observers,x=P.length,c=P.slice(),_=0;_<x;_++)c[_].next(E)},A.prototype.error=function(E){if(this.closed)throw new Ve;this.hasError=!0,this.thrownError=E,this.isStopped=!0;for(var P=this.observers,x=P.length,c=P.slice(),_=0;_<x;_++)c[_].error(E);this.observers.length=0},A.prototype.complete=function(){if(this.closed)throw new Ve;this.isStopped=!0;for(var E=this.observers,P=E.length,x=E.slice(),c=0;c<P;c++)x[c].complete();this.observers.length=0},A.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},A.prototype._trySubscribe=function(E){if(this.closed)throw new Ve;return T.prototype._trySubscribe.call(this,E)},A.prototype._subscribe=function(E){if(this.closed)throw new Ve;return this.hasError?(E.error(this.thrownError),xe.EMPTY):this.isStopped?(E.complete(),xe.EMPTY):(this.observers.push(E),new yi(this,E))},A.prototype.asObservable=function(){var E=new le;return E.source=this,E},A.create=function(E,P){return new Ti(E,P)},A}(le),Ti=function(T){he(A,T);function A(E,P){var x=T.call(this)||this;return x.destination=E,x.source=P,x}return A.prototype.next=function(E){var P=this.destination;P&&P.next&&P.next(E)},A.prototype.error=function(E){var P=this.destination;P&&P.error&&this.destination.error(E)},A.prototype.complete=function(){var E=this.destination;E&&E.complete&&this.destination.complete()},A.prototype._subscribe=function(E){var P=this.source;return P?this.source.subscribe(E):xe.EMPTY},A}(ht);function uc(){return function(A){return A.lift(new hc(A))}}var hc=function(){function T(A){this.connectable=A}return T.prototype.call=function(A,E){var P=this.connectable;P._refCount++;var x=new lc(A,P),c=E.subscribe(x);return x.closed||(x.connection=P.connect()),c},T}(),lc=function(T){he(A,T);function A(E,P){var x=T.call(this,E)||this;return x.connectable=P,x}return A.prototype._unsubscribe=function(){var E=this.connectable;if(!E){this.connection=null;return}this.connectable=null;var P=E._refCount;if(P<=0){this.connection=null;return}if(E._refCount=P-1,P>1){this.connection=null;return}var x=this.connection,c=E._connection;this.connection=null,c&&(!x||c===x)&&c.unsubscribe()},A}(Me),dc=function(T){he(A,T);function A(E,P){var x=T.call(this)||this;return x.source=E,x.subjectFactory=P,x._refCount=0,x._isComplete=!1,x}return A.prototype._subscribe=function(E){return this.getSubject().subscribe(E)},A.prototype.getSubject=function(){var E=this._subject;return(!E||E.isStopped)&&(this._subject=this.subjectFactory()),this._subject},A.prototype.connect=function(){var E=this._connection;return E||(this._isComplete=!1,E=this._connection=new xe,E.add(this.source.subscribe(new fc(this.getSubject(),this))),E.closed&&(this._connection=null,E=xe.EMPTY)),E},A.prototype.refCount=function(){return uc()(this)},A}(le),fc=function(T){he(A,T);function A(E,P){var x=T.call(this,E)||this;return x.connectable=P,x}return A.prototype._error=function(E){this._unsubscribe(),T.prototype._error.call(this,E)},A.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),T.prototype._complete.call(this)},A.prototype._unsubscribe=function(){var E=this.connectable;if(E){this.connectable=null;var P=E._connection;E._refCount=0,E._subject=null,E._connection=null,P&&P.unsubscribe()}},A}(xi),_c=function(T){he(A,T);function A(E,P,x){var c=T.call(this)||this;return c.key=E,c.groupSubject=P,c.refCountSubscription=x,c}return A.prototype._subscribe=function(E){var P=new xe,x=this,c=x.refCountSubscription,_=x.groupSubject;return c&&!c.closed&&P.add(new pc(c)),P.add(_.subscribe(E)),P},A}(le),pc=function(T){he(A,T);function A(E){var P=T.call(this)||this;return P.parent=E,E.count++,P}return A.prototype.unsubscribe=function(){var E=this.parent;!E.closed&&!this.closed&&(T.prototype.unsubscribe.call(this),E.count-=1,E.count===0&&E.attemptedToUnsubscribe&&E.unsubscribe())},A}(xe),mc=function(T){he(A,T);function A(E){var P=T.call(this)||this;return P._value=E,P}return Object.defineProperty(A.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),A.prototype._subscribe=function(E){var P=T.prototype._subscribe.call(this,E);return P&&!P.closed&&E.next(this._value),P},A.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Ve;return this._value},A.prototype.next=function(E){T.prototype.next.call(this,this._value=E)},A}(ht),vc=function(T){he(A,T);function A(E,P){return T.call(this)||this}return A.prototype.schedule=function(E,P){return this},A}(xe),lt=function(T){he(A,T);function A(E,P){var x=T.call(this,E,P)||this;return x.scheduler=E,x.work=P,x.pending=!1,x}return A.prototype.schedule=function(E,P){if(P===void 0&&(P=0),this.closed)return this;this.state=E;var x=this.id,c=this.scheduler;return x!=null&&(this.id=this.recycleAsyncId(c,x,P)),this.pending=!0,this.delay=P,this.id=this.id||this.requestAsyncId(c,this.id,P),this},A.prototype.requestAsyncId=function(E,P,x){return x===void 0&&(x=0),setInterval(E.flush.bind(E,this),x)},A.prototype.recycleAsyncId=function(E,P,x){if(x===void 0&&(x=0),x!==null&&this.delay===x&&this.pending===!1)return P;clearInterval(P)},A.prototype.execute=function(E,P){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var x=this._execute(E,P);if(x)return x;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},A.prototype._execute=function(E,P){var x=!1,c=void 0;try{this.work(E)}catch(_){x=!0,c=!!_&&_||new Error(_)}if(x)return this.unsubscribe(),c},A.prototype._unsubscribe=function(){var E=this.id,P=this.scheduler,x=P.actions,c=x.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,c!==-1&&x.splice(c,1),E!=null&&(this.id=this.recycleAsyncId(P,E,null)),this.delay=null},A}(vc),gc=function(T){he(A,T);function A(E,P){var x=T.call(this,E,P)||this;return x.scheduler=E,x.work=P,x}return A.prototype.schedule=function(E,P){return P===void 0&&(P=0),P>0?T.prototype.schedule.call(this,E,P):(this.delay=P,this.state=E,this.scheduler.flush(this),this)},A.prototype.execute=function(E,P){return P>0||this.closed?T.prototype.execute.call(this,E,P):this._execute(E,P)},A.prototype.requestAsyncId=function(E,P,x){return x===void 0&&(x=0),x!==null&&x>0||x===null&&this.delay>0?T.prototype.requestAsyncId.call(this,E,P,x):E.flush(this)},A}(lt),tr=function(){function T(A,E){E===void 0&&(E=T.now),this.SchedulerAction=A,this.now=E}return T.prototype.schedule=function(A,E,P){return E===void 0&&(E=0),new this.SchedulerAction(this,A).schedule(P,E)},T.now=function(){return Date.now()},T}(),dt=function(T){he(A,T);function A(E,P){P===void 0&&(P=tr.now);var x=T.call(this,E,function(){return A.delegate&&A.delegate!==x?A.delegate.now():P()})||this;return x.actions=[],x.active=!1,x.scheduled=void 0,x}return A.prototype.schedule=function(E,P,x){return P===void 0&&(P=0),A.delegate&&A.delegate!==this?A.delegate.schedule(E,P,x):T.prototype.schedule.call(this,E,P,x)},A.prototype.flush=function(E){var P=this.actions;if(this.active){P.push(E);return}var x;this.active=!0;do if(x=E.execute(E.state,E.delay))break;while(E=P.shift());if(this.active=!1,x){for(;E=P.shift();)E.unsubscribe();throw x}},A}(tr),bc=function(T){he(A,T);function A(){return T!==null&&T.apply(this,arguments)||this}return A}(dt),Ai=new bc(gc),Si=Ai,Qe=new le(function(T){return T.complete()});function rr(T){return T?Ec(T):Qe}function Ec(T){return new le(function(A){return T.schedule(function(){return A.complete()})})}function Xe(T){return T&&typeof T.schedule=="function"}var Mi=function(T){return function(A){for(var E=0,P=T.length;E<P&&!A.closed;E++)A.next(T[E]);A.complete()}};function ir(T,A){return new le(function(E){var P=new xe,x=0;return P.add(A.schedule(function(){if(x===T.length){E.complete();return}E.next(T[x++]),E.closed||P.add(this.schedule())})),P})}function ft(T,A){return A?ir(T,A):new le(Mi(T))}function nr(){for(var T=[],A=0;A<arguments.length;A++)T[A]=arguments[A];var E=T[T.length-1];return Xe(E)?(T.pop(),ir(T,E)):ft(T)}function Ri(T,A){return A?new le(function(E){return A.schedule(yc,0,{error:T,subscriber:E})}):new le(function(E){return E.error(T)})}function yc(T){var A=T.error,E=T.subscriber;E.error(A)}var sr;sr||(sr={});var Mt=function(){function T(A,E,P){this.kind=A,this.value=E,this.error=P,this.hasValue=A==="N"}return T.prototype.observe=function(A){switch(this.kind){case"N":return A.next&&A.next(this.value);case"E":return A.error&&A.error(this.error);case"C":return A.complete&&A.complete()}},T.prototype.do=function(A,E,P){var x=this.kind;switch(x){case"N":return A&&A(this.value);case"E":return E&&E(this.error);case"C":return P&&P()}},T.prototype.accept=function(A,E,P){return A&&typeof A.next=="function"?this.observe(A):this.do(A,E,P)},T.prototype.toObservable=function(){var A=this.kind;switch(A){case"N":return nr(this.value);case"E":return Ri(this.error);case"C":return rr()}throw new Error("unexpected notification kind value")},T.createNext=function(A){return typeof A!="undefined"?new T("N",A):T.undefinedValueNotification},T.createError=function(A){return new T("E",void 0,A)},T.createComplete=function(){return T.completeNotification},T.completeNotification=new T("C"),T.undefinedValueNotification=new T("N",void 0),T}(),xc=function(T){he(A,T);function A(E,P,x){x===void 0&&(x=0);var c=T.call(this,E)||this;return c.scheduler=P,c.delay=x,c}return A.dispatch=function(E){var P=E.notification,x=E.destination;P.observe(x),this.unsubscribe()},A.prototype.scheduleMessage=function(E){var P=this.destination;P.add(this.scheduler.schedule(A.dispatch,this.delay,new Tc(E,this.destination)))},A.prototype._next=function(E){this.scheduleMessage(Mt.createNext(E))},A.prototype._error=function(E){this.scheduleMessage(Mt.createError(E)),this.unsubscribe()},A.prototype._complete=function(){this.scheduleMessage(Mt.createComplete()),this.unsubscribe()},A}(Me),Tc=function(){function T(A,E){this.notification=A,this.destination=E}return T}(),Ac=function(T){he(A,T);function A(E,P,x){E===void 0&&(E=Number.POSITIVE_INFINITY),P===void 0&&(P=Number.POSITIVE_INFINITY);var c=T.call(this)||this;return c.scheduler=x,c._events=[],c._infiniteTimeWindow=!1,c._bufferSize=E<1?1:E,c._windowTime=P<1?1:P,P===Number.POSITIVE_INFINITY?(c._infiniteTimeWindow=!0,c.next=c.nextInfiniteTimeWindow):c.next=c.nextTimeWindow,c}return A.prototype.nextInfiniteTimeWindow=function(E){if(!this.isStopped){var P=this._events;P.push(E),P.length>this._bufferSize&&P.shift()}T.prototype.next.call(this,E)},A.prototype.nextTimeWindow=function(E){this.isStopped||(this._events.push(new Sc(this._getNow(),E)),this._trimBufferThenGetEvents()),T.prototype.next.call(this,E)},A.prototype._subscribe=function(E){var P=this._infiniteTimeWindow,x=P?this._events:this._trimBufferThenGetEvents(),c=this.scheduler,_=x.length,d;if(this.closed)throw new Ve;if(this.isStopped||this.hasError?d=xe.EMPTY:(this.observers.push(E),d=new yi(this,E)),c&&E.add(E=new xc(E,c)),P)for(var l=0;l<_&&!E.closed;l++)E.next(x[l]);else for(var l=0;l<_&&!E.closed;l++)E.next(x[l].value);return this.hasError?E.error(this.thrownError):this.isStopped&&E.complete(),d},A.prototype._getNow=function(){return(this.scheduler||Si).now()},A.prototype._trimBufferThenGetEvents=function(){for(var E=this._getNow(),P=this._bufferSize,x=this._windowTime,c=this._events,_=c.length,d=0;d<_&&!(E-c[d].time<x);)d++;return _>P&&(d=Math.max(d,_-P)),d>0&&c.splice(0,d),c},A}(ht),Sc=function(){function T(A,E){this.time=A,this.value=E}return T}(),_t=function(T){he(A,T);function A(){var E=T!==null&&T.apply(this,arguments)||this;return E.value=null,E.hasNext=!1,E.hasCompleted=!1,E}return A.prototype._subscribe=function(E){return this.hasError?(E.error(this.thrownError),xe.EMPTY):this.hasCompleted&&this.hasNext?(E.next(this.value),E.complete(),xe.EMPTY):T.prototype._subscribe.call(this,E)},A.prototype.next=function(E){this.hasCompleted||(this.value=E,this.hasNext=!0)},A.prototype.error=function(E){this.hasCompleted||T.prototype.error.call(this,E)},A.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&T.prototype.next.call(this,this.value),T.prototype.complete.call(this)},A}(ht),Mc=1,Rc=function(){return Promise.resolve()}(),ar={};function wi(T){return T in ar?(delete ar[T],!0):!1}var Li={setImmediate:function(T){var A=Mc++;return ar[A]=!0,Rc.then(function(){return wi(A)&&T()}),A},clearImmediate:function(T){wi(T)}},wc=function(T){he(A,T);function A(E,P){var x=T.call(this,E,P)||this;return x.scheduler=E,x.work=P,x}return A.prototype.requestAsyncId=function(E,P,x){return x===void 0&&(x=0),x!==null&&x>0?T.prototype.requestAsyncId.call(this,E,P,x):(E.actions.push(this),E.scheduled||(E.scheduled=Li.setImmediate(E.flush.bind(E,null))))},A.prototype.recycleAsyncId=function(E,P,x){if(x===void 0&&(x=0),x!==null&&x>0||x===null&&this.delay>0)return T.prototype.recycleAsyncId.call(this,E,P,x);E.actions.length===0&&(Li.clearImmediate(P),E.scheduled=void 0)},A}(lt),Lc=function(T){he(A,T);function A(){return T!==null&&T.apply(this,arguments)||this}return A.prototype.flush=function(E){this.active=!0,this.scheduled=void 0;var P=this.actions,x,c=-1,_=P.length;E=E||P.shift();do if(x=E.execute(E.state,E.delay))break;while(++c<_&&(E=P.shift()));if(this.active=!1,x){for(;++c<_&&(E=P.shift());)E.unsubscribe();throw x}},A}(dt),Pi=new Lc(wc),Pc=Pi,Oi=new dt(lt),Rt=Oi,Oc=function(T){he(A,T);function A(E,P){var x=T.call(this,E,P)||this;return x.scheduler=E,x.work=P,x}return A.prototype.requestAsyncId=function(E,P,x){return x===void 0&&(x=0),x!==null&&x>0?T.prototype.requestAsyncId.call(this,E,P,x):(E.actions.push(this),E.scheduled||(E.scheduled=requestAnimationFrame(function(){return E.flush(null)})))},A.prototype.recycleAsyncId=function(E,P,x){if(x===void 0&&(x=0),x!==null&&x>0||x===null&&this.delay>0)return T.prototype.recycleAsyncId.call(this,E,P,x);E.actions.length===0&&(cancelAnimationFrame(P),E.scheduled=void 0)},A}(lt),Ic=function(T){he(A,T);function A(){return T!==null&&T.apply(this,arguments)||this}return A.prototype.flush=function(E){this.active=!0,this.scheduled=void 0;var P=this.actions,x,c=-1,_=P.length;E=E||P.shift();do if(x=E.execute(E.state,E.delay))break;while(++c<_&&(E=P.shift()));if(this.active=!1,x){for(;++c<_&&(E=P.shift());)E.unsubscribe();throw x}},A}(dt),Ii=new Ic(Oc),Fc=Ii,zc=function(T){he(A,T);function A(E,P){E===void 0&&(E=Fi),P===void 0&&(P=Number.POSITIVE_INFINITY);var x=T.call(this,E,function(){return x.frame})||this;return x.maxFrames=P,x.frame=0,x.index=-1,x}return A.prototype.flush=function(){for(var E=this,P=E.actions,x=E.maxFrames,c,_;(_=P[0])&&_.delay<=x&&(P.shift(),this.frame=_.delay,!(c=_.execute(_.state,_.delay))););if(c){for(;_=P.shift();)_.unsubscribe();throw c}},A.frameTimeFactor=10,A}(dt),Fi=function(T){he(A,T);function A(E,P,x){x===void 0&&(x=E.index+=1);var c=T.call(this,E,P)||this;return c.scheduler=E,c.work=P,c.index=x,c.active=!0,c.index=E.index=x,c}return A.prototype.schedule=function(E,P){if(P===void 0&&(P=0),!this.id)return T.prototype.schedule.call(this,E,P);this.active=!1;var x=new A(this.scheduler,this.work);return this.add(x),x.schedule(E,P)},A.prototype.requestAsyncId=function(E,P,x){x===void 0&&(x=0),this.delay=E.frame+x;var c=E.actions;return c.push(this),c.sort(A.sortActions),!0},A.prototype.recycleAsyncId=function(E,P,x){},A.prototype._execute=function(E,P){if(this.active===!0)return T.prototype._execute.call(this,E,P)},A.sortActions=function(E,P){return E.delay===P.delay?E.index===P.index?0:E.index>P.index?1:-1:E.delay>P.delay?1:-1},A}(lt);function zi(){}function Nc(T){return!!T&&(T instanceof le||typeof T.lift=="function"&&typeof T.subscribe=="function")}var Cc=function(){function T(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return T.prototype=Object.create(Error.prototype),T}(),Bc=Cc,Dc=function(){function T(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return T.prototype=Object.create(Error.prototype),T}(),Gc=Dc,jc=function(){function T(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return T.prototype=Object.create(Error.prototype),T}(),Uc=jc;function et(T,A){return function(P){if(typeof T!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return P.lift(new kc(T,A))}}var kc=function(){function T(A,E){this.project=A,this.thisArg=E}return T.prototype.call=function(A,E){return E.subscribe(new Vc(A,this.project,this.thisArg))},T}(),Vc=function(T){he(A,T);function A(E,P,x){var c=T.call(this,E)||this;return c.project=P,c.count=0,c.thisArg=x||c,c}return A.prototype._next=function(E){var P;try{P=this.project.call(this.thisArg,E,this.count++)}catch(x){this.destination.error(x);return}this.destination.next(P)},A}(Me);function Ni(T,A,E){if(A)if(Xe(A))E=A;else return function(){for(var P=[],x=0;x<arguments.length;x++)P[x]=arguments[x];return Ni(T,E).apply(void 0,P).pipe(et(function(c){return ze(c)?A.apply(void 0,c):A(c)}))};return function(){for(var P=[],x=0;x<arguments.length;x++)P[x]=arguments[x];var c=this,_,d={context:c,subject:_,callbackFunc:T,scheduler:E};return new le(function(l){if(E){var v={args:P,subscriber:l,params:d};return E.schedule(Xc,0,v)}else{if(!_){_=new _t;var g=function(){for(var p=[],o=0;o<arguments.length;o++)p[o]=arguments[o];_.next(p.length<=1?p[0]:p),_.complete()};try{T.apply(c,P.concat([g]))}catch(p){er(_)?_.error(p):console.warn(p)}}return _.subscribe(l)}})}}function Xc(T){var A=this,E=T.args,P=T.subscriber,x=T.params,c=x.callbackFunc,_=x.context,d=x.scheduler,l=x.subject;if(!l){l=x.subject=new _t;var g=function(){for(var v=[],p=0;p<arguments.length;p++)v[p]=arguments[p];var o=v.length<=1?v[0]:v;A.add(d.schedule(Wc,0,{value:o,subject:l}))};try{c.apply(_,E.concat([g]))}catch(v){l.error(v)}}this.add(l.subscribe(P))}function Wc(T){var A=T.value,E=T.subject;E.next(A),E.complete()}function Ci(T,A,E){if(A)if(Xe(A))E=A;else return function(){for(var P=[],x=0;x<arguments.length;x++)P[x]=arguments[x];return Ci(T,E).apply(void 0,P).pipe(et(function(c){return ze(c)?A.apply(void 0,c):A(c)}))};return function(){for(var P=[],x=0;x<arguments.length;x++)P[x]=arguments[x];var c={subject:void 0,args:P,callbackFunc:T,scheduler:E,context:this};return new le(function(_){var d=c.context,l=c.subject;if(E)return E.schedule(Hc,0,{params:c,subscriber:_,context:d});if(!l){l=c.subject=new _t;var g=function(){for(var v=[],p=0;p<arguments.length;p++)v[p]=arguments[p];var o=v.shift();if(o){l.error(o);return}l.next(v.length<=1?v[0]:v),l.complete()};try{T.apply(d,P.concat([g]))}catch(v){er(l)?l.error(v):console.warn(v)}}return l.subscribe(_)})}}function Hc(T){var A=this,E=T.params,P=T.subscriber,x=T.context,c=E.callbackFunc,_=E.args,d=E.scheduler,l=E.subject;if(!l){l=E.subject=new _t;var g=function(){for(var v=[],p=0;p<arguments.length;p++)v[p]=arguments[p];var o=v.shift();if(o)A.add(d.schedule(Bi,0,{err:o,subject:l}));else{var r=v.length<=1?v[0]:v;A.add(d.schedule($c,0,{value:r,subject:l}))}};try{c.apply(x,_.concat([g]))}catch(v){this.add(d.schedule(Bi,0,{err:v,subject:l}))}}this.add(l.subscribe(P))}function $c(T){var A=T.value,E=T.subject;E.next(A),E.complete()}function Bi(T){var A=T.err,E=T.subject;E.error(A)}var Di=function(T){he(A,T);function A(){return T!==null&&T.apply(this,arguments)||this}return A.prototype.notifyNext=function(E,P,x,c,_){this.destination.next(P)},A.prototype.notifyError=function(E,P){this.destination.error(E)},A.prototype.notifyComplete=function(E){this.destination.complete()},A}(Me),qc=function(T){he(A,T);function A(E,P,x){var c=T.call(this)||this;return c.parent=E,c.outerValue=P,c.outerIndex=x,c.index=0,c}return A.prototype._next=function(E){this.parent.notifyNext(this.outerValue,E,this.outerIndex,this.index++,this)},A.prototype._error=function(E){this.parent.notifyError(E,this),this.unsubscribe()},A.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},A}(Me),Yc=function(T){return function(A){return T.then(function(E){A.closed||(A.next(E),A.complete())},function(E){return A.error(E)}).then(null,Ke),A}};function Zc(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var We=Zc(),Kc=function(T){return function(A){var E=T[We]();do{var P=void 0;try{P=E.next()}catch(x){return A.error(x),A}if(P.done){A.complete();break}if(A.next(P.value),A.closed)break}while(!0);return typeof E.return=="function"&&A.add(function(){E.return&&E.return()}),A}},Jc=function(T){return function(A){var E=T[Je]();if(typeof E.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return E.subscribe(A)}},Gi=function(T){return T&&typeof T.length=="number"&&typeof T!="function"};function ji(T){return!!T&&typeof T.subscribe!="function"&&typeof T.then=="function"}var pt=function(T){if(!!T&&typeof T[Je]=="function")return Jc(T);if(Gi(T))return Mi(T);if(ji(T))return Yc(T);if(!!T&&typeof T[We]=="function")return Kc(T);var A=Qt(T)?"an invalid object":"'"+T+"'",E="You provided "+A+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(E)};function Ui(T,A,E,P,x){if(x===void 0&&(x=new qc(T,E,P)),!x.closed)return A instanceof le?A.subscribe(x):pt(A)(x)}var ki={};function Qc(){for(var T=[],A=0;A<arguments.length;A++)T[A]=arguments[A];var E=void 0,P=void 0;return Xe(T[T.length-1])&&(P=T.pop()),typeof T[T.length-1]=="function"&&(E=T.pop()),T.length===1&&ze(T[0])&&(T=T[0]),ft(T,P).lift(new eu(E))}var eu=function(){function T(A){this.resultSelector=A}return T.prototype.call=function(A,E){return E.subscribe(new tu(A,this.resultSelector))},T}(),tu=function(T){he(A,T);function A(E,P){var x=T.call(this,E)||this;return x.resultSelector=P,x.active=0,x.values=[],x.observables=[],x}return A.prototype._next=function(E){this.values.push(ki),this.observables.push(E)},A.prototype._complete=function(){var E=this.observables,P=E.length;if(P===0)this.destination.complete();else{this.active=P,this.toRespond=P;for(var x=0;x<P;x++){var c=E[x];this.add(Ui(this,c,void 0,x))}}},A.prototype.notifyComplete=function(E){(this.active-=1)==0&&this.destination.complete()},A.prototype.notifyNext=function(E,P,x){var c=this.values,_=c[x],d=this.toRespond?_===ki?--this.toRespond:this.toRespond:0;c[x]=P,d===0&&(this.resultSelector?this._tryResultSelector(c):this.destination.next(c.slice()))},A.prototype._tryResultSelector=function(E){var P;try{P=this.resultSelector.apply(this,E)}catch(x){this.destination.error(x);return}this.destination.next(P)},A}(Di);function ru(T,A){return new le(function(E){var P=new xe;return P.add(A.schedule(function(){var x=T[Je]();P.add(x.subscribe({next:function(c){P.add(A.schedule(function(){return E.next(c)}))},error:function(c){P.add(A.schedule(function(){return E.error(c)}))},complete:function(){P.add(A.schedule(function(){return E.complete()}))}}))})),P})}function iu(T,A){return new le(function(E){var P=new xe;return P.add(A.schedule(function(){return T.then(function(x){P.add(A.schedule(function(){E.next(x),P.add(A.schedule(function(){return E.complete()}))}))},function(x){P.add(A.schedule(function(){return E.error(x)}))})})),P})}function nu(T,A){if(!T)throw new Error("Iterable cannot be null");return new le(function(E){var P=new xe,x;return P.add(function(){x&&typeof x.return=="function"&&x.return()}),P.add(A.schedule(function(){x=T[We](),P.add(A.schedule(function(){if(!E.closed){var c,_;try{var d=x.next();c=d.value,_=d.done}catch(l){E.error(l);return}_?E.complete():(E.next(c),this.schedule())}}))})),P})}function su(T){return T&&typeof T[Je]=="function"}function au(T){return T&&typeof T[We]=="function"}function Vi(T,A){if(T!=null){if(su(T))return ru(T,A);if(ji(T))return iu(T,A);if(Gi(T))return ir(T,A);if(au(T)||typeof T=="string")return nu(T,A)}throw new TypeError((T!==null&&typeof T||T)+" is not observable")}function tt(T,A){return A?Vi(T,A):T instanceof le?T:new le(pt(T))}var Xi=function(T){he(A,T);function A(E){var P=T.call(this)||this;return P.parent=E,P}return A.prototype._next=function(E){this.parent.notifyNext(E)},A.prototype._error=function(E){this.parent.notifyError(E),this.unsubscribe()},A.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},A}(Me),Wi=function(T){he(A,T);function A(){return T!==null&&T.apply(this,arguments)||this}return A.prototype.notifyNext=function(E){this.destination.next(E)},A.prototype.notifyError=function(E){this.destination.error(E)},A.prototype.notifyComplete=function(){this.destination.complete()},A}(Me);function Hi(T,A){if(!A.closed){if(T instanceof le)return T.subscribe(A);var E;try{E=pt(T)(A)}catch(P){A.error(P)}return E}}function $i(T,A,E){return E===void 0&&(E=Number.POSITIVE_INFINITY),typeof A=="function"?function(P){return P.pipe($i(function(x,c){return tt(T(x,c)).pipe(et(function(_,d){return A(x,_,c,d)}))},E))}:(typeof A=="number"&&(E=A),function(P){return P.lift(new ou(T,E))})}var ou=function(){function T(A,E){E===void 0&&(E=Number.POSITIVE_INFINITY),this.project=A,this.concurrent=E}return T.prototype.call=function(A,E){return E.subscribe(new cu(A,this.project,this.concurrent))},T}(),cu=function(T){he(A,T);function A(E,P,x){x===void 0&&(x=Number.POSITIVE_INFINITY);var c=T.call(this,E)||this;return c.project=P,c.concurrent=x,c.hasCompleted=!1,c.buffer=[],c.active=0,c.index=0,c}return A.prototype._next=function(E){this.active<this.concurrent?this._tryNext(E):this.buffer.push(E)},A.prototype._tryNext=function(E){var P,x=this.index++;try{P=this.project(E,x)}catch(c){this.destination.error(c);return}this.active++,this._innerSub(P)},A.prototype._innerSub=function(E){var P=new Xi(this),x=this.destination;x.add(P);var c=Hi(E,P);c!==P&&x.add(c)},A.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},A.prototype.notifyNext=function(E){this.destination.next(E)},A.prototype.notifyComplete=function(){var E=this.buffer;this.active--,E.length>0?this._next(E.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},A}(Wi);function qi(T){return T===void 0&&(T=Number.POSITIVE_INFINITY),$i(ut,T)}function uu(){return qi(1)}function hu(){for(var T=[],A=0;A<arguments.length;A++)T[A]=arguments[A];return uu()(nr.apply(void 0,T))}function Yi(T){return new le(function(A){var E;try{E=T()}catch(x){A.error(x);return}var P=E?tt(E):rr();return P.subscribe(A)})}function lu(){for(var T=[],A=0;A<arguments.length;A++)T[A]=arguments[A];if(T.length===1){var E=T[0];if(ze(E))return wt(E,null);if(Qt(E)&&Object.getPrototypeOf(E)===Object.prototype){var P=Object.keys(E);return wt(P.map(function(c){return E[c]}),P)}}if(typeof T[T.length-1]=="function"){var x=T.pop();return T=T.length===1&&ze(T[0])?T[0]:T,wt(T,null).pipe(et(function(c){return x.apply(void 0,c)}))}return wt(T,null)}function wt(T,A){return new le(function(E){var P=T.length;if(P===0){E.complete();return}for(var x=new Array(P),c=0,_=0,d=function(g){var v=tt(T[g]),p=!1;E.add(v.subscribe({next:function(o){p||(p=!0,_++),x[g]=o},error:function(o){return E.error(o)},complete:function(){c++,(c===P||!p)&&(_===P&&E.next(A?A.reduce(function(o,r,n){return o[r]=x[n],o},{}):x),E.complete())}}))},l=0;l<P;l++)d(l)})}function Zi(T,A,E,P){return ot(E)&&(P=E,E=void 0),P?Zi(T,A,E).pipe(et(function(x){return ze(x)?P.apply(void 0,x):P(x)})):new le(function(x){function c(_){arguments.length>1?x.next(Array.prototype.slice.call(arguments)):x.next(_)}Ki(T,A,c,x,E)})}function Ki(T,A,E,P,x){var c;if(_u(T)){var _=T;T.addEventListener(A,E,x),c=function(){return _.removeEventListener(A,E,x)}}else if(fu(T)){var d=T;T.on(A,E),c=function(){return d.off(A,E)}}else if(du(T)){var l=T;T.addListener(A,E),c=function(){return l.removeListener(A,E)}}else if(T&&T.length)for(var g=0,v=T.length;g<v;g++)Ki(T[g],A,E,P,x);else throw new TypeError("Invalid event target");P.add(c)}function du(T){return T&&typeof T.addListener=="function"&&typeof T.removeListener=="function"}function fu(T){return T&&typeof T.on=="function"&&typeof T.off=="function"}function _u(T){return T&&typeof T.addEventListener=="function"&&typeof T.removeEventListener=="function"}function Ji(T,A,E){return E?Ji(T,A).pipe(et(function(P){return ze(P)?E.apply(void 0,P):E(P)})):new le(function(P){var x=function(){for(var _=[],d=0;d<arguments.length;d++)_[d]=arguments[d];return P.next(_.length===1?_[0]:_)},c;try{c=T(x)}catch(_){P.error(_);return}if(!!ot(A))return function(){return A(x,c)}})}function pu(T,A,E,P,x){var c,_;if(arguments.length==1){var d=T;_=d.initialState,A=d.condition,E=d.iterate,c=d.resultSelector||ut,x=d.scheduler}else P===void 0||Xe(P)?(_=T,c=ut,x=P):(_=T,c=P);return new le(function(l){var g=_;if(x)return x.schedule(mu,0,{subscriber:l,iterate:E,condition:A,resultSelector:c,state:g});do{if(A){var v=void 0;try{v=A(g)}catch(o){l.error(o);return}if(!v){l.complete();break}}var p=void 0;try{p=c(g)}catch(o){l.error(o);return}if(l.next(p),l.closed)break;try{g=E(g)}catch(o){l.error(o);return}}while(!0)})}function mu(T){var A=T.subscriber,E=T.condition;if(!A.closed){if(T.needIterate)try{T.state=T.iterate(T.state)}catch(c){A.error(c);return}else T.needIterate=!0;if(E){var P=void 0;try{P=E(T.state)}catch(c){A.error(c);return}if(!P){A.complete();return}if(A.closed)return}var x;try{x=T.resultSelector(T.state)}catch(c){A.error(c);return}if(!A.closed&&(A.next(x),!A.closed))return this.schedule(T)}}function vu(T,A,E){return A===void 0&&(A=Qe),E===void 0&&(E=Qe),Yi(function(){return T()?A:E})}function or(T){return!ze(T)&&T-parseFloat(T)+1>=0}function gu(T,A){return T===void 0&&(T=0),A===void 0&&(A=Rt),(!or(T)||T<0)&&(T=0),(!A||typeof A.schedule!="function")&&(A=Rt),new le(function(E){return E.add(A.schedule(bu,T,{subscriber:E,counter:0,period:T})),E})}function bu(T){var A=T.subscriber,E=T.counter,P=T.period;A.next(E),this.schedule({subscriber:A,counter:E+1,period:P},P)}function Eu(){for(var T=[],A=0;A<arguments.length;A++)T[A]=arguments[A];var E=Number.POSITIVE_INFINITY,P=null,x=T[T.length-1];return Xe(x)?(P=T.pop(),T.length>1&&typeof T[T.length-1]=="number"&&(E=T.pop())):typeof x=="number"&&(E=T.pop()),P===null&&T.length===1&&T[0]instanceof le?T[0]:qi(E)(ft(T,P))}var Qi=new le(zi);function yu(){return Qi}function cr(){for(var T=[],A=0;A<arguments.length;A++)T[A]=arguments[A];if(T.length===0)return Qe;var E=T[0],P=T.slice(1);return T.length===1&&ze(E)?cr.apply(void 0,E):new le(function(x){var c=function(){return x.add(cr.apply(void 0,P).subscribe(x))};return tt(E).subscribe({next:function(_){x.next(_)},error:c,complete:c})})}function xu(T,A){return A?new le(function(E){var P=Object.keys(T),x=new xe;return x.add(A.schedule(Tu,0,{keys:P,index:0,subscriber:E,subscription:x,obj:T})),x}):new le(function(E){for(var P=Object.keys(T),x=0;x<P.length&&!E.closed;x++){var c=P[x];T.hasOwnProperty(c)&&E.next([c,T[c]])}E.complete()})}function Tu(T){var A=T.keys,E=T.index,P=T.subscriber,x=T.subscription,c=T.obj;if(!P.closed)if(E<A.length){var _=A[E];P.next([_,c[_]]),x.add(this.schedule({keys:A,index:E+1,subscriber:P,subscription:x,obj:c}))}else P.complete()}function Au(T,A){function E(){return!E.pred.apply(E.thisArg,arguments)}return E.pred=T,E.thisArg=A,E}function en(T,A){return function(P){return P.lift(new Su(T,A))}}var Su=function(){function T(A,E){this.predicate=A,this.thisArg=E}return T.prototype.call=function(A,E){return E.subscribe(new Mu(A,this.predicate,this.thisArg))},T}(),Mu=function(T){he(A,T);function A(E,P,x){var c=T.call(this,E)||this;return c.predicate=P,c.thisArg=x,c.count=0,c}return A.prototype._next=function(E){var P;try{P=this.predicate.call(this.thisArg,E,this.count++)}catch(x){this.destination.error(x);return}P&&this.destination.next(E)},A}(Me);function Ru(T,A,E){return[en(A,E)(new le(pt(T))),en(Au(A,E))(new le(pt(T)))]}function wu(){for(var T=[],A=0;A<arguments.length;A++)T[A]=arguments[A];if(T.length===1)if(ze(T[0]))T=T[0];else return T[0];return ft(T,void 0).lift(new Lu)}var Lu=function(){function T(){}return T.prototype.call=function(A,E){return E.subscribe(new Pu(A))},T}(),Pu=function(T){he(A,T);function A(E){var P=T.call(this,E)||this;return P.hasFirst=!1,P.observables=[],P.subscriptions=[],P}return A.prototype._next=function(E){this.observables.push(E)},A.prototype._complete=function(){var E=this.observables,P=E.length;if(P===0)this.destination.complete();else{for(var x=0;x<P&&!this.hasFirst;x++){var c=E[x],_=Ui(this,c,void 0,x);this.subscriptions&&this.subscriptions.push(_),this.add(_)}this.observables=null}},A.prototype.notifyNext=function(E,P,x){if(!this.hasFirst){this.hasFirst=!0;for(var c=0;c<this.subscriptions.length;c++)if(c!==x){var _=this.subscriptions[c];_.unsubscribe(),this.remove(_)}this.subscriptions=null}this.destination.next(P)},A}(Di);function Ou(T,A,E){return T===void 0&&(T=0),new le(function(P){A===void 0&&(A=T,T=0);var x=0,c=T;if(E)return E.schedule(Iu,0,{index:x,count:A,start:T,subscriber:P});do{if(x++>=A){P.complete();break}if(P.next(c++),P.closed)break}while(!0)})}function Iu(T){var A=T.start,E=T.index,P=T.count,x=T.subscriber;if(E>=P){x.complete();return}x.next(A),!x.closed&&(T.index=E+1,T.start=A+1,this.schedule(T))}function Fu(T,A,E){T===void 0&&(T=0);var P=-1;return or(A)?P=Number(A)<1&&1||Number(A):Xe(A)&&(E=A),Xe(E)||(E=Rt),new le(function(x){var c=or(T)?T:+T-E.now();return E.schedule(zu,c,{index:0,period:P,subscriber:x})})}function zu(T){var A=T.index,E=T.period,P=T.subscriber;if(P.next(A),!P.closed){if(E===-1)return P.complete();T.index=A+1,this.schedule(T,E)}}function Nu(T,A){return new le(function(E){var P;try{P=T()}catch(d){E.error(d);return}var x;try{x=A(P)}catch(d){E.error(d);return}var c=x?tt(x):Qe,_=c.subscribe(E);return function(){_.unsubscribe(),P&&P.unsubscribe()}})}function Cu(){for(var T=[],A=0;A<arguments.length;A++)T[A]=arguments[A];var E=T[T.length-1];return typeof E=="function"&&T.pop(),ft(T,void 0).lift(new Bu(E))}var Bu=function(){function T(A){this.resultSelector=A}return T.prototype.call=function(A,E){return E.subscribe(new Du(A,this.resultSelector))},T}(),Du=function(T){he(A,T);function A(E,P,x){var c=T.call(this,E)||this;return c.resultSelector=P,c.iterators=[],c.active=0,c.resultSelector=typeof P=="function"?P:void 0,c}return A.prototype._next=function(E){var P=this.iterators;ze(E)?P.push(new ju(E)):typeof E[We]=="function"?P.push(new Gu(E[We]())):P.push(new Uu(this.destination,this,E))},A.prototype._complete=function(){var E=this.iterators,P=E.length;if(this.unsubscribe(),P===0){this.destination.complete();return}this.active=P;for(var x=0;x<P;x++){var c=E[x];if(c.stillUnsubscribed){var _=this.destination;_.add(c.subscribe())}else this.active--}},A.prototype.notifyInactive=function(){this.active--,this.active===0&&this.destination.complete()},A.prototype.checkIterators=function(){for(var E=this.iterators,P=E.length,x=this.destination,c=0;c<P;c++){var _=E[c];if(typeof _.hasValue=="function"&&!_.hasValue())return}for(var d=!1,l=[],c=0;c<P;c++){var _=E[c],g=_.next();if(_.hasCompleted()&&(d=!0),g.done){x.complete();return}l.push(g.value)}this.resultSelector?this._tryresultSelector(l):x.next(l),d&&x.complete()},A.prototype._tryresultSelector=function(E){var P;try{P=this.resultSelector.apply(this,E)}catch(x){this.destination.error(x);return}this.destination.next(P)},A}(Me),Gu=function(){function T(A){this.iterator=A,this.nextResult=A.next()}return T.prototype.hasValue=function(){return!0},T.prototype.next=function(){var A=this.nextResult;return this.nextResult=this.iterator.next(),A},T.prototype.hasCompleted=function(){var A=this.nextResult;return Boolean(A&&A.done)},T}(),ju=function(){function T(A){this.array=A,this.index=0,this.length=0,this.length=A.length}return T.prototype[We]=function(){return this},T.prototype.next=function(A){var E=this.index++,P=this.array;return E<this.length?{value:P[E],done:!1}:{value:null,done:!0}},T.prototype.hasValue=function(){return this.array.length>this.index},T.prototype.hasCompleted=function(){return this.array.length===this.index},T}(),Uu=function(T){he(A,T);function A(E,P,x){var c=T.call(this,E)||this;return c.parent=P,c.observable=x,c.stillUnsubscribed=!0,c.buffer=[],c.isComplete=!1,c}return A.prototype[We]=function(){return this},A.prototype.next=function(){var E=this.buffer;return E.length===0&&this.isComplete?{value:null,done:!0}:{value:E.shift(),done:!1}},A.prototype.hasValue=function(){return this.buffer.length>0},A.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete},A.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},A.prototype.notifyNext=function(E){this.buffer.push(E),this.parent.checkIterators()},A.prototype.subscribe=function(){return Hi(this.observable,new Xi(this))},A}(Wi),ku=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Observable:le,ConnectableObservable:dc,GroupedObservable:_c,observable:Je,Subject:ht,BehaviorSubject:mc,ReplaySubject:Ac,AsyncSubject:_t,asap:Pc,asapScheduler:Pi,async:Rt,asyncScheduler:Oi,queue:Si,queueScheduler:Ai,animationFrame:Fc,animationFrameScheduler:Ii,VirtualTimeScheduler:zc,VirtualAction:Fi,Scheduler:tr,Subscription:xe,Subscriber:Me,Notification:Mt,get NotificationKind(){return sr},pipe:oc,noop:zi,identity:ut,isObservable:Nc,ArgumentOutOfRangeError:Bc,EmptyError:Gc,ObjectUnsubscribedError:Ve,UnsubscriptionError:ct,TimeoutError:Uc,bindCallback:Ni,bindNodeCallback:Ci,combineLatest:Qc,concat:hu,defer:Yi,empty:rr,forkJoin:lu,from:tt,fromEvent:Zi,fromEventPattern:Ji,generate:pu,iif:vu,interval:gu,merge:Eu,never:yu,of:nr,onErrorResumeNext:cr,pairs:xu,partition:Ru,race:wu,range:Ou,throwError:Ri,timer:Fu,using:Nu,zip:Cu,scheduled:Vi,EMPTY:Qe,NEVER:Qi,config:Fe}),Vu=ic(ku);(()=>{var T={3659:(x,c,_)=>{_.r(c),_.d(c,{glMatrix:()=>d,mat2:()=>l,mat2d:()=>g,mat3:()=>v,mat4:()=>p,quat:()=>n,quat2:()=>i,vec2:()=>u,vec3:()=>o,vec4:()=>r});var d={};_.r(d),_.d(d,{ARRAY_TYPE:()=>a,EPSILON:()=>s,RANDOM:()=>h,equals:()=>S,setMatrixArrayType:()=>b,toRadian:()=>M});var l={};_.r(l),_.d(l,{LDU:()=>pe,add:()=>Oe,adjoint:()=>Z,clone:()=>N,copy:()=>F,create:()=>w,determinant:()=>J,equals:()=>Ae,exactEquals:()=>Re,frob:()=>Te,fromRotation:()=>ue,fromScaling:()=>ie,fromValues:()=>X,identity:()=>k,invert:()=>Y,mul:()=>Le,multiply:()=>ee,multiplyScalar:()=>He,multiplyScalarAndAdd:()=>Ie,rotate:()=>K,scale:()=>re,set:()=>$,str:()=>de,sub:()=>Pe,subtract:()=>Q,transpose:()=>V});var g={};_.r(g),_.d(g,{add:()=>Nt,clone:()=>rt,copy:()=>Ge,create:()=>De,determinant:()=>Ye,equals:()=>Bt,exactEquals:()=>Ze,frob:()=>zt,fromRotation:()=>Ot,fromScaling:()=>It,fromTranslation:()=>Ft,fromValues:()=>qe,identity:()=>$e,invert:()=>it,mul:()=>Dt,multiply:()=>mt,multiplyScalar:()=>Ct,multiplyScalarAndAdd:()=>nt,rotate:()=>Lt,scale:()=>Pt,set:()=>ke,str:()=>gt,sub:()=>Gt,subtract:()=>bt,translate:()=>vt});var v={};_.r(v),_.d(v,{add:()=>yn,adjoint:()=>on,clone:()=>we,copy:()=>je,create:()=>be,determinant:()=>cn,equals:()=>Sn,exactEquals:()=>An,frob:()=>En,fromMat2d:()=>pn,fromMat4:()=>Se,fromQuat:()=>mn,fromRotation:()=>fn,fromScaling:()=>_n,fromTranslation:()=>dn,fromValues:()=>tn,identity:()=>nn,invert:()=>an,mul:()=>Mn,multiply:()=>ur,multiplyScalar:()=>xn,multiplyScalarAndAdd:()=>Tn,normalFromMat4:()=>vn,projection:()=>gn,rotate:()=>hn,scale:()=>ln,set:()=>rn,str:()=>bn,sub:()=>Rn,subtract:()=>hr,translate:()=>un,transpose:()=>sn});var p={};_.r(p),_.d(p,{add:()=>os,adjoint:()=>Nn,clone:()=>Ln,copy:()=>Pn,create:()=>wn,determinant:()=>Cn,equals:()=>ls,exactEquals:()=>hs,frob:()=>as,fromQuat:()=>Jn,fromQuat2:()=>Yn,fromRotation:()=>Wn,fromRotationTranslation:()=>fr,fromRotationTranslationScale:()=>Zn,fromRotationTranslationScaleOrigin:()=>Kn,fromScaling:()=>Xn,fromTranslation:()=>Vn,fromValues:()=>On,fromXRotation:()=>Hn,fromYRotation:()=>$n,fromZRotation:()=>qn,frustum:()=>Qn,getRotation:()=>mr,getScaling:()=>pr,getTranslation:()=>_r,identity:()=>lr,invert:()=>zn,lookAt:()=>is,mul:()=>ds,multiply:()=>dr,multiplyScalar:()=>cs,multiplyScalarAndAdd:()=>us,ortho:()=>rs,perspective:()=>es,perspectiveFromFieldOfView:()=>ts,rotate:()=>Gn,rotateX:()=>jn,rotateY:()=>Un,rotateZ:()=>kn,scale:()=>Dn,set:()=>In,str:()=>ss,sub:()=>fs,subtract:()=>vr,targetTo:()=>ns,translate:()=>Bn,transpose:()=>Fn});var o={};_.r(o),_.d(o,{add:()=>vs,angle:()=>Bs,bezier:()=>Ls,ceil:()=>gs,clone:()=>_s,copy:()=>ps,create:()=>jt,cross:()=>Et,dist:()=>Ws,distance:()=>xr,div:()=>Xs,divide:()=>yr,dot:()=>kt,equals:()=>Us,exactEquals:()=>js,floor:()=>bs,forEach:()=>qs,fromValues:()=>Ut,hermite:()=>ws,inverse:()=>Ms,len:()=>Mr,length:()=>gr,lerp:()=>Rs,max:()=>ys,min:()=>Es,mul:()=>Vs,multiply:()=>Er,negate:()=>Ss,normalize:()=>Sr,random:()=>Ps,rotateX:()=>zs,rotateY:()=>Ns,rotateZ:()=>Cs,round:()=>xs,scale:()=>Ts,scaleAndAdd:()=>As,set:()=>ms,sqrDist:()=>Hs,sqrLen:()=>$s,squaredDistance:()=>Tr,squaredLength:()=>Ar,str:()=>Gs,sub:()=>ks,subtract:()=>br,transformMat3:()=>Is,transformMat4:()=>Os,transformQuat:()=>Fs,zero:()=>Ds});var r={};_.r(r),_.d(r,{add:()=>Ir,ceil:()=>Ys,clone:()=>wr,copy:()=>Pr,create:()=>Rr,cross:()=>ia,dist:()=>da,distance:()=>Br,div:()=>la,divide:()=>Nr,dot:()=>jr,equals:()=>Vr,exactEquals:()=>kr,floor:()=>Zs,forEach:()=>ma,fromValues:()=>Lr,inverse:()=>ra,len:()=>_a,length:()=>Vt,lerp:()=>Ur,max:()=>Js,min:()=>Ks,mul:()=>ha,multiply:()=>zr,negate:()=>ta,normalize:()=>Gr,random:()=>na,round:()=>Qs,scale:()=>Cr,scaleAndAdd:()=>ea,set:()=>Or,sqrDist:()=>fa,sqrLen:()=>pa,squaredDistance:()=>Dr,squaredLength:()=>Xt,str:()=>ca,sub:()=>ua,subtract:()=>Fr,transformMat4:()=>sa,transformQuat:()=>aa,zero:()=>oa});var n={};_.r(n),_.d(n,{add:()=>Pa,calculateW:()=>Ea,clone:()=>Ra,conjugate:()=>Aa,copy:()=>$t,create:()=>yt,dot:()=>qt,equals:()=>Ca,exactEquals:()=>Na,exp:()=>Yr,fromEuler:()=>Sa,fromMat3:()=>Kr,fromValues:()=>wa,getAngle:()=>ba,getAxisAngle:()=>ga,identity:()=>va,invert:()=>Ta,len:()=>Fa,length:()=>Yt,lerp:()=>Ia,ln:()=>Zr,mul:()=>Oa,multiply:()=>Wr,normalize:()=>Kt,pow:()=>ya,random:()=>xa,rotateX:()=>Hr,rotateY:()=>$r,rotateZ:()=>qr,rotationTo:()=>Ba,scale:()=>ei,set:()=>La,setAxes:()=>Ga,setAxisAngle:()=>Xr,slerp:()=>xt,sqlerp:()=>Da,sqrLen:()=>za,squaredLength:()=>Zt,str:()=>Ma});var i={};_.r(i),_.d(i,{add:()=>oo,clone:()=>Ua,conjugate:()=>fo,copy:()=>ri,create:()=>ja,dot:()=>ni,equals:()=>bo,exactEquals:()=>go,fromMat4:()=>Ha,fromRotation:()=>Wa,fromRotationTranslation:()=>ti,fromRotationTranslationValues:()=>Va,fromTranslation:()=>Xa,fromValues:()=>ka,getDual:()=>Za,getReal:()=>Ya,getTranslation:()=>Qa,identity:()=>$a,invert:()=>lo,len:()=>_o,length:()=>si,lerp:()=>ho,mul:()=>co,multiply:()=>ii,normalize:()=>mo,rotateAroundAxis:()=>ao,rotateByQuatAppend:()=>no,rotateByQuatPrepend:()=>so,rotateX:()=>to,rotateY:()=>ro,rotateZ:()=>io,scale:()=>uo,set:()=>qa,setDual:()=>Ja,setReal:()=>Ka,sqrLen:()=>po,squaredLength:()=>Tt,str:()=>vo,translate:()=>eo});var u={};_.r(u),_.d(u,{add:()=>Ao,angle:()=>Xo,ceil:()=>So,clone:()=>Eo,copy:()=>xo,create:()=>ai,cross:()=>Co,dist:()=>Qo,distance:()=>hi,div:()=>Jo,divide:()=>ui,dot:()=>No,equals:()=>qo,exactEquals:()=>$o,floor:()=>Mo,forEach:()=>rc,fromValues:()=>yo,inverse:()=>Fo,len:()=>Yo,length:()=>di,lerp:()=>Bo,max:()=>wo,min:()=>Ro,mul:()=>Ko,multiply:()=>ci,negate:()=>Io,normalize:()=>zo,random:()=>Do,rotate:()=>Vo,round:()=>Lo,scale:()=>Po,scaleAndAdd:()=>Oo,set:()=>To,sqrDist:()=>ec,sqrLen:()=>tc,squaredDistance:()=>li,squaredLength:()=>fi,str:()=>Ho,sub:()=>Zo,subtract:()=>oi,transformMat2:()=>Go,transformMat2d:()=>jo,transformMat3:()=>Uo,transformMat4:()=>ko,zero:()=>Wo});var s=1e-6,a=typeof Float32Array!="undefined"?Float32Array:Array,h=Math.random;function b(e){a=e}var m=Math.PI/180;function M(e){return e*m}function S(e,t){return Math.abs(e-t)<=s*Math.max(1,Math.abs(e),Math.abs(t))}function w(){var e=new a(4);return a!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function N(e){var t=new a(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function F(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function k(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function X(e,t,f,y){var R=new a(4);return R[0]=e,R[1]=t,R[2]=f,R[3]=y,R}function $(e,t,f,y,R){return e[0]=t,e[1]=f,e[2]=y,e[3]=R,e}function V(e,t){if(e===t){var f=t[1];e[1]=t[2],e[2]=f}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e}function Y(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=f*L-R*y;return O?(O=1/O,e[0]=L*O,e[1]=-y*O,e[2]=-R*O,e[3]=f*O,e):null}function Z(e,t){var f=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=f,e}function J(e){return e[0]*e[3]-e[2]*e[1]}function ee(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=f[0],z=f[1],C=f[2],B=f[3];return e[0]=y*I+L*z,e[1]=R*I+O*z,e[2]=y*C+L*B,e[3]=R*C+O*B,e}function K(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=Math.sin(f),z=Math.cos(f);return e[0]=y*z+L*I,e[1]=R*z+O*I,e[2]=y*-I+L*z,e[3]=R*-I+O*z,e}function re(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=f[0],z=f[1];return e[0]=y*I,e[1]=R*I,e[2]=L*z,e[3]=O*z,e}function ue(e,t){var f=Math.sin(t),y=Math.cos(t);return e[0]=y,e[1]=f,e[2]=-f,e[3]=y,e}function ie(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e}function de(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Te(e){return Math.hypot(e[0],e[1],e[2],e[3])}function pe(e,t,f,y){return e[2]=y[2]/y[0],f[0]=y[0],f[1]=y[1],f[3]=y[3]-e[2]*f[1],[e,t,f]}function Oe(e,t,f){return e[0]=t[0]+f[0],e[1]=t[1]+f[1],e[2]=t[2]+f[2],e[3]=t[3]+f[3],e}function Q(e,t,f){return e[0]=t[0]-f[0],e[1]=t[1]-f[1],e[2]=t[2]-f[2],e[3]=t[3]-f[3],e}function Re(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Ae(e,t){var f=e[0],y=e[1],R=e[2],L=e[3],O=t[0],I=t[1],z=t[2],C=t[3];return Math.abs(f-O)<=s*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(y-I)<=s*Math.max(1,Math.abs(y),Math.abs(I))&&Math.abs(R-z)<=s*Math.max(1,Math.abs(R),Math.abs(z))&&Math.abs(L-C)<=s*Math.max(1,Math.abs(L),Math.abs(C))}function He(e,t,f){return e[0]=t[0]*f,e[1]=t[1]*f,e[2]=t[2]*f,e[3]=t[3]*f,e}function Ie(e,t,f,y){return e[0]=t[0]+f[0]*y,e[1]=t[1]+f[1]*y,e[2]=t[2]+f[2]*y,e[3]=t[3]+f[3]*y,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Le=ee,Pe=Q;function De(){var e=new a(6);return a!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function rt(e){var t=new a(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Ge(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function $e(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function qe(e,t,f,y,R,L){var O=new a(6);return O[0]=e,O[1]=t,O[2]=f,O[3]=y,O[4]=R,O[5]=L,O}function ke(e,t,f,y,R,L,O){return e[0]=t,e[1]=f,e[2]=y,e[3]=R,e[4]=L,e[5]=O,e}function it(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=t[4],I=t[5],z=f*L-y*R;return z?(z=1/z,e[0]=L*z,e[1]=-y*z,e[2]=-R*z,e[3]=f*z,e[4]=(R*I-L*O)*z,e[5]=(y*O-f*I)*z,e):null}function Ye(e){return e[0]*e[3]-e[1]*e[2]}function mt(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=t[4],z=t[5],C=f[0],B=f[1],D=f[2],G=f[3],j=f[4],W=f[5];return e[0]=y*C+L*B,e[1]=R*C+O*B,e[2]=y*D+L*G,e[3]=R*D+O*G,e[4]=y*j+L*W+I,e[5]=R*j+O*W+z,e}function Lt(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=t[4],z=t[5],C=Math.sin(f),B=Math.cos(f);return e[0]=y*B+L*C,e[1]=R*B+O*C,e[2]=y*-C+L*B,e[3]=R*-C+O*B,e[4]=I,e[5]=z,e}function Pt(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=t[4],z=t[5],C=f[0],B=f[1];return e[0]=y*C,e[1]=R*C,e[2]=L*B,e[3]=O*B,e[4]=I,e[5]=z,e}function vt(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=t[4],z=t[5],C=f[0],B=f[1];return e[0]=y,e[1]=R,e[2]=L,e[3]=O,e[4]=y*C+L*B+I,e[5]=R*C+O*B+z,e}function Ot(e,t){var f=Math.sin(t),y=Math.cos(t);return e[0]=y,e[1]=f,e[2]=-f,e[3]=y,e[4]=0,e[5]=0,e}function It(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function Ft(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function gt(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function zt(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)}function Nt(e,t,f){return e[0]=t[0]+f[0],e[1]=t[1]+f[1],e[2]=t[2]+f[2],e[3]=t[3]+f[3],e[4]=t[4]+f[4],e[5]=t[5]+f[5],e}function bt(e,t,f){return e[0]=t[0]-f[0],e[1]=t[1]-f[1],e[2]=t[2]-f[2],e[3]=t[3]-f[3],e[4]=t[4]-f[4],e[5]=t[5]-f[5],e}function Ct(e,t,f){return e[0]=t[0]*f,e[1]=t[1]*f,e[2]=t[2]*f,e[3]=t[3]*f,e[4]=t[4]*f,e[5]=t[5]*f,e}function nt(e,t,f,y){return e[0]=t[0]+f[0]*y,e[1]=t[1]+f[1]*y,e[2]=t[2]+f[2]*y,e[3]=t[3]+f[3]*y,e[4]=t[4]+f[4]*y,e[5]=t[5]+f[5]*y,e}function Ze(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function Bt(e,t){var f=e[0],y=e[1],R=e[2],L=e[3],O=e[4],I=e[5],z=t[0],C=t[1],B=t[2],D=t[3],G=t[4],j=t[5];return Math.abs(f-z)<=s*Math.max(1,Math.abs(f),Math.abs(z))&&Math.abs(y-C)<=s*Math.max(1,Math.abs(y),Math.abs(C))&&Math.abs(R-B)<=s*Math.max(1,Math.abs(R),Math.abs(B))&&Math.abs(L-D)<=s*Math.max(1,Math.abs(L),Math.abs(D))&&Math.abs(O-G)<=s*Math.max(1,Math.abs(O),Math.abs(G))&&Math.abs(I-j)<=s*Math.max(1,Math.abs(I),Math.abs(j))}var Dt=mt,Gt=bt;function be(){var e=new a(9);return a!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Se(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function we(e){var t=new a(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function je(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function tn(e,t,f,y,R,L,O,I,z){var C=new a(9);return C[0]=e,C[1]=t,C[2]=f,C[3]=y,C[4]=R,C[5]=L,C[6]=O,C[7]=I,C[8]=z,C}function rn(e,t,f,y,R,L,O,I,z,C){return e[0]=t,e[1]=f,e[2]=y,e[3]=R,e[4]=L,e[5]=O,e[6]=I,e[7]=z,e[8]=C,e}function nn(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function sn(e,t){if(e===t){var f=t[1],y=t[2],R=t[5];e[1]=t[3],e[2]=t[6],e[3]=f,e[5]=t[7],e[6]=y,e[7]=R}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function an(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=t[4],I=t[5],z=t[6],C=t[7],B=t[8],D=B*O-I*C,G=-B*L+I*z,j=C*L-O*z,W=f*D+y*G+R*j;return W?(W=1/W,e[0]=D*W,e[1]=(-B*y+R*C)*W,e[2]=(I*y-R*O)*W,e[3]=G*W,e[4]=(B*f-R*z)*W,e[5]=(-I*f+R*L)*W,e[6]=j*W,e[7]=(-C*f+y*z)*W,e[8]=(O*f-y*L)*W,e):null}function on(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=t[4],I=t[5],z=t[6],C=t[7],B=t[8];return e[0]=O*B-I*C,e[1]=R*C-y*B,e[2]=y*I-R*O,e[3]=I*z-L*B,e[4]=f*B-R*z,e[5]=R*L-f*I,e[6]=L*C-O*z,e[7]=y*z-f*C,e[8]=f*O-y*L,e}function cn(e){var t=e[0],f=e[1],y=e[2],R=e[3],L=e[4],O=e[5],I=e[6],z=e[7],C=e[8];return t*(C*L-O*z)+f*(-C*R+O*I)+y*(z*R-L*I)}function ur(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=t[4],z=t[5],C=t[6],B=t[7],D=t[8],G=f[0],j=f[1],W=f[2],H=f[3],U=f[4],q=f[5],se=f[6],te=f[7],ne=f[8];return e[0]=G*y+j*O+W*C,e[1]=G*R+j*I+W*B,e[2]=G*L+j*z+W*D,e[3]=H*y+U*O+q*C,e[4]=H*R+U*I+q*B,e[5]=H*L+U*z+q*D,e[6]=se*y+te*O+ne*C,e[7]=se*R+te*I+ne*B,e[8]=se*L+te*z+ne*D,e}function un(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=t[4],z=t[5],C=t[6],B=t[7],D=t[8],G=f[0],j=f[1];return e[0]=y,e[1]=R,e[2]=L,e[3]=O,e[4]=I,e[5]=z,e[6]=G*y+j*O+C,e[7]=G*R+j*I+B,e[8]=G*L+j*z+D,e}function hn(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=t[4],z=t[5],C=t[6],B=t[7],D=t[8],G=Math.sin(f),j=Math.cos(f);return e[0]=j*y+G*O,e[1]=j*R+G*I,e[2]=j*L+G*z,e[3]=j*O-G*y,e[4]=j*I-G*R,e[5]=j*z-G*L,e[6]=C,e[7]=B,e[8]=D,e}function ln(e,t,f){var y=f[0],R=f[1];return e[0]=y*t[0],e[1]=y*t[1],e[2]=y*t[2],e[3]=R*t[3],e[4]=R*t[4],e[5]=R*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function dn(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function fn(e,t){var f=Math.sin(t),y=Math.cos(t);return e[0]=y,e[1]=f,e[2]=0,e[3]=-f,e[4]=y,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function _n(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function pn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function mn(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=f+f,I=y+y,z=R+R,C=f*O,B=y*O,D=y*I,G=R*O,j=R*I,W=R*z,H=L*O,U=L*I,q=L*z;return e[0]=1-D-W,e[3]=B-q,e[6]=G+U,e[1]=B+q,e[4]=1-C-W,e[7]=j-H,e[2]=G-U,e[5]=j+H,e[8]=1-C-D,e}function vn(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=t[4],I=t[5],z=t[6],C=t[7],B=t[8],D=t[9],G=t[10],j=t[11],W=t[12],H=t[13],U=t[14],q=t[15],se=f*I-y*O,te=f*z-R*O,ne=f*C-L*O,ce=y*z-R*I,ae=y*C-L*I,Ee=R*C-L*z,ve=B*H-D*W,ge=B*U-G*W,me=B*q-j*W,ye=D*U-G*H,fe=D*q-j*H,_e=G*q-j*U,oe=se*_e-te*fe+ne*ye+ce*me-ae*ge+Ee*ve;return oe?(oe=1/oe,e[0]=(I*_e-z*fe+C*ye)*oe,e[1]=(z*me-O*_e-C*ge)*oe,e[2]=(O*fe-I*me+C*ve)*oe,e[3]=(R*fe-y*_e-L*ye)*oe,e[4]=(f*_e-R*me+L*ge)*oe,e[5]=(y*me-f*fe-L*ve)*oe,e[6]=(H*Ee-U*ae+q*ce)*oe,e[7]=(U*ne-W*Ee-q*te)*oe,e[8]=(W*ae-H*ne+q*se)*oe,e):null}function gn(e,t,f){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/f,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function bn(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function En(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function yn(e,t,f){return e[0]=t[0]+f[0],e[1]=t[1]+f[1],e[2]=t[2]+f[2],e[3]=t[3]+f[3],e[4]=t[4]+f[4],e[5]=t[5]+f[5],e[6]=t[6]+f[6],e[7]=t[7]+f[7],e[8]=t[8]+f[8],e}function hr(e,t,f){return e[0]=t[0]-f[0],e[1]=t[1]-f[1],e[2]=t[2]-f[2],e[3]=t[3]-f[3],e[4]=t[4]-f[4],e[5]=t[5]-f[5],e[6]=t[6]-f[6],e[7]=t[7]-f[7],e[8]=t[8]-f[8],e}function xn(e,t,f){return e[0]=t[0]*f,e[1]=t[1]*f,e[2]=t[2]*f,e[3]=t[3]*f,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*f,e}function Tn(e,t,f,y){return e[0]=t[0]+f[0]*y,e[1]=t[1]+f[1]*y,e[2]=t[2]+f[2]*y,e[3]=t[3]+f[3]*y,e[4]=t[4]+f[4]*y,e[5]=t[5]+f[5]*y,e[6]=t[6]+f[6]*y,e[7]=t[7]+f[7]*y,e[8]=t[8]+f[8]*y,e}function An(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function Sn(e,t){var f=e[0],y=e[1],R=e[2],L=e[3],O=e[4],I=e[5],z=e[6],C=e[7],B=e[8],D=t[0],G=t[1],j=t[2],W=t[3],H=t[4],U=t[5],q=t[6],se=t[7],te=t[8];return Math.abs(f-D)<=s*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(y-G)<=s*Math.max(1,Math.abs(y),Math.abs(G))&&Math.abs(R-j)<=s*Math.max(1,Math.abs(R),Math.abs(j))&&Math.abs(L-W)<=s*Math.max(1,Math.abs(L),Math.abs(W))&&Math.abs(O-H)<=s*Math.max(1,Math.abs(O),Math.abs(H))&&Math.abs(I-U)<=s*Math.max(1,Math.abs(I),Math.abs(U))&&Math.abs(z-q)<=s*Math.max(1,Math.abs(z),Math.abs(q))&&Math.abs(C-se)<=s*Math.max(1,Math.abs(C),Math.abs(se))&&Math.abs(B-te)<=s*Math.max(1,Math.abs(B),Math.abs(te))}var Mn=ur,Rn=hr;function wn(){var e=new a(16);return a!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Ln(e){var t=new a(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Pn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function On(e,t,f,y,R,L,O,I,z,C,B,D,G,j,W,H){var U=new a(16);return U[0]=e,U[1]=t,U[2]=f,U[3]=y,U[4]=R,U[5]=L,U[6]=O,U[7]=I,U[8]=z,U[9]=C,U[10]=B,U[11]=D,U[12]=G,U[13]=j,U[14]=W,U[15]=H,U}function In(e,t,f,y,R,L,O,I,z,C,B,D,G,j,W,H,U){return e[0]=t,e[1]=f,e[2]=y,e[3]=R,e[4]=L,e[5]=O,e[6]=I,e[7]=z,e[8]=C,e[9]=B,e[10]=D,e[11]=G,e[12]=j,e[13]=W,e[14]=H,e[15]=U,e}function lr(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Fn(e,t){if(e===t){var f=t[1],y=t[2],R=t[3],L=t[6],O=t[7],I=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=f,e[6]=t[9],e[7]=t[13],e[8]=y,e[9]=L,e[11]=t[14],e[12]=R,e[13]=O,e[14]=I}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function zn(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=t[4],I=t[5],z=t[6],C=t[7],B=t[8],D=t[9],G=t[10],j=t[11],W=t[12],H=t[13],U=t[14],q=t[15],se=f*I-y*O,te=f*z-R*O,ne=f*C-L*O,ce=y*z-R*I,ae=y*C-L*I,Ee=R*C-L*z,ve=B*H-D*W,ge=B*U-G*W,me=B*q-j*W,ye=D*U-G*H,fe=D*q-j*H,_e=G*q-j*U,oe=se*_e-te*fe+ne*ye+ce*me-ae*ge+Ee*ve;return oe?(oe=1/oe,e[0]=(I*_e-z*fe+C*ye)*oe,e[1]=(R*fe-y*_e-L*ye)*oe,e[2]=(H*Ee-U*ae+q*ce)*oe,e[3]=(G*ae-D*Ee-j*ce)*oe,e[4]=(z*me-O*_e-C*ge)*oe,e[5]=(f*_e-R*me+L*ge)*oe,e[6]=(U*ne-W*Ee-q*te)*oe,e[7]=(B*Ee-G*ne+j*te)*oe,e[8]=(O*fe-I*me+C*ve)*oe,e[9]=(y*me-f*fe-L*ve)*oe,e[10]=(W*ae-H*ne+q*se)*oe,e[11]=(D*ne-B*ae-j*se)*oe,e[12]=(I*ge-O*ye-z*ve)*oe,e[13]=(f*ye-y*ge+R*ve)*oe,e[14]=(H*te-W*ce-U*se)*oe,e[15]=(B*ce-D*te+G*se)*oe,e):null}function Nn(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=t[4],I=t[5],z=t[6],C=t[7],B=t[8],D=t[9],G=t[10],j=t[11],W=t[12],H=t[13],U=t[14],q=t[15];return e[0]=I*(G*q-j*U)-D*(z*q-C*U)+H*(z*j-C*G),e[1]=-(y*(G*q-j*U)-D*(R*q-L*U)+H*(R*j-L*G)),e[2]=y*(z*q-C*U)-I*(R*q-L*U)+H*(R*C-L*z),e[3]=-(y*(z*j-C*G)-I*(R*j-L*G)+D*(R*C-L*z)),e[4]=-(O*(G*q-j*U)-B*(z*q-C*U)+W*(z*j-C*G)),e[5]=f*(G*q-j*U)-B*(R*q-L*U)+W*(R*j-L*G),e[6]=-(f*(z*q-C*U)-O*(R*q-L*U)+W*(R*C-L*z)),e[7]=f*(z*j-C*G)-O*(R*j-L*G)+B*(R*C-L*z),e[8]=O*(D*q-j*H)-B*(I*q-C*H)+W*(I*j-C*D),e[9]=-(f*(D*q-j*H)-B*(y*q-L*H)+W*(y*j-L*D)),e[10]=f*(I*q-C*H)-O*(y*q-L*H)+W*(y*C-L*I),e[11]=-(f*(I*j-C*D)-O*(y*j-L*D)+B*(y*C-L*I)),e[12]=-(O*(D*U-G*H)-B*(I*U-z*H)+W*(I*G-z*D)),e[13]=f*(D*U-G*H)-B*(y*U-R*H)+W*(y*G-R*D),e[14]=-(f*(I*U-z*H)-O*(y*U-R*H)+W*(y*z-R*I)),e[15]=f*(I*G-z*D)-O*(y*G-R*D)+B*(y*z-R*I),e}function Cn(e){var t=e[0],f=e[1],y=e[2],R=e[3],L=e[4],O=e[5],I=e[6],z=e[7],C=e[8],B=e[9],D=e[10],G=e[11],j=e[12],W=e[13],H=e[14],U=e[15];return(t*O-f*L)*(D*U-G*H)-(t*I-y*L)*(B*U-G*W)+(t*z-R*L)*(B*H-D*W)+(f*I-y*O)*(C*U-G*j)-(f*z-R*O)*(C*H-D*j)+(y*z-R*I)*(C*W-B*j)}function dr(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=t[4],z=t[5],C=t[6],B=t[7],D=t[8],G=t[9],j=t[10],W=t[11],H=t[12],U=t[13],q=t[14],se=t[15],te=f[0],ne=f[1],ce=f[2],ae=f[3];return e[0]=te*y+ne*I+ce*D+ae*H,e[1]=te*R+ne*z+ce*G+ae*U,e[2]=te*L+ne*C+ce*j+ae*q,e[3]=te*O+ne*B+ce*W+ae*se,te=f[4],ne=f[5],ce=f[6],ae=f[7],e[4]=te*y+ne*I+ce*D+ae*H,e[5]=te*R+ne*z+ce*G+ae*U,e[6]=te*L+ne*C+ce*j+ae*q,e[7]=te*O+ne*B+ce*W+ae*se,te=f[8],ne=f[9],ce=f[10],ae=f[11],e[8]=te*y+ne*I+ce*D+ae*H,e[9]=te*R+ne*z+ce*G+ae*U,e[10]=te*L+ne*C+ce*j+ae*q,e[11]=te*O+ne*B+ce*W+ae*se,te=f[12],ne=f[13],ce=f[14],ae=f[15],e[12]=te*y+ne*I+ce*D+ae*H,e[13]=te*R+ne*z+ce*G+ae*U,e[14]=te*L+ne*C+ce*j+ae*q,e[15]=te*O+ne*B+ce*W+ae*se,e}function Bn(e,t,f){var y,R,L,O,I,z,C,B,D,G,j,W,H=f[0],U=f[1],q=f[2];return t===e?(e[12]=t[0]*H+t[4]*U+t[8]*q+t[12],e[13]=t[1]*H+t[5]*U+t[9]*q+t[13],e[14]=t[2]*H+t[6]*U+t[10]*q+t[14],e[15]=t[3]*H+t[7]*U+t[11]*q+t[15]):(y=t[0],R=t[1],L=t[2],O=t[3],I=t[4],z=t[5],C=t[6],B=t[7],D=t[8],G=t[9],j=t[10],W=t[11],e[0]=y,e[1]=R,e[2]=L,e[3]=O,e[4]=I,e[5]=z,e[6]=C,e[7]=B,e[8]=D,e[9]=G,e[10]=j,e[11]=W,e[12]=y*H+I*U+D*q+t[12],e[13]=R*H+z*U+G*q+t[13],e[14]=L*H+C*U+j*q+t[14],e[15]=O*H+B*U+W*q+t[15]),e}function Dn(e,t,f){var y=f[0],R=f[1],L=f[2];return e[0]=t[0]*y,e[1]=t[1]*y,e[2]=t[2]*y,e[3]=t[3]*y,e[4]=t[4]*R,e[5]=t[5]*R,e[6]=t[6]*R,e[7]=t[7]*R,e[8]=t[8]*L,e[9]=t[9]*L,e[10]=t[10]*L,e[11]=t[11]*L,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Gn(e,t,f,y){var R,L,O,I,z,C,B,D,G,j,W,H,U,q,se,te,ne,ce,ae,Ee,ve,ge,me,ye,fe=y[0],_e=y[1],oe=y[2],Be=Math.hypot(fe,_e,oe);return Be<s?null:(fe*=Be=1/Be,_e*=Be,oe*=Be,R=Math.sin(f),O=1-(L=Math.cos(f)),I=t[0],z=t[1],C=t[2],B=t[3],D=t[4],G=t[5],j=t[6],W=t[7],H=t[8],U=t[9],q=t[10],se=t[11],te=fe*fe*O+L,ne=_e*fe*O+oe*R,ce=oe*fe*O-_e*R,ae=fe*_e*O-oe*R,Ee=_e*_e*O+L,ve=oe*_e*O+fe*R,ge=fe*oe*O+_e*R,me=_e*oe*O-fe*R,ye=oe*oe*O+L,e[0]=I*te+D*ne+H*ce,e[1]=z*te+G*ne+U*ce,e[2]=C*te+j*ne+q*ce,e[3]=B*te+W*ne+se*ce,e[4]=I*ae+D*Ee+H*ve,e[5]=z*ae+G*Ee+U*ve,e[6]=C*ae+j*Ee+q*ve,e[7]=B*ae+W*Ee+se*ve,e[8]=I*ge+D*me+H*ye,e[9]=z*ge+G*me+U*ye,e[10]=C*ge+j*me+q*ye,e[11]=B*ge+W*me+se*ye,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function jn(e,t,f){var y=Math.sin(f),R=Math.cos(f),L=t[4],O=t[5],I=t[6],z=t[7],C=t[8],B=t[9],D=t[10],G=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=L*R+C*y,e[5]=O*R+B*y,e[6]=I*R+D*y,e[7]=z*R+G*y,e[8]=C*R-L*y,e[9]=B*R-O*y,e[10]=D*R-I*y,e[11]=G*R-z*y,e}function Un(e,t,f){var y=Math.sin(f),R=Math.cos(f),L=t[0],O=t[1],I=t[2],z=t[3],C=t[8],B=t[9],D=t[10],G=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=L*R-C*y,e[1]=O*R-B*y,e[2]=I*R-D*y,e[3]=z*R-G*y,e[8]=L*y+C*R,e[9]=O*y+B*R,e[10]=I*y+D*R,e[11]=z*y+G*R,e}function kn(e,t,f){var y=Math.sin(f),R=Math.cos(f),L=t[0],O=t[1],I=t[2],z=t[3],C=t[4],B=t[5],D=t[6],G=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=L*R+C*y,e[1]=O*R+B*y,e[2]=I*R+D*y,e[3]=z*R+G*y,e[4]=C*R-L*y,e[5]=B*R-O*y,e[6]=D*R-I*y,e[7]=G*R-z*y,e}function Vn(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Xn(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Wn(e,t,f){var y,R,L,O=f[0],I=f[1],z=f[2],C=Math.hypot(O,I,z);return C<s?null:(O*=C=1/C,I*=C,z*=C,y=Math.sin(t),L=1-(R=Math.cos(t)),e[0]=O*O*L+R,e[1]=I*O*L+z*y,e[2]=z*O*L-I*y,e[3]=0,e[4]=O*I*L-z*y,e[5]=I*I*L+R,e[6]=z*I*L+O*y,e[7]=0,e[8]=O*z*L+I*y,e[9]=I*z*L-O*y,e[10]=z*z*L+R,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Hn(e,t){var f=Math.sin(t),y=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=y,e[6]=f,e[7]=0,e[8]=0,e[9]=-f,e[10]=y,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function $n(e,t){var f=Math.sin(t),y=Math.cos(t);return e[0]=y,e[1]=0,e[2]=-f,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=f,e[9]=0,e[10]=y,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qn(e,t){var f=Math.sin(t),y=Math.cos(t);return e[0]=y,e[1]=f,e[2]=0,e[3]=0,e[4]=-f,e[5]=y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fr(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=y+y,z=R+R,C=L+L,B=y*I,D=y*z,G=y*C,j=R*z,W=R*C,H=L*C,U=O*I,q=O*z,se=O*C;return e[0]=1-(j+H),e[1]=D+se,e[2]=G-q,e[3]=0,e[4]=D-se,e[5]=1-(B+H),e[6]=W+U,e[7]=0,e[8]=G+q,e[9]=W-U,e[10]=1-(B+j),e[11]=0,e[12]=f[0],e[13]=f[1],e[14]=f[2],e[15]=1,e}function Yn(e,t){var f=new a(3),y=-t[0],R=-t[1],L=-t[2],O=t[3],I=t[4],z=t[5],C=t[6],B=t[7],D=y*y+R*R+L*L+O*O;return D>0?(f[0]=2*(I*O+B*y+z*L-C*R)/D,f[1]=2*(z*O+B*R+C*y-I*L)/D,f[2]=2*(C*O+B*L+I*R-z*y)/D):(f[0]=2*(I*O+B*y+z*L-C*R),f[1]=2*(z*O+B*R+C*y-I*L),f[2]=2*(C*O+B*L+I*R-z*y)),fr(e,t,f),e}function _r(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function pr(e,t){var f=t[0],y=t[1],R=t[2],L=t[4],O=t[5],I=t[6],z=t[8],C=t[9],B=t[10];return e[0]=Math.hypot(f,y,R),e[1]=Math.hypot(L,O,I),e[2]=Math.hypot(z,C,B),e}function mr(e,t){var f=new a(3);pr(f,t);var y=1/f[0],R=1/f[1],L=1/f[2],O=t[0]*y,I=t[1]*R,z=t[2]*L,C=t[4]*y,B=t[5]*R,D=t[6]*L,G=t[8]*y,j=t[9]*R,W=t[10]*L,H=O+B+W,U=0;return H>0?(U=2*Math.sqrt(H+1),e[3]=.25*U,e[0]=(D-j)/U,e[1]=(G-z)/U,e[2]=(I-C)/U):O>B&&O>W?(U=2*Math.sqrt(1+O-B-W),e[3]=(D-j)/U,e[0]=.25*U,e[1]=(I+C)/U,e[2]=(G+z)/U):B>W?(U=2*Math.sqrt(1+B-O-W),e[3]=(G-z)/U,e[0]=(I+C)/U,e[1]=.25*U,e[2]=(D+j)/U):(U=2*Math.sqrt(1+W-O-B),e[3]=(I-C)/U,e[0]=(G+z)/U,e[1]=(D+j)/U,e[2]=.25*U),e}function Zn(e,t,f,y){var R=t[0],L=t[1],O=t[2],I=t[3],z=R+R,C=L+L,B=O+O,D=R*z,G=R*C,j=R*B,W=L*C,H=L*B,U=O*B,q=I*z,se=I*C,te=I*B,ne=y[0],ce=y[1],ae=y[2];return e[0]=(1-(W+U))*ne,e[1]=(G+te)*ne,e[2]=(j-se)*ne,e[3]=0,e[4]=(G-te)*ce,e[5]=(1-(D+U))*ce,e[6]=(H+q)*ce,e[7]=0,e[8]=(j+se)*ae,e[9]=(H-q)*ae,e[10]=(1-(D+W))*ae,e[11]=0,e[12]=f[0],e[13]=f[1],e[14]=f[2],e[15]=1,e}function Kn(e,t,f,y,R){var L=t[0],O=t[1],I=t[2],z=t[3],C=L+L,B=O+O,D=I+I,G=L*C,j=L*B,W=L*D,H=O*B,U=O*D,q=I*D,se=z*C,te=z*B,ne=z*D,ce=y[0],ae=y[1],Ee=y[2],ve=R[0],ge=R[1],me=R[2],ye=(1-(H+q))*ce,fe=(j+ne)*ce,_e=(W-te)*ce,oe=(j-ne)*ae,Be=(1-(G+q))*ae,st=(U+se)*ae,at=(W+te)*Ee,_i=(U-se)*Ee,pi=(1-(G+H))*Ee;return e[0]=ye,e[1]=fe,e[2]=_e,e[3]=0,e[4]=oe,e[5]=Be,e[6]=st,e[7]=0,e[8]=at,e[9]=_i,e[10]=pi,e[11]=0,e[12]=f[0]+ve-(ye*ve+oe*ge+at*me),e[13]=f[1]+ge-(fe*ve+Be*ge+_i*me),e[14]=f[2]+me-(_e*ve+st*ge+pi*me),e[15]=1,e}function Jn(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=f+f,I=y+y,z=R+R,C=f*O,B=y*O,D=y*I,G=R*O,j=R*I,W=R*z,H=L*O,U=L*I,q=L*z;return e[0]=1-D-W,e[1]=B+q,e[2]=G-U,e[3]=0,e[4]=B-q,e[5]=1-C-W,e[6]=j+H,e[7]=0,e[8]=G+U,e[9]=j-H,e[10]=1-C-D,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Qn(e,t,f,y,R,L,O){var I=1/(f-t),z=1/(R-y),C=1/(L-O);return e[0]=2*L*I,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*L*z,e[6]=0,e[7]=0,e[8]=(f+t)*I,e[9]=(R+y)*z,e[10]=(O+L)*C,e[11]=-1,e[12]=0,e[13]=0,e[14]=O*L*2*C,e[15]=0,e}function es(e,t,f,y,R){var L,O=1/Math.tan(t/2);return e[0]=O/f,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=O,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,R!=null&&R!==1/0?(L=1/(y-R),e[10]=(R+y)*L,e[14]=2*R*y*L):(e[10]=-1,e[14]=-2*y),e}function ts(e,t,f,y){var R=Math.tan(t.upDegrees*Math.PI/180),L=Math.tan(t.downDegrees*Math.PI/180),O=Math.tan(t.leftDegrees*Math.PI/180),I=Math.tan(t.rightDegrees*Math.PI/180),z=2/(O+I),C=2/(R+L);return e[0]=z,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=C,e[6]=0,e[7]=0,e[8]=-(O-I)*z*.5,e[9]=(R-L)*C*.5,e[10]=y/(f-y),e[11]=-1,e[12]=0,e[13]=0,e[14]=y*f/(f-y),e[15]=0,e}function rs(e,t,f,y,R,L,O){var I=1/(t-f),z=1/(y-R),C=1/(L-O);return e[0]=-2*I,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*C,e[11]=0,e[12]=(t+f)*I,e[13]=(R+y)*z,e[14]=(O+L)*C,e[15]=1,e}function is(e,t,f,y){var R,L,O,I,z,C,B,D,G,j,W=t[0],H=t[1],U=t[2],q=y[0],se=y[1],te=y[2],ne=f[0],ce=f[1],ae=f[2];return Math.abs(W-ne)<s&&Math.abs(H-ce)<s&&Math.abs(U-ae)<s?lr(e):(B=W-ne,D=H-ce,G=U-ae,R=se*(G*=j=1/Math.hypot(B,D,G))-te*(D*=j),L=te*(B*=j)-q*G,O=q*D-se*B,(j=Math.hypot(R,L,O))?(R*=j=1/j,L*=j,O*=j):(R=0,L=0,O=0),I=D*O-G*L,z=G*R-B*O,C=B*L-D*R,(j=Math.hypot(I,z,C))?(I*=j=1/j,z*=j,C*=j):(I=0,z=0,C=0),e[0]=R,e[1]=I,e[2]=B,e[3]=0,e[4]=L,e[5]=z,e[6]=D,e[7]=0,e[8]=O,e[9]=C,e[10]=G,e[11]=0,e[12]=-(R*W+L*H+O*U),e[13]=-(I*W+z*H+C*U),e[14]=-(B*W+D*H+G*U),e[15]=1,e)}function ns(e,t,f,y){var R=t[0],L=t[1],O=t[2],I=y[0],z=y[1],C=y[2],B=R-f[0],D=L-f[1],G=O-f[2],j=B*B+D*D+G*G;j>0&&(B*=j=1/Math.sqrt(j),D*=j,G*=j);var W=z*G-C*D,H=C*B-I*G,U=I*D-z*B;return(j=W*W+H*H+U*U)>0&&(W*=j=1/Math.sqrt(j),H*=j,U*=j),e[0]=W,e[1]=H,e[2]=U,e[3]=0,e[4]=D*U-G*H,e[5]=G*W-B*U,e[6]=B*H-D*W,e[7]=0,e[8]=B,e[9]=D,e[10]=G,e[11]=0,e[12]=R,e[13]=L,e[14]=O,e[15]=1,e}function ss(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function as(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function os(e,t,f){return e[0]=t[0]+f[0],e[1]=t[1]+f[1],e[2]=t[2]+f[2],e[3]=t[3]+f[3],e[4]=t[4]+f[4],e[5]=t[5]+f[5],e[6]=t[6]+f[6],e[7]=t[7]+f[7],e[8]=t[8]+f[8],e[9]=t[9]+f[9],e[10]=t[10]+f[10],e[11]=t[11]+f[11],e[12]=t[12]+f[12],e[13]=t[13]+f[13],e[14]=t[14]+f[14],e[15]=t[15]+f[15],e}function vr(e,t,f){return e[0]=t[0]-f[0],e[1]=t[1]-f[1],e[2]=t[2]-f[2],e[3]=t[3]-f[3],e[4]=t[4]-f[4],e[5]=t[5]-f[5],e[6]=t[6]-f[6],e[7]=t[7]-f[7],e[8]=t[8]-f[8],e[9]=t[9]-f[9],e[10]=t[10]-f[10],e[11]=t[11]-f[11],e[12]=t[12]-f[12],e[13]=t[13]-f[13],e[14]=t[14]-f[14],e[15]=t[15]-f[15],e}function cs(e,t,f){return e[0]=t[0]*f,e[1]=t[1]*f,e[2]=t[2]*f,e[3]=t[3]*f,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*f,e[9]=t[9]*f,e[10]=t[10]*f,e[11]=t[11]*f,e[12]=t[12]*f,e[13]=t[13]*f,e[14]=t[14]*f,e[15]=t[15]*f,e}function us(e,t,f,y){return e[0]=t[0]+f[0]*y,e[1]=t[1]+f[1]*y,e[2]=t[2]+f[2]*y,e[3]=t[3]+f[3]*y,e[4]=t[4]+f[4]*y,e[5]=t[5]+f[5]*y,e[6]=t[6]+f[6]*y,e[7]=t[7]+f[7]*y,e[8]=t[8]+f[8]*y,e[9]=t[9]+f[9]*y,e[10]=t[10]+f[10]*y,e[11]=t[11]+f[11]*y,e[12]=t[12]+f[12]*y,e[13]=t[13]+f[13]*y,e[14]=t[14]+f[14]*y,e[15]=t[15]+f[15]*y,e}function hs(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function ls(e,t){var f=e[0],y=e[1],R=e[2],L=e[3],O=e[4],I=e[5],z=e[6],C=e[7],B=e[8],D=e[9],G=e[10],j=e[11],W=e[12],H=e[13],U=e[14],q=e[15],se=t[0],te=t[1],ne=t[2],ce=t[3],ae=t[4],Ee=t[5],ve=t[6],ge=t[7],me=t[8],ye=t[9],fe=t[10],_e=t[11],oe=t[12],Be=t[13],st=t[14],at=t[15];return Math.abs(f-se)<=s*Math.max(1,Math.abs(f),Math.abs(se))&&Math.abs(y-te)<=s*Math.max(1,Math.abs(y),Math.abs(te))&&Math.abs(R-ne)<=s*Math.max(1,Math.abs(R),Math.abs(ne))&&Math.abs(L-ce)<=s*Math.max(1,Math.abs(L),Math.abs(ce))&&Math.abs(O-ae)<=s*Math.max(1,Math.abs(O),Math.abs(ae))&&Math.abs(I-Ee)<=s*Math.max(1,Math.abs(I),Math.abs(Ee))&&Math.abs(z-ve)<=s*Math.max(1,Math.abs(z),Math.abs(ve))&&Math.abs(C-ge)<=s*Math.max(1,Math.abs(C),Math.abs(ge))&&Math.abs(B-me)<=s*Math.max(1,Math.abs(B),Math.abs(me))&&Math.abs(D-ye)<=s*Math.max(1,Math.abs(D),Math.abs(ye))&&Math.abs(G-fe)<=s*Math.max(1,Math.abs(G),Math.abs(fe))&&Math.abs(j-_e)<=s*Math.max(1,Math.abs(j),Math.abs(_e))&&Math.abs(W-oe)<=s*Math.max(1,Math.abs(W),Math.abs(oe))&&Math.abs(H-Be)<=s*Math.max(1,Math.abs(H),Math.abs(Be))&&Math.abs(U-st)<=s*Math.max(1,Math.abs(U),Math.abs(st))&&Math.abs(q-at)<=s*Math.max(1,Math.abs(q),Math.abs(at))}var ds=dr,fs=vr;function jt(){var e=new a(3);return a!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function _s(e){var t=new a(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function gr(e){var t=e[0],f=e[1],y=e[2];return Math.hypot(t,f,y)}function Ut(e,t,f){var y=new a(3);return y[0]=e,y[1]=t,y[2]=f,y}function ps(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function ms(e,t,f,y){return e[0]=t,e[1]=f,e[2]=y,e}function vs(e,t,f){return e[0]=t[0]+f[0],e[1]=t[1]+f[1],e[2]=t[2]+f[2],e}function br(e,t,f){return e[0]=t[0]-f[0],e[1]=t[1]-f[1],e[2]=t[2]-f[2],e}function Er(e,t,f){return e[0]=t[0]*f[0],e[1]=t[1]*f[1],e[2]=t[2]*f[2],e}function yr(e,t,f){return e[0]=t[0]/f[0],e[1]=t[1]/f[1],e[2]=t[2]/f[2],e}function gs(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function bs(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function Es(e,t,f){return e[0]=Math.min(t[0],f[0]),e[1]=Math.min(t[1],f[1]),e[2]=Math.min(t[2],f[2]),e}function ys(e,t,f){return e[0]=Math.max(t[0],f[0]),e[1]=Math.max(t[1],f[1]),e[2]=Math.max(t[2],f[2]),e}function xs(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function Ts(e,t,f){return e[0]=t[0]*f,e[1]=t[1]*f,e[2]=t[2]*f,e}function As(e,t,f,y){return e[0]=t[0]+f[0]*y,e[1]=t[1]+f[1]*y,e[2]=t[2]+f[2]*y,e}function xr(e,t){var f=t[0]-e[0],y=t[1]-e[1],R=t[2]-e[2];return Math.hypot(f,y,R)}function Tr(e,t){var f=t[0]-e[0],y=t[1]-e[1],R=t[2]-e[2];return f*f+y*y+R*R}function Ar(e){var t=e[0],f=e[1],y=e[2];return t*t+f*f+y*y}function Ss(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function Ms(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Sr(e,t){var f=t[0],y=t[1],R=t[2],L=f*f+y*y+R*R;return L>0&&(L=1/Math.sqrt(L)),e[0]=t[0]*L,e[1]=t[1]*L,e[2]=t[2]*L,e}function kt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Et(e,t,f){var y=t[0],R=t[1],L=t[2],O=f[0],I=f[1],z=f[2];return e[0]=R*z-L*I,e[1]=L*O-y*z,e[2]=y*I-R*O,e}function Rs(e,t,f,y){var R=t[0],L=t[1],O=t[2];return e[0]=R+y*(f[0]-R),e[1]=L+y*(f[1]-L),e[2]=O+y*(f[2]-O),e}function ws(e,t,f,y,R,L){var O=L*L,I=O*(2*L-3)+1,z=O*(L-2)+L,C=O*(L-1),B=O*(3-2*L);return e[0]=t[0]*I+f[0]*z+y[0]*C+R[0]*B,e[1]=t[1]*I+f[1]*z+y[1]*C+R[1]*B,e[2]=t[2]*I+f[2]*z+y[2]*C+R[2]*B,e}function Ls(e,t,f,y,R,L){var O=1-L,I=O*O,z=L*L,C=I*O,B=3*L*I,D=3*z*O,G=z*L;return e[0]=t[0]*C+f[0]*B+y[0]*D+R[0]*G,e[1]=t[1]*C+f[1]*B+y[1]*D+R[1]*G,e[2]=t[2]*C+f[2]*B+y[2]*D+R[2]*G,e}function Ps(e,t){t=t||1;var f=2*h()*Math.PI,y=2*h()-1,R=Math.sqrt(1-y*y)*t;return e[0]=Math.cos(f)*R,e[1]=Math.sin(f)*R,e[2]=y*t,e}function Os(e,t,f){var y=t[0],R=t[1],L=t[2],O=f[3]*y+f[7]*R+f[11]*L+f[15];return O=O||1,e[0]=(f[0]*y+f[4]*R+f[8]*L+f[12])/O,e[1]=(f[1]*y+f[5]*R+f[9]*L+f[13])/O,e[2]=(f[2]*y+f[6]*R+f[10]*L+f[14])/O,e}function Is(e,t,f){var y=t[0],R=t[1],L=t[2];return e[0]=y*f[0]+R*f[3]+L*f[6],e[1]=y*f[1]+R*f[4]+L*f[7],e[2]=y*f[2]+R*f[5]+L*f[8],e}function Fs(e,t,f){var y=f[0],R=f[1],L=f[2],O=f[3],I=t[0],z=t[1],C=t[2],B=R*C-L*z,D=L*I-y*C,G=y*z-R*I,j=R*G-L*D,W=L*B-y*G,H=y*D-R*B,U=2*O;return B*=U,D*=U,G*=U,j*=2,W*=2,H*=2,e[0]=I+B+j,e[1]=z+D+W,e[2]=C+G+H,e}function zs(e,t,f,y){var R=[],L=[];return R[0]=t[0]-f[0],R[1]=t[1]-f[1],R[2]=t[2]-f[2],L[0]=R[0],L[1]=R[1]*Math.cos(y)-R[2]*Math.sin(y),L[2]=R[1]*Math.sin(y)+R[2]*Math.cos(y),e[0]=L[0]+f[0],e[1]=L[1]+f[1],e[2]=L[2]+f[2],e}function Ns(e,t,f,y){var R=[],L=[];return R[0]=t[0]-f[0],R[1]=t[1]-f[1],R[2]=t[2]-f[2],L[0]=R[2]*Math.sin(y)+R[0]*Math.cos(y),L[1]=R[1],L[2]=R[2]*Math.cos(y)-R[0]*Math.sin(y),e[0]=L[0]+f[0],e[1]=L[1]+f[1],e[2]=L[2]+f[2],e}function Cs(e,t,f,y){var R=[],L=[];return R[0]=t[0]-f[0],R[1]=t[1]-f[1],R[2]=t[2]-f[2],L[0]=R[0]*Math.cos(y)-R[1]*Math.sin(y),L[1]=R[0]*Math.sin(y)+R[1]*Math.cos(y),L[2]=R[2],e[0]=L[0]+f[0],e[1]=L[1]+f[1],e[2]=L[2]+f[2],e}function Bs(e,t){var f=e[0],y=e[1],R=e[2],L=t[0],O=t[1],I=t[2],z=Math.sqrt(f*f+y*y+R*R)*Math.sqrt(L*L+O*O+I*I),C=z&&kt(e,t)/z;return Math.acos(Math.min(Math.max(C,-1),1))}function Ds(e){return e[0]=0,e[1]=0,e[2]=0,e}function Gs(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function js(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Us(e,t){var f=e[0],y=e[1],R=e[2],L=t[0],O=t[1],I=t[2];return Math.abs(f-L)<=s*Math.max(1,Math.abs(f),Math.abs(L))&&Math.abs(y-O)<=s*Math.max(1,Math.abs(y),Math.abs(O))&&Math.abs(R-I)<=s*Math.max(1,Math.abs(R),Math.abs(I))}var Ue,ks=br,Vs=Er,Xs=yr,Ws=xr,Hs=Tr,Mr=gr,$s=Ar,qs=(Ue=jt(),function(e,t,f,y,R,L){var O,I;for(t||(t=3),f||(f=0),I=y?Math.min(y*t+f,e.length):e.length,O=f;O<I;O+=t)Ue[0]=e[O],Ue[1]=e[O+1],Ue[2]=e[O+2],R(Ue,Ue,L),e[O]=Ue[0],e[O+1]=Ue[1],e[O+2]=Ue[2];return e});function Rr(){var e=new a(4);return a!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function wr(e){var t=new a(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Lr(e,t,f,y){var R=new a(4);return R[0]=e,R[1]=t,R[2]=f,R[3]=y,R}function Pr(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Or(e,t,f,y,R){return e[0]=t,e[1]=f,e[2]=y,e[3]=R,e}function Ir(e,t,f){return e[0]=t[0]+f[0],e[1]=t[1]+f[1],e[2]=t[2]+f[2],e[3]=t[3]+f[3],e}function Fr(e,t,f){return e[0]=t[0]-f[0],e[1]=t[1]-f[1],e[2]=t[2]-f[2],e[3]=t[3]-f[3],e}function zr(e,t,f){return e[0]=t[0]*f[0],e[1]=t[1]*f[1],e[2]=t[2]*f[2],e[3]=t[3]*f[3],e}function Nr(e,t,f){return e[0]=t[0]/f[0],e[1]=t[1]/f[1],e[2]=t[2]/f[2],e[3]=t[3]/f[3],e}function Ys(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Zs(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Ks(e,t,f){return e[0]=Math.min(t[0],f[0]),e[1]=Math.min(t[1],f[1]),e[2]=Math.min(t[2],f[2]),e[3]=Math.min(t[3],f[3]),e}function Js(e,t,f){return e[0]=Math.max(t[0],f[0]),e[1]=Math.max(t[1],f[1]),e[2]=Math.max(t[2],f[2]),e[3]=Math.max(t[3],f[3]),e}function Qs(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Cr(e,t,f){return e[0]=t[0]*f,e[1]=t[1]*f,e[2]=t[2]*f,e[3]=t[3]*f,e}function ea(e,t,f,y){return e[0]=t[0]+f[0]*y,e[1]=t[1]+f[1]*y,e[2]=t[2]+f[2]*y,e[3]=t[3]+f[3]*y,e}function Br(e,t){var f=t[0]-e[0],y=t[1]-e[1],R=t[2]-e[2],L=t[3]-e[3];return Math.hypot(f,y,R,L)}function Dr(e,t){var f=t[0]-e[0],y=t[1]-e[1],R=t[2]-e[2],L=t[3]-e[3];return f*f+y*y+R*R+L*L}function Vt(e){var t=e[0],f=e[1],y=e[2],R=e[3];return Math.hypot(t,f,y,R)}function Xt(e){var t=e[0],f=e[1],y=e[2],R=e[3];return t*t+f*f+y*y+R*R}function ta(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function ra(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Gr(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=f*f+y*y+R*R+L*L;return O>0&&(O=1/Math.sqrt(O)),e[0]=f*O,e[1]=y*O,e[2]=R*O,e[3]=L*O,e}function jr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function ia(e,t,f,y){var R=f[0]*y[1]-f[1]*y[0],L=f[0]*y[2]-f[2]*y[0],O=f[0]*y[3]-f[3]*y[0],I=f[1]*y[2]-f[2]*y[1],z=f[1]*y[3]-f[3]*y[1],C=f[2]*y[3]-f[3]*y[2],B=t[0],D=t[1],G=t[2],j=t[3];return e[0]=D*C-G*z+j*I,e[1]=-B*C+G*O-j*L,e[2]=B*z-D*O+j*R,e[3]=-B*I+D*L-G*R,e}function Ur(e,t,f,y){var R=t[0],L=t[1],O=t[2],I=t[3];return e[0]=R+y*(f[0]-R),e[1]=L+y*(f[1]-L),e[2]=O+y*(f[2]-O),e[3]=I+y*(f[3]-I),e}function na(e,t){var f,y,R,L,O,I;t=t||1;do O=(f=2*h()-1)*f+(y=2*h()-1)*y;while(O>=1);do I=(R=2*h()-1)*R+(L=2*h()-1)*L;while(I>=1);var z=Math.sqrt((1-O)/I);return e[0]=t*f,e[1]=t*y,e[2]=t*R*z,e[3]=t*L*z,e}function sa(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3];return e[0]=f[0]*y+f[4]*R+f[8]*L+f[12]*O,e[1]=f[1]*y+f[5]*R+f[9]*L+f[13]*O,e[2]=f[2]*y+f[6]*R+f[10]*L+f[14]*O,e[3]=f[3]*y+f[7]*R+f[11]*L+f[15]*O,e}function aa(e,t,f){var y=t[0],R=t[1],L=t[2],O=f[0],I=f[1],z=f[2],C=f[3],B=C*y+I*L-z*R,D=C*R+z*y-O*L,G=C*L+O*R-I*y,j=-O*y-I*R-z*L;return e[0]=B*C+j*-O+D*-z-G*-I,e[1]=D*C+j*-I+G*-O-B*-z,e[2]=G*C+j*-z+B*-I-D*-O,e[3]=t[3],e}function oa(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function ca(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function kr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Vr(e,t){var f=e[0],y=e[1],R=e[2],L=e[3],O=t[0],I=t[1],z=t[2],C=t[3];return Math.abs(f-O)<=s*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(y-I)<=s*Math.max(1,Math.abs(y),Math.abs(I))&&Math.abs(R-z)<=s*Math.max(1,Math.abs(R),Math.abs(z))&&Math.abs(L-C)<=s*Math.max(1,Math.abs(L),Math.abs(C))}var ua=Fr,ha=zr,la=Nr,da=Br,fa=Dr,_a=Vt,pa=Xt,ma=function(){var e=Rr();return function(t,f,y,R,L,O){var I,z;for(f||(f=4),y||(y=0),z=R?Math.min(R*f+y,t.length):t.length,I=y;I<z;I+=f)e[0]=t[I],e[1]=t[I+1],e[2]=t[I+2],e[3]=t[I+3],L(e,e,O),t[I]=e[0],t[I+1]=e[1],t[I+2]=e[2],t[I+3]=e[3];return t}}();function yt(){var e=new a(4);return a!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function va(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Xr(e,t,f){f*=.5;var y=Math.sin(f);return e[0]=y*t[0],e[1]=y*t[1],e[2]=y*t[2],e[3]=Math.cos(f),e}function ga(e,t){var f=2*Math.acos(t[3]),y=Math.sin(f/2);return y>s?(e[0]=t[0]/y,e[1]=t[1]/y,e[2]=t[2]/y):(e[0]=1,e[1]=0,e[2]=0),f}function ba(e,t){var f=qt(e,t);return Math.acos(2*f*f-1)}function Wr(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=f[0],z=f[1],C=f[2],B=f[3];return e[0]=y*B+O*I+R*C-L*z,e[1]=R*B+O*z+L*I-y*C,e[2]=L*B+O*C+y*z-R*I,e[3]=O*B-y*I-R*z-L*C,e}function Hr(e,t,f){f*=.5;var y=t[0],R=t[1],L=t[2],O=t[3],I=Math.sin(f),z=Math.cos(f);return e[0]=y*z+O*I,e[1]=R*z+L*I,e[2]=L*z-R*I,e[3]=O*z-y*I,e}function $r(e,t,f){f*=.5;var y=t[0],R=t[1],L=t[2],O=t[3],I=Math.sin(f),z=Math.cos(f);return e[0]=y*z-L*I,e[1]=R*z+O*I,e[2]=L*z+y*I,e[3]=O*z-R*I,e}function qr(e,t,f){f*=.5;var y=t[0],R=t[1],L=t[2],O=t[3],I=Math.sin(f),z=Math.cos(f);return e[0]=y*z+R*I,e[1]=R*z-y*I,e[2]=L*z+O*I,e[3]=O*z-L*I,e}function Ea(e,t){var f=t[0],y=t[1],R=t[2];return e[0]=f,e[1]=y,e[2]=R,e[3]=Math.sqrt(Math.abs(1-f*f-y*y-R*R)),e}function Yr(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=Math.sqrt(f*f+y*y+R*R),I=Math.exp(L),z=O>0?I*Math.sin(O)/O:0;return e[0]=f*z,e[1]=y*z,e[2]=R*z,e[3]=I*Math.cos(O),e}function Zr(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=Math.sqrt(f*f+y*y+R*R),I=O>0?Math.atan2(O,L)/O:0;return e[0]=f*I,e[1]=y*I,e[2]=R*I,e[3]=.5*Math.log(f*f+y*y+R*R+L*L),e}function ya(e,t,f){return Zr(e,t),ei(e,e,f),Yr(e,e),e}function xt(e,t,f,y){var R,L,O,I,z,C=t[0],B=t[1],D=t[2],G=t[3],j=f[0],W=f[1],H=f[2],U=f[3];return(L=C*j+B*W+D*H+G*U)<0&&(L=-L,j=-j,W=-W,H=-H,U=-U),1-L>s?(R=Math.acos(L),O=Math.sin(R),I=Math.sin((1-y)*R)/O,z=Math.sin(y*R)/O):(I=1-y,z=y),e[0]=I*C+z*j,e[1]=I*B+z*W,e[2]=I*D+z*H,e[3]=I*G+z*U,e}function xa(e){var t=h(),f=h(),y=h(),R=Math.sqrt(1-t),L=Math.sqrt(t);return e[0]=R*Math.sin(2*Math.PI*f),e[1]=R*Math.cos(2*Math.PI*f),e[2]=L*Math.sin(2*Math.PI*y),e[3]=L*Math.cos(2*Math.PI*y),e}function Ta(e,t){var f=t[0],y=t[1],R=t[2],L=t[3],O=f*f+y*y+R*R+L*L,I=O?1/O:0;return e[0]=-f*I,e[1]=-y*I,e[2]=-R*I,e[3]=L*I,e}function Aa(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Kr(e,t){var f,y=t[0]+t[4]+t[8];if(y>0)f=Math.sqrt(y+1),e[3]=.5*f,f=.5/f,e[0]=(t[5]-t[7])*f,e[1]=(t[6]-t[2])*f,e[2]=(t[1]-t[3])*f;else{var R=0;t[4]>t[0]&&(R=1),t[8]>t[3*R+R]&&(R=2);var L=(R+1)%3,O=(R+2)%3;f=Math.sqrt(t[3*R+R]-t[3*L+L]-t[3*O+O]+1),e[R]=.5*f,f=.5/f,e[3]=(t[3*L+O]-t[3*O+L])*f,e[L]=(t[3*L+R]+t[3*R+L])*f,e[O]=(t[3*O+R]+t[3*R+O])*f}return e}function Sa(e,t,f,y){var R=.5*Math.PI/180;t*=R,f*=R,y*=R;var L=Math.sin(t),O=Math.cos(t),I=Math.sin(f),z=Math.cos(f),C=Math.sin(y),B=Math.cos(y);return e[0]=L*z*B-O*I*C,e[1]=O*I*B+L*z*C,e[2]=O*z*C-L*I*B,e[3]=O*z*B+L*I*C,e}function Ma(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Ne,Jr,Qr,Wt,Ht,Ce,Ra=wr,wa=Lr,$t=Pr,La=Or,Pa=Ir,Oa=Wr,ei=Cr,qt=jr,Ia=Ur,Yt=Vt,Fa=Yt,Zt=Xt,za=Zt,Kt=Gr,Na=kr,Ca=Vr,Ba=(Ne=jt(),Jr=Ut(1,0,0),Qr=Ut(0,1,0),function(e,t,f){var y=kt(t,f);return y<-.999999?(Et(Ne,Jr,t),Mr(Ne)<1e-6&&Et(Ne,Qr,t),Sr(Ne,Ne),Xr(e,Ne,Math.PI),e):y>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(Et(Ne,t,f),e[0]=Ne[0],e[1]=Ne[1],e[2]=Ne[2],e[3]=1+y,Kt(e,e))}),Da=(Wt=yt(),Ht=yt(),function(e,t,f,y,R,L){return xt(Wt,t,R,L),xt(Ht,f,y,L),xt(e,Wt,Ht,2*L*(1-L)),e}),Ga=(Ce=be(),function(e,t,f,y){return Ce[0]=f[0],Ce[3]=f[1],Ce[6]=f[2],Ce[1]=y[0],Ce[4]=y[1],Ce[7]=y[2],Ce[2]=-t[0],Ce[5]=-t[1],Ce[8]=-t[2],Kt(e,Kr(e,Ce))});function ja(){var e=new a(8);return a!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function Ua(e){var t=new a(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function ka(e,t,f,y,R,L,O,I){var z=new a(8);return z[0]=e,z[1]=t,z[2]=f,z[3]=y,z[4]=R,z[5]=L,z[6]=O,z[7]=I,z}function Va(e,t,f,y,R,L,O){var I=new a(8);I[0]=e,I[1]=t,I[2]=f,I[3]=y;var z=.5*R,C=.5*L,B=.5*O;return I[4]=z*y+C*f-B*t,I[5]=C*y+B*e-z*f,I[6]=B*y+z*t-C*e,I[7]=-z*e-C*t-B*f,I}function ti(e,t,f){var y=.5*f[0],R=.5*f[1],L=.5*f[2],O=t[0],I=t[1],z=t[2],C=t[3];return e[0]=O,e[1]=I,e[2]=z,e[3]=C,e[4]=y*C+R*z-L*I,e[5]=R*C+L*O-y*z,e[6]=L*C+y*I-R*O,e[7]=-y*O-R*I-L*z,e}function Xa(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e}function Wa(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Ha(e,t){var f=yt();mr(f,t);var y=new a(3);return _r(y,t),ti(e,f,y),e}function ri(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function $a(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function qa(e,t,f,y,R,L,O,I,z){return e[0]=t,e[1]=f,e[2]=y,e[3]=R,e[4]=L,e[5]=O,e[6]=I,e[7]=z,e}var Ya=$t;function Za(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e}var Ka=$t;function Ja(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e}function Qa(e,t){var f=t[4],y=t[5],R=t[6],L=t[7],O=-t[0],I=-t[1],z=-t[2],C=t[3];return e[0]=2*(f*C+L*O+y*z-R*I),e[1]=2*(y*C+L*I+R*O-f*z),e[2]=2*(R*C+L*z+f*I-y*O),e}function eo(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=.5*f[0],z=.5*f[1],C=.5*f[2],B=t[4],D=t[5],G=t[6],j=t[7];return e[0]=y,e[1]=R,e[2]=L,e[3]=O,e[4]=O*I+R*C-L*z+B,e[5]=O*z+L*I-y*C+D,e[6]=O*C+y*z-R*I+G,e[7]=-y*I-R*z-L*C+j,e}function to(e,t,f){var y=-t[0],R=-t[1],L=-t[2],O=t[3],I=t[4],z=t[5],C=t[6],B=t[7],D=I*O+B*y+z*L-C*R,G=z*O+B*R+C*y-I*L,j=C*O+B*L+I*R-z*y,W=B*O-I*y-z*R-C*L;return Hr(e,t,f),y=e[0],R=e[1],L=e[2],O=e[3],e[4]=D*O+W*y+G*L-j*R,e[5]=G*O+W*R+j*y-D*L,e[6]=j*O+W*L+D*R-G*y,e[7]=W*O-D*y-G*R-j*L,e}function ro(e,t,f){var y=-t[0],R=-t[1],L=-t[2],O=t[3],I=t[4],z=t[5],C=t[6],B=t[7],D=I*O+B*y+z*L-C*R,G=z*O+B*R+C*y-I*L,j=C*O+B*L+I*R-z*y,W=B*O-I*y-z*R-C*L;return $r(e,t,f),y=e[0],R=e[1],L=e[2],O=e[3],e[4]=D*O+W*y+G*L-j*R,e[5]=G*O+W*R+j*y-D*L,e[6]=j*O+W*L+D*R-G*y,e[7]=W*O-D*y-G*R-j*L,e}function io(e,t,f){var y=-t[0],R=-t[1],L=-t[2],O=t[3],I=t[4],z=t[5],C=t[6],B=t[7],D=I*O+B*y+z*L-C*R,G=z*O+B*R+C*y-I*L,j=C*O+B*L+I*R-z*y,W=B*O-I*y-z*R-C*L;return qr(e,t,f),y=e[0],R=e[1],L=e[2],O=e[3],e[4]=D*O+W*y+G*L-j*R,e[5]=G*O+W*R+j*y-D*L,e[6]=j*O+W*L+D*R-G*y,e[7]=W*O-D*y-G*R-j*L,e}function no(e,t,f){var y=f[0],R=f[1],L=f[2],O=f[3],I=t[0],z=t[1],C=t[2],B=t[3];return e[0]=I*O+B*y+z*L-C*R,e[1]=z*O+B*R+C*y-I*L,e[2]=C*O+B*L+I*R-z*y,e[3]=B*O-I*y-z*R-C*L,I=t[4],z=t[5],C=t[6],B=t[7],e[4]=I*O+B*y+z*L-C*R,e[5]=z*O+B*R+C*y-I*L,e[6]=C*O+B*L+I*R-z*y,e[7]=B*O-I*y-z*R-C*L,e}function so(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=f[0],z=f[1],C=f[2],B=f[3];return e[0]=y*B+O*I+R*C-L*z,e[1]=R*B+O*z+L*I-y*C,e[2]=L*B+O*C+y*z-R*I,e[3]=O*B-y*I-R*z-L*C,I=f[4],z=f[5],C=f[6],B=f[7],e[4]=y*B+O*I+R*C-L*z,e[5]=R*B+O*z+L*I-y*C,e[6]=L*B+O*C+y*z-R*I,e[7]=O*B-y*I-R*z-L*C,e}function ao(e,t,f,y){if(Math.abs(y)<s)return ri(e,t);var R=Math.hypot(f[0],f[1],f[2]);y*=.5;var L=Math.sin(y),O=L*f[0]/R,I=L*f[1]/R,z=L*f[2]/R,C=Math.cos(y),B=t[0],D=t[1],G=t[2],j=t[3];e[0]=B*C+j*O+D*z-G*I,e[1]=D*C+j*I+G*O-B*z,e[2]=G*C+j*z+B*I-D*O,e[3]=j*C-B*O-D*I-G*z;var W=t[4],H=t[5],U=t[6],q=t[7];return e[4]=W*C+q*O+H*z-U*I,e[5]=H*C+q*I+U*O-W*z,e[6]=U*C+q*z+W*I-H*O,e[7]=q*C-W*O-H*I-U*z,e}function oo(e,t,f){return e[0]=t[0]+f[0],e[1]=t[1]+f[1],e[2]=t[2]+f[2],e[3]=t[3]+f[3],e[4]=t[4]+f[4],e[5]=t[5]+f[5],e[6]=t[6]+f[6],e[7]=t[7]+f[7],e}function ii(e,t,f){var y=t[0],R=t[1],L=t[2],O=t[3],I=f[4],z=f[5],C=f[6],B=f[7],D=t[4],G=t[5],j=t[6],W=t[7],H=f[0],U=f[1],q=f[2],se=f[3];return e[0]=y*se+O*H+R*q-L*U,e[1]=R*se+O*U+L*H-y*q,e[2]=L*se+O*q+y*U-R*H,e[3]=O*se-y*H-R*U-L*q,e[4]=y*B+O*I+R*C-L*z+D*se+W*H+G*q-j*U,e[5]=R*B+O*z+L*I-y*C+G*se+W*U+j*H-D*q,e[6]=L*B+O*C+y*z-R*I+j*se+W*q+D*U-G*H,e[7]=O*B-y*I-R*z-L*C+W*se-D*H-G*U-j*q,e}var co=ii;function uo(e,t,f){return e[0]=t[0]*f,e[1]=t[1]*f,e[2]=t[2]*f,e[3]=t[3]*f,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e}var ni=qt;function ho(e,t,f,y){var R=1-y;return ni(t,f)<0&&(y=-y),e[0]=t[0]*R+f[0]*y,e[1]=t[1]*R+f[1]*y,e[2]=t[2]*R+f[2]*y,e[3]=t[3]*R+f[3]*y,e[4]=t[4]*R+f[4]*y,e[5]=t[5]*R+f[5]*y,e[6]=t[6]*R+f[6]*y,e[7]=t[7]*R+f[7]*y,e}function lo(e,t){var f=Tt(t);return e[0]=-t[0]/f,e[1]=-t[1]/f,e[2]=-t[2]/f,e[3]=t[3]/f,e[4]=-t[4]/f,e[5]=-t[5]/f,e[6]=-t[6]/f,e[7]=t[7]/f,e}function fo(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e}var si=Yt,_o=si,Tt=Zt,po=Tt;function mo(e,t){var f=Tt(t);if(f>0){f=Math.sqrt(f);var y=t[0]/f,R=t[1]/f,L=t[2]/f,O=t[3]/f,I=t[4],z=t[5],C=t[6],B=t[7],D=y*I+R*z+L*C+O*B;e[0]=y,e[1]=R,e[2]=L,e[3]=O,e[4]=(I-y*D)/f,e[5]=(z-R*D)/f,e[6]=(C-L*D)/f,e[7]=(B-O*D)/f}return e}function vo(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function go(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]}function bo(e,t){var f=e[0],y=e[1],R=e[2],L=e[3],O=e[4],I=e[5],z=e[6],C=e[7],B=t[0],D=t[1],G=t[2],j=t[3],W=t[4],H=t[5],U=t[6],q=t[7];return Math.abs(f-B)<=s*Math.max(1,Math.abs(f),Math.abs(B))&&Math.abs(y-D)<=s*Math.max(1,Math.abs(y),Math.abs(D))&&Math.abs(R-G)<=s*Math.max(1,Math.abs(R),Math.abs(G))&&Math.abs(L-j)<=s*Math.max(1,Math.abs(L),Math.abs(j))&&Math.abs(O-W)<=s*Math.max(1,Math.abs(O),Math.abs(W))&&Math.abs(I-H)<=s*Math.max(1,Math.abs(I),Math.abs(H))&&Math.abs(z-U)<=s*Math.max(1,Math.abs(z),Math.abs(U))&&Math.abs(C-q)<=s*Math.max(1,Math.abs(C),Math.abs(q))}function ai(){var e=new a(2);return a!=Float32Array&&(e[0]=0,e[1]=0),e}function Eo(e){var t=new a(2);return t[0]=e[0],t[1]=e[1],t}function yo(e,t){var f=new a(2);return f[0]=e,f[1]=t,f}function xo(e,t){return e[0]=t[0],e[1]=t[1],e}function To(e,t,f){return e[0]=t,e[1]=f,e}function Ao(e,t,f){return e[0]=t[0]+f[0],e[1]=t[1]+f[1],e}function oi(e,t,f){return e[0]=t[0]-f[0],e[1]=t[1]-f[1],e}function ci(e,t,f){return e[0]=t[0]*f[0],e[1]=t[1]*f[1],e}function ui(e,t,f){return e[0]=t[0]/f[0],e[1]=t[1]/f[1],e}function So(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Mo(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Ro(e,t,f){return e[0]=Math.min(t[0],f[0]),e[1]=Math.min(t[1],f[1]),e}function wo(e,t,f){return e[0]=Math.max(t[0],f[0]),e[1]=Math.max(t[1],f[1]),e}function Lo(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function Po(e,t,f){return e[0]=t[0]*f,e[1]=t[1]*f,e}function Oo(e,t,f,y){return e[0]=t[0]+f[0]*y,e[1]=t[1]+f[1]*y,e}function hi(e,t){var f=t[0]-e[0],y=t[1]-e[1];return Math.hypot(f,y)}function li(e,t){var f=t[0]-e[0],y=t[1]-e[1];return f*f+y*y}function di(e){var t=e[0],f=e[1];return Math.hypot(t,f)}function fi(e){var t=e[0],f=e[1];return t*t+f*f}function Io(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Fo(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function zo(e,t){var f=t[0],y=t[1],R=f*f+y*y;return R>0&&(R=1/Math.sqrt(R)),e[0]=t[0]*R,e[1]=t[1]*R,e}function No(e,t){return e[0]*t[0]+e[1]*t[1]}function Co(e,t,f){var y=t[0]*f[1]-t[1]*f[0];return e[0]=e[1]=0,e[2]=y,e}function Bo(e,t,f,y){var R=t[0],L=t[1];return e[0]=R+y*(f[0]-R),e[1]=L+y*(f[1]-L),e}function Do(e,t){t=t||1;var f=2*h()*Math.PI;return e[0]=Math.cos(f)*t,e[1]=Math.sin(f)*t,e}function Go(e,t,f){var y=t[0],R=t[1];return e[0]=f[0]*y+f[2]*R,e[1]=f[1]*y+f[3]*R,e}function jo(e,t,f){var y=t[0],R=t[1];return e[0]=f[0]*y+f[2]*R+f[4],e[1]=f[1]*y+f[3]*R+f[5],e}function Uo(e,t,f){var y=t[0],R=t[1];return e[0]=f[0]*y+f[3]*R+f[6],e[1]=f[1]*y+f[4]*R+f[7],e}function ko(e,t,f){var y=t[0],R=t[1];return e[0]=f[0]*y+f[4]*R+f[12],e[1]=f[1]*y+f[5]*R+f[13],e}function Vo(e,t,f,y){var R=t[0]-f[0],L=t[1]-f[1],O=Math.sin(y),I=Math.cos(y);return e[0]=R*I-L*O+f[0],e[1]=R*O+L*I+f[1],e}function Xo(e,t){var f=e[0],y=e[1],R=t[0],L=t[1],O=Math.sqrt(f*f+y*y)*Math.sqrt(R*R+L*L),I=O&&(f*R+y*L)/O;return Math.acos(Math.min(Math.max(I,-1),1))}function Wo(e){return e[0]=0,e[1]=0,e}function Ho(e){return"vec2("+e[0]+", "+e[1]+")"}function $o(e,t){return e[0]===t[0]&&e[1]===t[1]}function qo(e,t){var f=e[0],y=e[1],R=t[0],L=t[1];return Math.abs(f-R)<=s*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(y-L)<=s*Math.max(1,Math.abs(y),Math.abs(L))}var Yo=di,Zo=oi,Ko=ci,Jo=ui,Qo=hi,ec=li,tc=fi,rc=function(){var e=ai();return function(t,f,y,R,L,O){var I,z;for(f||(f=2),y||(y=0),z=R?Math.min(R*f+y,t.length):t.length,I=y;I<z;I+=f)e[0]=t[I],e[1]=t[I+1],L(e,e,O),t[I]=e[0],t[I+1]=e[1];return t}}()},3041:x=>{x.exports=function(c){var _={};function d(l){if(_[l])return _[l].exports;var g=_[l]={i:l,l:!1,exports:{}};return c[l].call(g.exports,g,g.exports,d),g.l=!0,g.exports}return d.m=c,d.c=_,d.d=function(l,g,v){d.o(l,g)||Object.defineProperty(l,g,{enumerable:!0,get:v})},d.r=function(l){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},d.t=function(l,g){if(1&g&&(l=d(l)),8&g||4&g&&typeof l=="object"&&l&&l.__esModule)return l;var v=Object.create(null);if(d.r(v),Object.defineProperty(v,"default",{enumerable:!0,value:l}),2&g&&typeof l!="string")for(var p in l)d.d(v,p,function(o){return l[o]}.bind(null,p));return v},d.n=function(l){var g=l&&l.__esModule?function(){return l.default}:function(){return l};return d.d(g,"a",g),g},d.o=function(l,g){return Object.prototype.hasOwnProperty.call(l,g)},d.p="",d(d.s=7)}([function(c,_,d){Object.defineProperty(_,"__esModule",{value:!0}),_.LoadingManager=class{constructor(){this.urlModifier=void 0,this.onStart=void 0,this.onProgress=void 0,this.onLoad=void 0,this.onError=void 0,this.isLoading=!1,this.itemsLoaded=0,this.itemsTotal=0}itemStart(l){this.itemsTotal++,!this.isLoading&&this.onStart&&this.onStart(l,this.itemsLoaded,this.itemsTotal),this.isLoading=!0}itemEnd(l){this.itemsLoaded++,this.onProgress&&this.onProgress(l,this.itemsLoaded,this.itemsTotal),this.itemsLoaded===this.itemsTotal&&(this.isLoading=!1,this.onLoad&&this.onLoad())}itemError(l){this.onError&&this.onError(l)}resolveURL(l){return this.urlModifier?this.urlModifier(l):l}}},function(c,_,d){var l=this&&this.__awaiter||function(n,i,u,s){return new(u||(u=Promise))(function(a,h){function b(S){try{M(s.next(S))}catch(w){h(w)}}function m(S){try{M(s.throw(S))}catch(w){h(w)}}function M(S){S.done?a(S.value):new u(function(w){w(S.value)}).then(b,m)}M((s=s.apply(n,i||[])).next())})};Object.defineProperty(_,"__esModule",{value:!0});const g=d(3),v=d(0);_.GLTF_COMPONENT_TYPE_ARRAYS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},_.GLTF_ELEMENTS_PER_TYPE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_.GltfAsset=class{constructor(n,i,u,s=new v.LoadingManager){this.gltf=n,this.glbData=u,this.bufferData=new p(this,i,s),this.imageData=new o(this,i,s)}bufferViewData(n){return l(this,void 0,void 0,function*(){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const i=this.gltf.bufferViews[n],u=yield this.bufferData.get(i.buffer),s=i.byteLength||0,a=i.byteOffset||0,h=u.buffer,b=u.byteOffset;return new Uint8Array(h,b+a,s)})}accessorData(n){return l(this,void 0,void 0,function*(){if(!this.gltf.accessors)throw new Error("No accessors views found.");const i=this.gltf.accessors[n],u=_.GLTF_ELEMENTS_PER_TYPE[i.type];let s;if(i.bufferView!==void 0)s=yield this.bufferViewData(i.bufferView);else{const a=_.GLTF_COMPONENT_TYPE_ARRAYS[i.componentType].BYTES_PER_ELEMENT*u*i.count;s=new Uint8Array(a)}if(i.sparse){const{count:a,indices:h,values:b}=i.sparse;let m=_.GLTF_COMPONENT_TYPE_ARRAYS[h.componentType],M=yield this.bufferViewData(h.bufferView);const S=new m(M.buffer,M.byteOffset+(h.byteOffset||0),a);m=_.GLTF_COMPONENT_TYPE_ARRAYS[i.componentType],M=yield this.bufferViewData(b.bufferView);const w=new m((yield this.bufferViewData(b.bufferView)).buffer,M.byteOffset+(b.byteOffset||0),a*u);i.bufferView&&(s=new Uint8Array(s));const N=new _.GLTF_COMPONENT_TYPE_ARRAYS[i.componentType](s.buffer);for(let F=0;F<a;F++)for(let k=0;k<u;k++)N[u*S[F]+k]=w[u*F+k]}return s})}preFetchAll(){return l(this,void 0,void 0,function*(){return Promise.all([this.bufferData.preFetchAll(),this.imageData.preFetchAll()])})}};class p{constructor(i,u,s){this.bufferCache=[],this.asset=i,this.baseUri=u,this.manager=s,this.loader=new g.FileLoader(s),this.loader.responseType="arraybuffer"}get(i){return l(this,void 0,void 0,function*(){if(this.bufferCache[i]!==void 0)return this.bufferCache[i];const u=this.asset.gltf;if(!u.buffers)throw new Error("No buffers found.");const s=u.buffers[i];if(s.uri===void 0){if(i!==0)throw new Error("GLB container is required to be the first buffer");if(this.asset.glbData===void 0)throw new Error("invalid gltf: buffer has no uri nor is there a GLB buffer");return this.asset.glbData.binaryChunk}const a=r(s.uri,this.baseUri),h=yield this.loader.load(a),b=new Uint8Array(h);return this.bufferCache[i]=b,b})}preFetchAll(){return l(this,void 0,void 0,function*(){const i=this.asset.gltf.buffers;return i?Promise.all(i.map((u,s)=>this.get(s))):[]})}}_.BufferData=p;class o{constructor(i,u,s){this.crossOrigin="anonymous",this.imageCache=[],this.asset=i,this.baseUri=u,this.manager=s}get(i){return l(this,void 0,void 0,function*(){if(this.imageCache[i]!==void 0)return this.imageCache[i];const u=this.asset.gltf;if(!u.images)throw new Error("No images found.");const s=u.images[i];let a,h=!1;if(s.bufferView!==void 0){const m=yield this.asset.bufferViewData(s.bufferView);h=!0;const M=new Blob([m],{type:s.mimeType});a=URL.createObjectURL(M)}else{if(s.uri===void 0)throw new Error("Invalid glTF: image must either have a `uri` or a `bufferView`");a=this.manager.resolveURL(r(s.uri,this.baseUri))}const b=new Image;return b.crossOrigin=this.crossOrigin,new Promise((m,M)=>{b.onerror=()=>{M(`Failed to load ${a}`),this.manager.itemEnd(a),this.manager.itemError(a)},b.onload=()=>{h&&URL.revokeObjectURL(a),this.imageCache[i]=b,m(b),this.manager.itemEnd(a)},b.src=a,this.manager.itemStart(a)})})}preFetchAll(){return l(this,void 0,void 0,function*(){const i=this.asset.gltf.images;return i?Promise.all(i.map((u,s)=>this.get(s))):[]})}}function r(n,i){return typeof n!="string"||n===""?"":/^(https?:)?\/\//i.test(n)||/^data:.*,.*$/i.test(n)||/^blob:.*$/i.test(n)?n:i+n}_.ImageData=o,_.resolveURL=r},function(c,_,d){Object.defineProperty(_,"__esModule",{value:!0}),_.LoaderUtils=class{static decodeText(l){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(l);let g="";for(const v of l)g+=String.fromCharCode(v);return decodeURIComponent(escape(g))}static extractUrlBase(l){const g=l.split("/");return g.length===1?"./":(g.pop(),g.join("/")+"/")}}},function(c,_,d){Object.defineProperty(_,"__esModule",{value:!0}),_.FileLoader=class{constructor(l){this.runningRequests={},this.manager=l}load(l,g){if(this.path!==void 0&&(l=this.path+l),l=this.manager.resolveURL(l),this.runningRequests[l])return this.runningRequests[l];const v=new Promise((p,o)=>{const r=new XMLHttpRequest;r.open("GET",l,!0);const n=this;r.onload=function(i){const u=this.response;this.status===0?(console.warn("FileLoader: HTTP Status 0 received."),p(u),n.manager.itemEnd(l)):this.status===200?(p(u),n.manager.itemEnd(l)):(o({url:l,status:this.status,statusText:r.statusText}),n.manager.itemEnd(l),n.manager.itemError(l)),delete n.runningRequests[l]},r.onprogress=i=>{g&&g(i)},r.onerror=function(i){o({url:l,status:this.status,statusText:r.statusText}),n.manager.itemEnd(l),n.manager.itemError(l),delete n.runningRequests[l]},this.responseType&&(r.responseType=this.responseType),this.withCredentials&&(r.withCredentials=this.withCredentials),this.mimeType&&r.overrideMimeType&&r.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const i in this.requestHeaders)r.setRequestHeader(i,this.requestHeaders[i]);r.send(null),this.manager.itemStart(l)});return this.runningRequests[l]=v,v}setRequestHeader(l,g){return this.requestHeaders[l]=g,this}}},function(c,_,d){Object.defineProperty(_,"__esModule",{value:!0})},function(c,_,d){Object.defineProperty(_,"__esModule",{value:!0});const l=d(2);_.BINARY_HEADER_MAGIC="glTF",_.GLTFBinaryData=class{constructor(g){const v=new DataView(g,0,12),p=l.LoaderUtils.decodeText(new Uint8Array(g,0,4)),o=v.getUint32(4,!0);if(v.getUint32(8,!0),p!==_.BINARY_HEADER_MAGIC)throw new Error("Unsupported glTF-Binary header.");if(o<2)throw new Error("Unsupported legacy binary file detected.");const r=new DataView(g,12);let n=0;for(;n<r.byteLength;){const i=r.getUint32(n,!0);n+=4;const u=r.getUint32(n,!0);if(n+=4,u===1313821514){const s=new Uint8Array(g,12+n,i);this.json=l.LoaderUtils.decodeText(s)}else if(u===5130562){const s=12+n;this.binaryChunk=new Uint8Array(g,s,i)}n+=i}if(this.json===null)throw new Error("glTF-Binary: JSON content not found.")}}},function(c,_,d){var l=this&&this.__awaiter||function(u,s,a,h){return new(a||(a=Promise))(function(b,m){function M(N){try{w(h.next(N))}catch(F){m(F)}}function S(N){try{w(h.throw(N))}catch(F){m(F)}}function w(N){N.done?b(N.value):new a(function(F){F(N.value)}).then(M,S)}w((h=h.apply(u,s||[])).next())})};function g(u){for(var s in u)_.hasOwnProperty(s)||(_[s]=u[s])}Object.defineProperty(_,"__esModule",{value:!0});const v=d(3),p=d(5),o=d(1),r=d(2),n=d(0),i=d(4);_.gltf=i,g(d(1)),g(d(0)),_.GltfLoader=class{constructor(u){this.manager=u||new n.LoadingManager}load(u,s){return l(this,void 0,void 0,function*(){const a=r.LoaderUtils.extractUrlBase(u),h=new v.FileLoader(this.manager);h.responseType="arraybuffer";const b=yield h.load(u,s);return yield this.parse(b,a)})}loadFromFiles(u){return l(this,void 0,void 0,function*(){let s,a;for(const[S,w]of u)w.name.match(/\.(gltf|glb)$/)&&(s=w,a=S.replace(w.name,""));if(!s)throw new Error("No .gltf or .glb asset found.");const h=typeof s=="string"?s:URL.createObjectURL(s),b=r.LoaderUtils.extractUrlBase(h),m=[];this.manager.urlModifier=S=>{const w=a+S.replace(b,"").replace(/^(\.?\/)/,"");if(u.has(w)){const N=u.get(w),F=URL.createObjectURL(N);return m.push(F),F}return S};const M=yield this.load(h);return yield M.preFetchAll(),URL.revokeObjectURL(h),m.forEach(URL.revokeObjectURL),M})}parse(u,s){return l(this,void 0,void 0,function*(){let a,h;a=typeof u=="string"?u:r.LoaderUtils.decodeText(new Uint8Array(u,0,4))===p.BINARY_HEADER_MAGIC?(h=new p.GLTFBinaryData(u)).json:r.LoaderUtils.decodeText(new Uint8Array(u));const b=JSON.parse(a);if(b.asset===void 0||b.asset.version[0]<2)throw new Error("Unsupported asset. glTF versions >=2.0 are supported.");return new o.GltfAsset(b,s,h,this.manager)})}}},function(c,_,d){c.exports=d(6)}])},9609:(x,c,_)=>{var d=_(3533),l=d.ValidatorResult,g=d.SchemaError,v={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,additionalItems:!0,then:!0,else:!0,$schema:!0,$ref:!0,extends:!0}},p=v.validators={};function o(s,a,h,b,m){var M=a.throwError,S=a.throwAll;a.throwError=!1,a.throwAll=!1;var w=this.validateSchema(s,m,a,h);return a.throwError=M,a.throwAll=S,!w.valid&&b instanceof Function&&b(w),w.valid}function r(s,a){if(Object.hasOwnProperty.call(s,a))return s[a];if(a in s){for(;s=Object.getPrototypeOf(s);)if(Object.propertyIsEnumerable.call(s,a))return s[a]}}function n(s,a,h,b,m,M){if(this.types.object(s)&&(!a.properties||a.properties[m]===void 0))if(a.additionalProperties===!1)M.addError({name:"additionalProperties",argument:m,message:"is not allowed to have the additional property "+JSON.stringify(m)});else{var S=a.additionalProperties||{};typeof h.preValidateProperty=="function"&&h.preValidateProperty(s,m,S,h,b);var w=this.validateSchema(s[m],S,h,b.makeChild(S,m));w.instance!==M.instance[m]&&(M.instance[m]=w.instance),M.importErrors(w)}}p.type=function(s,a,h,b){if(s===void 0)return null;var m=new l(s,a,h,b),M=Array.isArray(a.type)?a.type:[a.type];if(!M.some(this.testType.bind(this,s,a,h,b))){var S=M.map(function(w){if(w){var N=w.$id||w.id;return N?"<"+N+">":w+""}});m.addError({name:"type",argument:S,message:"is not of a type(s) "+S})}return m},p.anyOf=function(s,a,h,b){if(s===void 0)return null;var m=new l(s,a,h,b),M=new l(s,a,h,b);if(!Array.isArray(a.anyOf))throw new g("anyOf must be an array");if(!a.anyOf.some(o.bind(this,s,h,b,function(w){M.importErrors(w)}))){var S=a.anyOf.map(function(w,N){var F=w.$id||w.id;return F?"<"+F+">":w.title&&JSON.stringify(w.title)||w.$ref&&"<"+w.$ref+">"||"[subschema "+N+"]"});h.nestedErrors&&m.importErrors(M),m.addError({name:"anyOf",argument:S,message:"is not any of "+S.join(",")})}return m},p.allOf=function(s,a,h,b){if(s===void 0)return null;if(!Array.isArray(a.allOf))throw new g("allOf must be an array");var m=new l(s,a,h,b),M=this;return a.allOf.forEach(function(S,w){var N=M.validateSchema(s,S,h,b);if(!N.valid){var F=S.$id||S.id||S.title&&JSON.stringify(S.title)||S.$ref&&"<"+S.$ref+">"||"[subschema "+w+"]";m.addError({name:"allOf",argument:{id:F,length:N.errors.length,valid:N},message:"does not match allOf schema "+F+" with "+N.errors.length+" error[s]:"}),m.importErrors(N)}}),m},p.oneOf=function(s,a,h,b){if(s===void 0)return null;if(!Array.isArray(a.oneOf))throw new g("oneOf must be an array");var m=new l(s,a,h,b),M=new l(s,a,h,b),S=a.oneOf.filter(o.bind(this,s,h,b,function(N){M.importErrors(N)})).length,w=a.oneOf.map(function(N,F){return N.$id||N.id||N.title&&JSON.stringify(N.title)||N.$ref&&"<"+N.$ref+">"||"[subschema "+F+"]"});return S!==1&&(h.nestedErrors&&m.importErrors(M),m.addError({name:"oneOf",argument:w,message:"is not exactly one from "+w.join(",")})),m},p.if=function(s,a,h,b){if(s===void 0)return null;if(!d.isSchema(a.if))throw new Error('Expected "if" keyword to be a schema');var m,M=o.call(this,s,h,b,null,a.if),S=new l(s,a,h,b);if(M){if(a.then===void 0)return;if(!d.isSchema(a.then))throw new Error('Expected "then" keyword to be a schema');m=this.validateSchema(s,a.then,h,b.makeChild(a.then)),S.importErrors(m)}else{if(a.else===void 0)return;if(!d.isSchema(a.else))throw new Error('Expected "else" keyword to be a schema');m=this.validateSchema(s,a.else,h,b.makeChild(a.else)),S.importErrors(m)}return S},p.propertyNames=function(s,a,h,b){if(this.types.object(s)){var m=new l(s,a,h,b),M=a.propertyNames!==void 0?a.propertyNames:{};if(!d.isSchema(M))throw new g('Expected "propertyNames" to be a schema (object or boolean)');for(var S in s)if(r(s,S)!==void 0){var w=this.validateSchema(S,M,h,b.makeChild(M));m.importErrors(w)}return m}},p.properties=function(s,a,h,b){if(this.types.object(s)){var m=new l(s,a,h,b),M=a.properties||{};for(var S in M){var w=M[S];if(w!==void 0){if(w===null)throw new g('Unexpected null, expected schema in "properties"');typeof h.preValidateProperty=="function"&&h.preValidateProperty(s,S,w,h,b);var N=r(s,S),F=this.validateSchema(N,w,h,b.makeChild(w,S));F.instance!==m.instance[S]&&(m.instance[S]=F.instance),m.importErrors(F)}}return m}},p.patternProperties=function(s,a,h,b){if(this.types.object(s)){var m=new l(s,a,h,b),M=a.patternProperties||{};for(var S in s){var w=!0;for(var N in M){var F=M[N];if(F!==void 0){if(F===null)throw new g('Unexpected null, expected schema in "patternProperties"');try{var k=new RegExp(N,"u")}catch{k=new RegExp(N)}if(k.test(S)){w=!1,typeof h.preValidateProperty=="function"&&h.preValidateProperty(s,S,F,h,b);var X=this.validateSchema(s[S],F,h,b.makeChild(F,S));X.instance!==m.instance[S]&&(m.instance[S]=X.instance),m.importErrors(X)}}}w&&n.call(this,s,a,h,b,S,m)}return m}},p.additionalProperties=function(s,a,h,b){if(this.types.object(s)){if(a.patternProperties)return null;var m=new l(s,a,h,b);for(var M in s)n.call(this,s,a,h,b,M,m);return m}},p.minProperties=function(s,a,h,b){if(this.types.object(s)){var m=new l(s,a,h,b);return Object.keys(s).length>=a.minProperties||m.addError({name:"minProperties",argument:a.minProperties,message:"does not meet minimum property length of "+a.minProperties}),m}},p.maxProperties=function(s,a,h,b){if(this.types.object(s)){var m=new l(s,a,h,b);return Object.keys(s).length<=a.maxProperties||m.addError({name:"maxProperties",argument:a.maxProperties,message:"does not meet maximum property length of "+a.maxProperties}),m}},p.items=function(s,a,h,b){var m=this;if(this.types.array(s)&&a.items){var M=new l(s,a,h,b);return s.every(function(S,w){var N=Array.isArray(a.items)?a.items[w]||a.additionalItems:a.items;if(N===void 0)return!0;if(N===!1)return M.addError({name:"items",message:"additionalItems not permitted"}),!1;var F=m.validateSchema(S,N,h,b.makeChild(N,w));return F.instance!==M.instance[w]&&(M.instance[w]=F.instance),M.importErrors(F),!0}),M}},p.minimum=function(s,a,h,b){if(this.types.number(s)){var m=new l(s,a,h,b);return a.exclusiveMinimum&&a.exclusiveMinimum===!0?s>a.minimum||m.addError({name:"minimum",argument:a.minimum,message:"must be greater than "+a.minimum}):s>=a.minimum||m.addError({name:"minimum",argument:a.minimum,message:"must be greater than or equal to "+a.minimum}),m}},p.maximum=function(s,a,h,b){if(this.types.number(s)){var m=new l(s,a,h,b);return a.exclusiveMaximum&&a.exclusiveMaximum===!0?s<a.maximum||m.addError({name:"maximum",argument:a.maximum,message:"must be less than "+a.maximum}):s<=a.maximum||m.addError({name:"maximum",argument:a.maximum,message:"must be less than or equal to "+a.maximum}),m}},p.exclusiveMinimum=function(s,a,h,b){if(typeof a.exclusiveMaximum!="boolean"&&this.types.number(s)){var m=new l(s,a,h,b);return s>a.exclusiveMinimum||m.addError({name:"exclusiveMinimum",argument:a.exclusiveMinimum,message:"must be strictly greater than "+a.exclusiveMinimum}),m}},p.exclusiveMaximum=function(s,a,h,b){if(typeof a.exclusiveMaximum!="boolean"&&this.types.number(s)){var m=new l(s,a,h,b);return s<a.exclusiveMaximum||m.addError({name:"exclusiveMaximum",argument:a.exclusiveMaximum,message:"must be strictly less than "+a.exclusiveMaximum}),m}};var i=function(s,a,h,b,m,M){if(this.types.number(s)){var S=a[m];if(S==0)throw new g(m+" cannot be zero");var w=new l(s,a,h,b),N=d.getDecimalPlaces(s),F=d.getDecimalPlaces(S),k=Math.max(N,F),X=Math.pow(10,k);return Math.round(s*X)%Math.round(S*X)!=0&&w.addError({name:m,argument:S,message:M+JSON.stringify(S)}),w}};function u(s,a,h){var b,m=h.length;for(b=a+1;b<m;b++)if(d.deepCompareStrict(s,h[b]))return!1;return!0}p.multipleOf=function(s,a,h,b){return i.call(this,s,a,h,b,"multipleOf","is not a multiple of (divisible by) ")},p.divisibleBy=function(s,a,h,b){return i.call(this,s,a,h,b,"divisibleBy","is not divisible by (multiple of) ")},p.required=function(s,a,h,b){var m=new l(s,a,h,b);return s===void 0&&a.required===!0?m.addError({name:"required",message:"is required"}):this.types.object(s)&&Array.isArray(a.required)&&a.required.forEach(function(M){r(s,M)===void 0&&m.addError({name:"required",argument:M,message:"requires property "+JSON.stringify(M)})}),m},p.pattern=function(s,a,h,b){if(this.types.string(s)){var m=new l(s,a,h,b),M=a.pattern;try{var S=new RegExp(M,"u")}catch{S=new RegExp(M)}return s.match(S)||m.addError({name:"pattern",argument:a.pattern,message:"does not match pattern "+JSON.stringify(a.pattern.toString())}),m}},p.format=function(s,a,h,b){if(s!==void 0){var m=new l(s,a,h,b);return m.disableFormat||d.isFormat(s,a.format,this)||m.addError({name:"format",argument:a.format,message:"does not conform to the "+JSON.stringify(a.format)+" format"}),m}},p.minLength=function(s,a,h,b){if(this.types.string(s)){var m=new l(s,a,h,b),M=s.match(/[\uDC00-\uDFFF]/g);return s.length-(M?M.length:0)>=a.minLength||m.addError({name:"minLength",argument:a.minLength,message:"does not meet minimum length of "+a.minLength}),m}},p.maxLength=function(s,a,h,b){if(this.types.string(s)){var m=new l(s,a,h,b),M=s.match(/[\uDC00-\uDFFF]/g);return s.length-(M?M.length:0)<=a.maxLength||m.addError({name:"maxLength",argument:a.maxLength,message:"does not meet maximum length of "+a.maxLength}),m}},p.minItems=function(s,a,h,b){if(this.types.array(s)){var m=new l(s,a,h,b);return s.length>=a.minItems||m.addError({name:"minItems",argument:a.minItems,message:"does not meet minimum length of "+a.minItems}),m}},p.maxItems=function(s,a,h,b){if(this.types.array(s)){var m=new l(s,a,h,b);return s.length<=a.maxItems||m.addError({name:"maxItems",argument:a.maxItems,message:"does not meet maximum length of "+a.maxItems}),m}},p.uniqueItems=function(s,a,h,b){if(a.uniqueItems===!0&&this.types.array(s)){var m=new l(s,a,h,b);return s.every(u)||m.addError({name:"uniqueItems",message:"contains duplicate item"}),m}},p.dependencies=function(s,a,h,b){if(this.types.object(s)){var m=new l(s,a,h,b);for(var M in a.dependencies)if(s[M]!==void 0){var S=a.dependencies[M],w=b.makeChild(S,M);if(typeof S=="string"&&(S=[S]),Array.isArray(S))S.forEach(function(F){s[F]===void 0&&m.addError({name:"dependencies",argument:w.propertyPath,message:"property "+F+" not found, required by "+w.propertyPath})});else{var N=this.validateSchema(s,S,h,w);m.instance!==N.instance&&(m.instance=N.instance),N&&N.errors.length&&(m.addError({name:"dependencies",argument:w.propertyPath,message:"does not meet dependency required by "+w.propertyPath}),m.importErrors(N))}}return m}},p.enum=function(s,a,h,b){if(s===void 0)return null;if(!Array.isArray(a.enum))throw new g("enum expects an array",a);var m=new l(s,a,h,b);return a.enum.some(d.deepCompareStrict.bind(null,s))||m.addError({name:"enum",argument:a.enum,message:"is not one of enum values: "+a.enum.map(String).join(",")}),m},p.const=function(s,a,h,b){if(s===void 0)return null;var m=new l(s,a,h,b);return d.deepCompareStrict(a.const,s)||m.addError({name:"const",argument:a.const,message:"does not exactly match expected constant: "+a.const}),m},p.not=p.disallow=function(s,a,h,b){var m=this;if(s===void 0)return null;var M=new l(s,a,h,b),S=a.not||a.disallow;return S?(Array.isArray(S)||(S=[S]),S.forEach(function(w){if(m.testType(s,a,h,b,w)){var N=w&&(w.$id||w.id)||w;M.addError({name:"not",argument:N,message:"is of prohibited type "+N})}}),M):null},x.exports=v},3533:(x,c,_)=>{var d=_(4760),l=c.ValidationError=function(m,M,S,w,N,F){if(Array.isArray(w)?(this.path=w,this.property=w.reduce(function(X,$){return X+i($)},"instance")):w!==void 0&&(this.property=w),m&&(this.message=m),S){var k=S.$id||S.id;this.schema=k||S}M!==void 0&&(this.instance=M),this.name=N,this.argument=F,this.stack=this.toString()};l.prototype.toString=function(){return this.property+" "+this.message};var g=c.ValidatorResult=function(m,M,S,w){this.instance=m,this.schema=M,this.options=S,this.path=w.path,this.propertyPath=w.propertyPath,this.errors=[],this.throwError=S&&S.throwError,this.throwFirst=S&&S.throwFirst,this.throwAll=S&&S.throwAll,this.disableFormat=S&&S.disableFormat===!0};function v(m,M){return M+": "+m.toString()+`
`}function p(m){Error.captureStackTrace&&Error.captureStackTrace(this,p),this.instance=m.instance,this.schema=m.schema,this.options=m.options,this.errors=m.errors}g.prototype.addError=function(m){var M;if(typeof m=="string")M=new l(m,this.instance,this.schema,this.path);else{if(!m)throw new Error("Missing error detail");if(!m.message)throw new Error("Missing error message");if(!m.name)throw new Error("Missing validator type");M=new l(m.message,this.instance,this.schema,this.path,m.name,m.argument)}if(this.errors.push(M),this.throwFirst)throw new p(this);if(this.throwError)throw M;return M},g.prototype.importErrors=function(m){typeof m=="string"||m&&m.validatorType?this.addError(m):m&&m.errors&&Array.prototype.push.apply(this.errors,m.errors)},g.prototype.toString=function(m){return this.errors.map(v).join("")},Object.defineProperty(g.prototype,"valid",{get:function(){return!this.errors.length}}),x.exports.ValidatorResultError=p,p.prototype=new Error,p.prototype.constructor=p,p.prototype.name="Validation Error";var o=c.SchemaError=function m(M,S){this.message=M,this.schema=S,Error.call(this,M),Error.captureStackTrace(this,m)};o.prototype=Object.create(Error.prototype,{constructor:{value:o,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var r=c.SchemaContext=function(m,M,S,w,N){this.schema=m,this.options=M,Array.isArray(S)?(this.path=S,this.propertyPath=S.reduce(function(F,k){return F+i(k)},"instance")):this.propertyPath=S,this.base=w,this.schemas=N};r.prototype.resolve=function(m){return d.resolve(this.base,m)},r.prototype.makeChild=function(m,M){var S=M===void 0?this.path:this.path.concat([M]),w=m.$id||m.id,N=d.resolve(this.base,w||""),F=new r(m,this.options,S,N,Object.create(this.schemas));return w&&!F.schemas[N]&&(F.schemas[N]=m),F};var n=c.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+-.]*:[^\s]*$/,"uri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"utc-millisec":function(m){return typeof m=="string"&&parseFloat(m)===parseInt(m,10)&&!isNaN(m)},regex:function(m){var M=!0;try{new RegExp(m)}catch{M=!1}return M},style:/\s*(.+?):\s*([^;]+);?/,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/};n.regexp=n.regex,n.pattern=n.regex,n.ipv4=n["ip-address"],c.isFormat=function(m,M,S){if(typeof m=="string"&&n[M]!==void 0){if(n[M]instanceof RegExp)return n[M].test(m);if(typeof n[M]=="function")return n[M](m)}else if(S&&S.customFormats&&typeof S.customFormats[M]=="function")return S.customFormats[M](m);return!0};var i=c.makeSuffix=function(m){return(m=m.toString()).match(/[.\s\[\]]/)||m.match(/^[\d]/)?m.match(/^\d+$/)?"["+m+"]":"["+JSON.stringify(m)+"]":"."+m};function u(m,M,S,w){typeof S=="object"?M[w]=h(m[w],S):m.indexOf(S)===-1&&M.push(S)}function s(m,M,S){M[S]=m[S]}function a(m,M,S,w){typeof M[w]=="object"&&M[w]&&m[w]?S[w]=h(m[w],M[w]):S[w]=M[w]}function h(m,M){var S=Array.isArray(M),w=S&&[]||{};return S?(m=m||[],w=w.concat(m),M.forEach(u.bind(null,m,w))):(m&&typeof m=="object"&&Object.keys(m).forEach(s.bind(null,m,w)),Object.keys(M).forEach(a.bind(null,m,M,w))),w}function b(m){return"/"+encodeURIComponent(m).replace(/~/g,"%7E")}c.deepCompareStrict=function m(M,S){if(typeof M!=typeof S)return!1;if(Array.isArray(M))return!!Array.isArray(S)&&M.length===S.length&&M.every(function(F,k){return m(M[k],S[k])});if(typeof M=="object"){if(!M||!S)return M===S;var w=Object.keys(M),N=Object.keys(S);return w.length===N.length&&w.every(function(F){return m(M[F],S[F])})}return M===S},x.exports.deepMerge=h,c.objectGetPath=function(m,M){for(var S,w=M.split("/").slice(1);typeof(S=w.shift())=="string";){var N=decodeURIComponent(S.replace(/~0/,"~").replace(/~1/g,"/"));if(!(N in m))return;m=m[N]}return m},c.encodePath=function(m){return m.map(b).join("")},c.getDecimalPlaces=function(m){var M=0;if(isNaN(m))return M;typeof m!="number"&&(m=Number(m));var S=m.toString().split("e");if(S.length===2){if(S[1][0]!=="-")return M;M=Number(S[1].slice(1))}var w=S[0].split(".");return w.length===2&&(M+=w[1].length),M},c.isSchema=function(m){return typeof m=="object"&&m||typeof m=="boolean"}},634:(x,c,_)=>{var d=x.exports.Validator=_(7298);x.exports.ValidatorResult=_(3533).ValidatorResult,x.exports.ValidatorResultError=_(3533).ValidatorResultError,x.exports.ValidationError=_(3533).ValidationError,x.exports.SchemaError=_(3533).SchemaError,x.exports.SchemaScanResult=_(433).SchemaScanResult,x.exports.scan=_(433).scan,x.exports.validate=function(l,g,v){return new d().validate(l,g,v)}},433:(x,c,_)=>{var d=_(4760),l=_(3533);function g(v,p){this.id=v,this.ref=p}x.exports.SchemaScanResult=g,x.exports.scan=function(v,p){function o(s,a){if(a&&typeof a=="object")if(a.$ref){var h=d.resolve(s,a.$ref);u[h]=u[h]?u[h]+1:0}else{var b=a.$id||a.id,m=b?d.resolve(s,b):s;if(m){if(m.indexOf("#")<0&&(m+="#"),i[m]){if(!l.deepCompareStrict(i[m],a))throw new Error("Schema <"+m+"> already exists with different definition");return i[m]}i[m]=a,m[m.length-1]=="#"&&(i[m.substring(0,m.length-1)]=a)}r(m+"/items",Array.isArray(a.items)?a.items:[a.items]),r(m+"/extends",Array.isArray(a.extends)?a.extends:[a.extends]),o(m+"/additionalItems",a.additionalItems),n(m+"/properties",a.properties),o(m+"/additionalProperties",a.additionalProperties),n(m+"/definitions",a.definitions),n(m+"/patternProperties",a.patternProperties),n(m+"/dependencies",a.dependencies),r(m+"/disallow",a.disallow),r(m+"/allOf",a.allOf),r(m+"/anyOf",a.anyOf),r(m+"/oneOf",a.oneOf),o(m+"/not",a.not)}}function r(s,a){if(Array.isArray(a))for(var h=0;h<a.length;h++)o(s+"/"+h,a[h])}function n(s,a){if(a&&typeof a=="object")for(var h in a)o(s+"/"+h,a[h])}var i={},u={};return o(v,p),new g(i,u)}},7298:(x,c,_)=>{var d=_(4760),l=_(9609),g=_(3533),v=_(433).scan,p=g.ValidatorResult,o=g.ValidatorResultError,r=g.SchemaError,n=g.SchemaContext,i=function a(){this.customFormats=Object.create(a.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(s),this.attributes=Object.create(l.validators)};function u(a){var h=typeof a=="string"?a:a.$ref;return typeof h=="string"&&h}i.prototype.customFormats={},i.prototype.schemas=null,i.prototype.types=null,i.prototype.attributes=null,i.prototype.unresolvedRefs=null,i.prototype.addSchema=function(a,h){var b=this;if(!a)return null;var m=v(h||"/",a),M=h||a.$id||a.id;for(var S in m.id)this.schemas[S]=m.id[S];for(var S in m.ref)this.unresolvedRefs.push(S);return this.unresolvedRefs=this.unresolvedRefs.filter(function(w){return b.schemas[w]===void 0}),this.schemas[M]},i.prototype.addSubSchemaArray=function(a,h){if(Array.isArray(h))for(var b=0;b<h.length;b++)this.addSubSchema(a,h[b])},i.prototype.addSubSchemaObject=function(a,h){if(h&&typeof h=="object")for(var b in h)this.addSubSchema(a,h[b])},i.prototype.setSchemas=function(a){this.schemas=a},i.prototype.getSchema=function(a){return this.schemas[a]},i.prototype.validate=function(a,h,b,m){if(typeof h!="boolean"&&typeof h!="object"||h===null)throw new r("Expected `schema` to be an object or boolean");b||(b={});var M,S=h.$id||h.id,w=d.resolve(b.base||"/",S||"");if(!m){(m=new n(h,b,[],w,Object.create(this.schemas))).schemas[w]||(m.schemas[w]=h);var N=v(w,h);for(var F in N.id){var k=N.id[F];m.schemas[F]=k}}if(b.required&&a===void 0)return(M=new p(a,h,b,m)).addError("is required, but is undefined"),M;if(!(M=this.validateSchema(a,h,b,m)))throw new Error("Result undefined");if(b.throwAll&&M.errors.length)throw new o(M);return M},i.prototype.validateSchema=function(a,h,b,m){var M=new p(a,h,b,m);if(typeof h=="boolean")h===!0?h={}:h===!1&&(h={type:[]});else if(!h)throw new Error("schema is undefined");if(h.extends)if(Array.isArray(h.extends)){var S={schema:h,ctx:m};h.extends.forEach(this.schemaTraverser.bind(this,S)),h=S.schema,S.schema=null,S.ctx=null,S=null}else h=g.deepMerge(h,this.superResolve(h.extends,m));var w=u(h);if(w){var N=this.resolve(h,w,m),F=new n(N.subschema,b,m.path,N.switchSchema,m.schemas);return this.validateSchema(a,N.subschema,b,F)}var k=b&&b.skipAttributes||[];for(var X in h)if(!l.ignoreProperties[X]&&k.indexOf(X)<0){var $=null,V=this.attributes[X];if(V)$=V.call(this,a,h,b,m);else if(b.allowUnknownAttributes===!1)throw new r("Unsupported attribute: "+X,h);$&&M.importErrors($)}if(typeof b.rewrite=="function"){var Y=b.rewrite.call(this,a,h,b,m);M.instance=Y}return M},i.prototype.schemaTraverser=function(a,h){a.schema=g.deepMerge(a.schema,this.superResolve(h,a.ctx))},i.prototype.superResolve=function(a,h){var b=u(a);return b?this.resolve(a,b,h).subschema:a},i.prototype.resolve=function(a,h,b){if(h=b.resolve(h),b.schemas[h])return{subschema:b.schemas[h],switchSchema:h};var m=d.parse(h),M=m&&m.hash,S=M&&M.length&&h.substr(0,h.length-M.length);if(!S||!b.schemas[S])throw new r("no such schema <"+h+">",a);var w=g.objectGetPath(b.schemas[S],M.substr(1));if(w===void 0)throw new r("no such schema "+M+" located in <"+S+">",a);return{subschema:w,switchSchema:h}},i.prototype.testType=function(a,h,b,m,M){if(M!==void 0){if(M===null)throw new r('Unexpected null in "type" keyword');if(typeof this.types[M]=="function")return this.types[M].call(this,a);if(M&&typeof M=="object"){var S=this.validateSchema(a,M,b,m);return S===void 0||!(S&&S.errors.length)}return!0}};var s=i.prototype.types={};s.string=function(a){return typeof a=="string"},s.number=function(a){return typeof a=="number"&&isFinite(a)},s.integer=function(a){return typeof a=="number"&&a%1==0},s.boolean=function(a){return typeof a=="boolean"},s.array=function(a){return Array.isArray(a)},s.null=function(a){return a===null},s.date=function(a){return a instanceof Date},s.any=function(a){return!0},s.object=function(a){return a&&typeof a=="object"&&!Array.isArray(a)&&!(a instanceof Date)},x.exports=i},8770:(x,c,_)=>{_.r(c),_.d(c,{ucs2decode:()=>s,ucs2encode:()=>a,decode:()=>m,encode:()=>M,toASCII:()=>w,toUnicode:()=>S,default:()=>N});const d=2147483647,l=36,g=/^xn--/,v=/[^\0-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,o={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},r=Math.floor,n=String.fromCharCode;function i(F){throw new RangeError(o[F])}function u(F,k){const X=F.split("@");let $="";X.length>1&&($=X[0]+"@",F=X[1]);const V=function(Y,Z){const J=[];let ee=Y.length;for(;ee--;)J[ee]=Z(Y[ee]);return J}((F=F.replace(p,".")).split("."),k).join(".");return $+V}function s(F){const k=[];let X=0;const $=F.length;for(;X<$;){const V=F.charCodeAt(X++);if(V>=55296&&V<=56319&&X<$){const Y=F.charCodeAt(X++);(64512&Y)==56320?k.push(((1023&V)<<10)+(1023&Y)+65536):(k.push(V),X--)}else k.push(V)}return k}const a=F=>String.fromCodePoint(...F),h=function(F,k){return F+22+75*(F<26)-((k!=0)<<5)},b=function(F,k,X){let $=0;for(F=X?r(F/700):F>>1,F+=r(F/k);F>455;$+=l)F=r(F/35);return r($+36*F/(F+38))},m=function(F){const k=[],X=F.length;let $=0,V=128,Y=72,Z=F.lastIndexOf("-");Z<0&&(Z=0);for(let ee=0;ee<Z;++ee)F.charCodeAt(ee)>=128&&i("not-basic"),k.push(F.charCodeAt(ee));for(let ee=Z>0?Z+1:0;ee<X;){let K=$;for(let ue=1,ie=l;;ie+=l){ee>=X&&i("invalid-input");const de=(J=F.charCodeAt(ee++))-48<10?J-22:J-65<26?J-65:J-97<26?J-97:l;(de>=l||de>r((d-$)/ue))&&i("overflow"),$+=de*ue;const Te=ie<=Y?1:ie>=Y+26?26:ie-Y;if(de<Te)break;const pe=l-Te;ue>r(d/pe)&&i("overflow"),ue*=pe}const re=k.length+1;Y=b($-K,re,K==0),r($/re)>d-V&&i("overflow"),V+=r($/re),$%=re,k.splice($++,0,V)}var J;return String.fromCodePoint(...k)},M=function(F){const k=[];let X=(F=s(F)).length,$=128,V=0,Y=72;for(const ee of F)ee<128&&k.push(n(ee));let Z=k.length,J=Z;for(Z&&k.push("-");J<X;){let ee=d;for(const re of F)re>=$&&re<ee&&(ee=re);const K=J+1;ee-$>r((d-V)/K)&&i("overflow"),V+=(ee-$)*K,$=ee;for(const re of F)if(re<$&&++V>d&&i("overflow"),re==$){let ue=V;for(let ie=l;;ie+=l){const de=ie<=Y?1:ie>=Y+26?26:ie-Y;if(ue<de)break;const Te=ue-de,pe=l-de;k.push(n(h(de+Te%pe,0))),ue=r(Te/pe)}k.push(n(h(ue,0))),Y=b(V,K,J==Z),V=0,++J}++V,++$}return k.join("")},S=function(F){return u(F,function(k){return g.test(k)?m(k.slice(4).toLowerCase()):k})},w=function(F){return u(F,function(k){return v.test(k)?"xn--"+M(k):k})},N={version:"2.1.0",ucs2:{decode:s,encode:a},decode:m,encode:M,toASCII:w,toUnicode:S}},9350:x=>{function c(_,d){return Object.prototype.hasOwnProperty.call(_,d)}x.exports=function(_,d,l,g){d=d||"&",l=l||"=";var v={};if(typeof _!="string"||_.length===0)return v;var p=/\+/g;_=_.split(d);var o=1e3;g&&typeof g.maxKeys=="number"&&(o=g.maxKeys);var r=_.length;o>0&&r>o&&(r=o);for(var n=0;n<r;++n){var i,u,s,a,h=_[n].replace(p,"%20"),b=h.indexOf(l);b>=0?(i=h.substr(0,b),u=h.substr(b+1)):(i=h,u=""),s=decodeURIComponent(i),a=decodeURIComponent(u),c(v,s)?Array.isArray(v[s])?v[s].push(a):v[s]=[v[s],a]:v[s]=a}return v}},4104:x=>{var c=function(_){switch(typeof _){case"string":return _;case"boolean":return _?"true":"false";case"number":return isFinite(_)?_:"";default:return""}};x.exports=function(_,d,l,g){return d=d||"&",l=l||"=",_===null&&(_=void 0),typeof _=="object"?Object.keys(_).map(function(v){var p=encodeURIComponent(c(v))+l;return Array.isArray(_[v])?_[v].map(function(o){return p+encodeURIComponent(c(o))}).join(d):p+encodeURIComponent(c(_[v]))}).join(d):g?encodeURIComponent(c(g))+l+encodeURIComponent(c(_)):""}},8966:(x,c,_)=>{c.decode=c.parse=_(9350),c.encode=c.stringify=_(4104)},3666:function(x,c,_){var d=this&&this.__decorate||function(a,h,b,m){var M,S=arguments.length,w=S<3?h:m===null?m=Object.getOwnPropertyDescriptor(h,b):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(a,h,b,m);else for(var N=a.length-1;N>=0;N--)(M=a[N])&&(w=(S<3?M(w):S>3?M(h,b,w):M(h,b))||w);return S>3&&w&&Object.defineProperty(h,b,w),w};Object.defineProperty(c,"__esModule",{value:!0}),c.AccumulatePass=void 0;const l=_(9696),g=_(4597),v=_(9564),p=_(1030),o=_(7570),r=_(4895),n=_(5263),i=_(6942),u=_(1284);class s extends p.Initializable{constructor(h){super(),this._altered=Object.assign(new g.ChangeLookup,{any:!1,texture:!1,precision:!1,passThrough:!1}),this._precision=u.Wizard.Precision.half,this._write=0,this._ndcTriangleShared=!1,this._context=h}initialize(h){const b=this._context.gl;this._accumulationFBOs=[new v.Framebuffer(this._context,"AccumPingFBO"),new v.Framebuffer(this._context,"AccumPongFBO")],this._accumulationTextures=[new i.Texture2D(this._context,"AccumPingTexture"),new i.Texture2D(this._context,"AccumPongTexture")],h===void 0?this._ndcTriangle=new o.NdcFillingTriangle(this._context,"NdcFillingTriangle-Accumulate"):(this._ndcTriangle=h,this._ndcTriangleShared=!0);const m=new n.Shader(this._context,b.VERTEX_SHADER,"ndcvertices.vert (accumulate)");m.initialize(_(3643));const M=new n.Shader(this._context,b.FRAGMENT_SHADER,"accumulate.frag");return M.initialize(_(3170)),this._program=new r.Program(this._context,"AccumulateProgram"),this._program.initialize([m,M],!1),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uWeight=this._program.uniform("u_weight"),this._program.bind(),b.uniform1f(this._uWeight,0),b.uniform1i(this._program.uniform("u_accumulationTexture"),0),b.uniform1i(this._program.uniform("u_currentFrameTexture"),1),this._program.unbind(),!0}uninitialize(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize(),this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize(),this._write=0}update(){if(!this._texture||!this._texture.valid)return void l.log(l.LogLevel.Warning,`valid texture for accumulation update expected, given ${this._texture}`);if(this._passThrough)return;const h=this._altered.texture||this._accumulationTextures[0].width!==this._texture.width||this._accumulationTextures[0].height!==this._texture.height;if(!this._altered.any&&!h)return void l.assert(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected");const b=this._context.gl,m=this._context.gl2facade,M=this._texture.size;if(this._accumulationTextures[0].initialized){if((this._altered.texture||h)&&(this._accumulationTextures[0].resize(this._texture.width,this._texture.height),this._accumulationTextures[1].resize(this._texture.width,this._texture.height)),this._altered.precision){const S=u.Wizard.queryInternalTextureFormat(this._context,b.RGBA,this._precision);this._accumulationTextures[0].reformat(S[0],b.RGBA,S[1]),this._accumulationTextures[1].reformat(S[0],b.RGBA,S[1])}}else{const S=u.Wizard.queryInternalTextureFormat(this._context,b.RGBA,this._precision);this._accumulationTextures[0].initialize(M[0],M[1],S[0],b.RGBA,S[1]),this._accumulationTextures[1].initialize(M[0],M[1],S[0],b.RGBA,S[1])}this._accumulationFBOs[0].initialized||(this._accumulationFBOs[0].initialize([[m.COLOR_ATTACHMENT0,this._accumulationTextures[0]]]),this._accumulationFBOs[1].initialize([[m.COLOR_ATTACHMENT0,this._accumulationTextures[1]]])),l.assert(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected"),this._altered.reset()}frame(h,b){if(l.assert(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid framebuffer objects for accumulation expected (initialize or update was probably not called)"),this._passThrough||this._texture===void 0)return;l.logIf(!this._texture||!this._texture.valid,l.LogLevel.Warning,`valid texture for accumulation frame expected, given ${this._texture}`);const m=this._context.gl;b!==void 0&&m.viewport(0,0,b[0],b[1]);const M=h%2,S=this._write=1-M,w=this._accumulationTextures[M],N=this._texture;w.bind(m.TEXTURE0),N.bind(m.TEXTURE1),this._program.bind(),m.uniform1f(this._uWeight,1/(h+1)),this._accumulationFBOs[S].bind(m.DRAW_FRAMEBUFFER),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._accumulationFBOs[S].unbind(m.DRAW_FRAMEBUFFER),w.unbind(m.TEXTURE0),N.unbind(m.TEXTURE1)}set texture(h){this.assertInitialized(),this._texture!==h&&(this._texture=h,this._altered.alter("texture"))}set precision(h){this.assertInitialized(),this._precision!==h&&(this._precision=h,this._altered.alter("precision"))}set passThrough(h){this.assertInitialized(),this._passThrough!==h&&(this._passThrough&&this._accumulationTextures[0].initialized&&(this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize()),this._passThrough&&this._accumulationFBOs[0].initialized&&(this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize()),this._passThrough=h,this._altered.alter("passThrough"))}get framebuffer(){return this._passThrough?void 0:this._accumulationFBOs[this._write]}}d([p.Initializable.initialize()],s.prototype,"initialize",null),d([p.Initializable.uninitialize()],s.prototype,"uninitialize",null),d([p.Initializable.assert_initialized()],s.prototype,"update",null),d([p.Initializable.assert_initialized()],s.prototype,"frame",null),c.AccumulatePass=s},7945:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.AllocationRegister=void 0;const d=_(7318),l=_(9696);c.AllocationRegister=class{constructor(){this._bytesByIdentifier=new Map,this._bytes=0,this._bytesSubject=new d.ReplaySubject(1)}bytesNext(){this._bytesSubject.next([this._bytes,this.bytesToString()])}assertIdentifier(g){l.assert(this._bytesByIdentifier.has(g),"allocation identifier unknown")}createUniqueIdentifier(g){let v=g,p=2;for(;this._bytesByIdentifier.has(v);)v=`${g}-${p}`,++p;return this._bytesByIdentifier.set(v,0),v}deleteUniqueIdentifier(g){l.assert(this._bytesByIdentifier.has(g),"identifier expected to be known for allocation registration"),this._bytesByIdentifier.delete(g)}allocate(g,v){if(this.assertIdentifier(g),l.assert(v>=0,`positive number of bytes expected for allocation, given ${v}`),v===0)return;const p=this._bytesByIdentifier.get(g)+v;this._bytesByIdentifier.set(g,p),this._bytes=this._bytes+v,this.bytesNext()}deallocate(g,v){this.assertIdentifier(g);const p=this._bytesByIdentifier.get(g);l.assert(v>=0,`positive number of bytes expected for deallocation, given ${v}`),l.assert(v<=p,`deallocation cannot exceed previous allocations of ${p}, given ${v}`),v!==0&&(this._bytesByIdentifier.set(g,p-v),this._bytes=this._bytes-v,this.bytesNext())}reallocate(g,v){this.assertIdentifier(g),l.assert(v>=0,`positive number of bytes expected for reallocation, given ${v}`);const p=this._bytesByIdentifier.get(g);p!==v&&(this._bytes=this._bytes-p,this._bytesByIdentifier.set(g,v),this._bytes=this._bytes+v,this.bytesNext())}allocated(g){return g===void 0?this._bytes:(this.assertIdentifier(g),this._bytesByIdentifier.get(g))}toString(){const g=new Array;return this._bytesByIdentifier.forEach((v,p)=>{g.push(`${p}: ${l.prettyPrintBytes(v)}`)}),g.join(", ")}bytesToString(g){return l.prettyPrintBytes(this.allocated(g))}get bytes(){return this._bytes}get bytes$(){return this._bytesSubject.asObservable()}}},3411:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.AntiAliasingKernel=void 0;const d=_(5785);class l extends d.RandomSquareKernel{constructor(v){super(v)}generate(){switch(this._width){case 8:this.fromJSON(_(1037));break;case 64:this.fromJSON(_(9655));break;case 128:this.fromJSON(_(6412));break;default:super.generate()}}}c.AntiAliasingKernel=l},9696:(x,c,_)=>{const d=_(2111);var l;(function(g){let v,p=2;g.logVerbosity=function(m){return m!==void 0&&(p=Math.max(-1,m)),p},function(m){m[m.Debug=3]="Debug",m[m.Info=2]="Info",m[m.Warning=1]="Warning",m[m.Error=0]="Error"}(v=g.LogLevel||(g.LogLevel={}));const o=(m,M)=>{if(!m)throw new EvalError(M)},r=(m,M)=>{};function n(m,...M){m>p||console.log(`[${m}]`,...M)}function i(m){const M=`${m}-start`;g.assert(performance.getEntriesByName(m).length===0,`expected mark identifier to not already exists, given ${m}`),g.assert(performance.getEntriesByName(M).length===0,`expected mark identifier to not already exists, given ${M}`),performance.mark(M)}function u(m,M,S=0){const w=`${m}-start`,N=`${m}-end`;g.assert(performance.getEntriesByName(m).length===0,`expected mark identifier to not already exists, given ${m}`),g.assert(performance.getEntriesByName(N).length===0,`expected mark identifier to not already exists, given ${N}`),performance.mark(N),performance.measure(m,w,N);const F=performance.getEntriesByName(m)[0];performance.clearMarks(w),performance.clearMarks(N),performance.clearMeasures(m);const k=M===void 0||M.length===0?0:2,X=Math.max(k,S-m.length-(M?M.length:0)-1),$=b(F.duration);n(v.Debug,`${m}${" ".repeat(X)}${M||""} | ${$}`)}g.assert=o,g.assertions=function(m){return m!==void 0&&(g.assert=m?o:r),g.assert!==r},g.log=n,g.logIf=function(m,M,...S){m&&n(M,...S)},g.logPerformanceStart=i,g.logPerformanceStartIf=function(m,M){m&&i(M)},g.logPerformanceStop=u,g.logPerformanceStopIf=function(m,M,S,w=0){m&&u(M,S,w)},g.rand=function(m=0,M=1){return Math.random()*(M-m)+m},g.isPowerOfTwo=function(m){return Number.isInteger(m)&&Number.isInteger(Math.log2(m))},g.upperPowerOfTwo=function(m){return--m,m|=m>>1,m|=m>>2,m|=m>>4,m|=m>>8,m|=m>>16,++m};const s=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];g.prettyPrintBytes=function(m){const M=m>0?Math.floor(Math.log(m)/Math.log(1024)):0,S=m/Math.pow(1024,M);return`${M>0?S.toFixed(3):S}${s[M]}B`};const a=["ms","ns","\u03BCs","ms","s"],h=[0,1e6,1e3,1,.001];function b(m){let M=m>0?Math.max(1,Math.floor(Math.log(10*m)/Math.log(1e3))+3):0;return M=d.clamp(M,0,4),`${(m*h[M]).toFixed(3)}${a[M]}`}g.prettyPrintMilliseconds=b,g.bitInBitfield=function(m,M){return M!==void 0&&(m&M)===M},g.RAD2DEG=57.29577951308232,g.DEG2RAD=.017453292519943295,g.GETsearch=function(){let m=window.location.search;return m||(m=window.top.location.search),m},g.GETparameter=function(m){const M=new RegExp(`${m}=([^&]+)`);let S=window.location.search.match(M);if(S||(S=window.top.location.search.match(M)),S)return S[1]},g.PATH_SEPARATOR="/",g.dirname=function(m){return m.includes(g.PATH_SEPARATOR)===!1?"":m.substr(0,m.lastIndexOf(g.PATH_SEPARATOR)).trimLeft()},g.basename=function(m){return m.includes(g.PATH_SEPARATOR)===!1?m:m.substr(m.lastIndexOf(g.PATH_SEPARATOR)+1).trimRight()}})(l||(l={})),x.exports=l},4073:function(x,c,_){var d=this&&this.__decorate||function(u,s,a,h){var b,m=arguments.length,M=m<3?s:h===null?h=Object.getOwnPropertyDescriptor(s,a):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(u,s,a,h);else for(var S=u.length-1;S>=0;S--)(b=u[S])&&(M=(m<3?b(M):m>3?b(s,a,M):b(s,a))||M);return m>3&&M&&Object.defineProperty(s,a,M),M};Object.defineProperty(c,"__esModule",{value:!0}),c.BlitPass=void 0;const l=_(3659),g=_(9696),v=_(2111),p=_(1030),o=_(7570),r=_(4895),n=_(5263);class i extends p.Initializable{constructor(s){super(),this._enforceProgramBlit=!1,this._ndcTriangleShared=!1,this._context=s}functionBlit(){const s=this._context.gl;if(this._target.bind(s.DRAW_FRAMEBUFFER),this._framebuffer.bind(s.READ_FRAMEBUFFER),s.readBuffer(this._readBuffer),this._drawBuffer>=s.COLOR_ATTACHMENT1&&this._drawBuffer<=s.COLOR_ATTACHMENT15){const b=this._drawBuffer-s.COLOR_ATTACHMENT0,m=new Array(b+1).fill(s.NONE);m[b]=this._drawBuffer,s.drawBuffers(m)}else s.drawBuffers([this._drawBuffer]);s.enable(s.SCISSOR_TEST),s.scissor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT),s.disable(s.SCISSOR_TEST);const a=this._srcBounds?this._srcBounds:[0,0,this._framebuffer.width,this._framebuffer.height],h=this._dstBounds?this._dstBounds:[0,0,this._target.width,this._target.height];s.blitFramebuffer(a[0],a[1],a[2],a[3],h[0],h[1],h[2],h[3],s.COLOR_BUFFER_BIT,this._filter),this._framebuffer.unbind(s.READ_FRAMEBUFFER),this._target.unbind(s.DRAW_FRAMEBUFFER)}programBlit(){this._program===void 0&&this.createProgram(),g.assert(this._ndcTriangle&&this._ndcTriangle.initialized,"expected an initialized ndc triangle");const s=this._context.gl,a=this._srcBounds?this._srcBounds:l.vec4.fromValues(0,0,this._framebuffer.width,this._framebuffer.height),h=this._dstBounds?this._dstBounds:l.vec4.fromValues(0,0,this._target.width,this._target.height),b=l.vec4.div(v.v4(),a,[this._framebuffer.width,this._framebuffer.height,this._framebuffer.width,this._framebuffer.height]),m=l.vec4.div(v.v4(),h,[this._target.width,this._target.height,this._target.width,this._target.height]);s.viewport(h[0],h[1],h[2]-h[0],h[3]-h[1]),s.disable(s.DEPTH_TEST),s.depthMask(!1),this._program.bind(),s.uniform4fv(this._uSrcBounds,b),s.uniform4fv(this._uDstBounds,m),s.uniform1i(this._uNearest,this.filter===s.nearest);const M=this._framebuffer.texture(this._readBuffer);M.bind(s.TEXTURE0);const S=this._context.isWebGL2?s.DRAW_FRAMEBUFFER:s.FRAMEBUFFER;this._target.bind(S),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._target.unbind(S),M.unbind(),s.enable(s.DEPTH_TEST),s.depthMask(!0)}createProgram(){g.assert(this._program===void 0,"expected blit program to be undefined before its creation");const s=this._context.gl,a=new n.Shader(this._context,s.VERTEX_SHADER,"blit.vert (blit)");a.initialize(_(985));const h=new n.Shader(this._context,s.FRAGMENT_SHADER,"blit.frag (blit)");return h.initialize(_(3717)),this._program=new r.Program(this._context,"BlitProgram"),this._program.initialize([a,h],!1),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uSrcBounds=this._program.uniform("u_srcBounds"),this._uDstBounds=this._program.uniform("u_dstBounds"),this._uNearest=this._program.uniform("u_nearest"),this._program.bind(),s.uniform1i(this._program.uniform("u_source"),0),this._program.unbind(),this._program.valid}initialize(s){const a=this._context.gl;return s===void 0?this._ndcTriangle=new o.NdcFillingTriangle(this._context,"NdcFillingTriangle-Blit"):(this._ndcTriangle=s,this._ndcTriangleShared=!0),this._filter=a.NEAREST,!0}uninitialize(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize()}frame(){g.logIf(!this._target||!this._target.valid,g.LogLevel.Warning,`valid target expected, given ${this._target}`),g.logIf(!this._framebuffer||!this._framebuffer.valid,g.LogLevel.Warning,`valid framebuffer for blitting from expected, given ${this._framebuffer}`);const s=this._context.gl;switch(this._readBuffer){case s.DEPTH_ATTACHMENT:case s.STENCIL_ATTACHMENT:case s.DEPTH_STENCIL_ATTACHMENT:return this.programBlit()}if(this._context.supportsBlitFramebuffer&&this._enforceProgramBlit===!1)return this.functionBlit();this.programBlit()}set framebuffer(s){this.assertInitialized(),this._framebuffer=s}set readBuffer(s){this.assertInitialized(),this._readBuffer=s}set drawBuffer(s){this.assertInitialized(),this._drawBuffer=s}set target(s){this.assertInitialized(),this._target=s}set filter(s){this._filter=s}set srcBounds(s){this._srcBounds=s?l.vec4.clone(s):void 0}set dstBounds(s){this._dstBounds=s?l.vec4.clone(s):void 0}set enforceProgramBlit(s){this._enforceProgramBlit=s}}d([p.Initializable.initialize()],i.prototype,"initialize",null),d([p.Initializable.uninitialize()],i.prototype,"uninitialize",null),d([p.Initializable.assert_initialized()],i.prototype,"frame",null),c.BlitPass=i},6404:function(x,c,_){var d=this&&this.__decorate||function(o,r,n,i){var u,s=arguments.length,a=s<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(o,r,n,i);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(a=(s<3?u(a):s>3?u(r,n,a):u(r,n))||a);return s>3&&a&&Object.defineProperty(r,n,a),a};Object.defineProperty(c,"__esModule",{value:!0}),c.Buffer=void 0;const l=_(9696),g=_(1030),v=_(2281);class p extends v.AbstractObject{constructor(){super(...arguments),this._target=p.DEFAULT_BUFFER}create(r){const n=this._context.gl;return this._object=n.createBuffer(),this._valid=this._object instanceof WebGLBuffer,this._valid&&(l.assert(r===n.ARRAY_BUFFER||r===n.ELEMENT_ARRAY_BUFFER,"either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER expected as buffer target"),this._target=r),this._object}delete(){l.assert(this._object instanceof WebGLBuffer,"expected WebGLBuffer object"),this._context.gl.deleteBuffer(this._object),this._object=void 0,this._valid=!1,this._target=p.DEFAULT_BUFFER}bind(){l.assert(this._target===this._context.gl.ARRAY_BUFFER||this._target===this._context.gl.ELEMENT_ARRAY_BUFFER,"expected either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER as buffer target"),this._context.gl.bindBuffer(this._target,this._object)}unbind(){this.context.gl.bindBuffer(this._target,p.DEFAULT_BUFFER)}data(r,n,i=!0,u=!0){const s=this.context.gl;i&&this.bind(),s.bufferData(this._target,r,n),u&&this.unbind(),this._valid=s.isBuffer(this._object)&&s.getError()===s.NO_ERROR;const a=typeof r=="number"?r:r.byteLength,h=this._valid?a:0;this.context.allocationRegister.reallocate(this._identifier,h)}subData(r,n,i=0,u=0,s=!0,a=!0){const h=this.context.gl;s&&this.bind(),this.context.gl2facade.bufferSubData(this._target,r,n,i,u),a&&this.unbind(),this._valid=h.getError()===h.NO_ERROR}attribEnable(r,n,i,u=!1,s=0,a=0,h=!0,b=!0){const m=this.context.gl;h&&this.bind(),m.vertexAttribPointer(r,n,i,u,s,a),m.enableVertexAttribArray(r),b&&this.unbind()}attribDisable(r,n=!0,i=!0){const u=this.context.gl;n&&this.bind(),u.disableVertexAttribArray(r),i&&this.unbind()}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get target(){return this.assertInitialized(),this._target}}p.DEFAULT_BUFFER=void 0,d([g.Initializable.assert_initialized()],p.prototype,"bind",null),d([g.Initializable.assert_initialized()],p.prototype,"unbind",null),d([g.Initializable.assert_initialized()],p.prototype,"data",null),d([g.Initializable.assert_initialized()],p.prototype,"attribEnable",null),d([g.Initializable.assert_initialized()],p.prototype,"attribDisable",null),c.Buffer=p},4082:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Camera=void 0;const d=_(3659),l=_(2111),g=_(9696),v=_(4934);class p{constructor(r,n,i){this._fovy=p.DEFAULT_FOVY,this._near=p.DEFAULT_NEAR,this._far=p.DEFAULT_FAR,this._viewport=[1,1],this._aspect=1,this._altered=!1,this._eye=r?d.vec3.clone(r):d.vec3.clone(p.DEFAULT_EYE),this._center=n?d.vec3.clone(n):d.vec3.clone(p.DEFAULT_CENTER),this._up=i?d.vec3.clone(i):d.vec3.clone(p.DEFAULT_UP)}static calculateFovY(r,n){return 2*Math.atan(.5*r/n)}invalidate(r,n,i=!1){r&&(this._view=void 0,this._viewInverse=void 0),n&&(this._projection=void 0,this._projectionInverse=void 0),(r||n||i)&&(this._viewProjection=void 0,this._viewProjectionInverse=void 0),this._altered=!0}get eye(){return this._eye}set eye(r){d.vec3.equals(this._eye,r)||(this._eye=d.vec3.clone(r),this.invalidate(!0,!1))}get center(){return this._center}set center(r){d.vec3.equals(this._center,r)||(this._center=d.vec3.clone(r),this.invalidate(!0,!1))}get up(){return this._up}set up(r){d.vec3.equals(this._up,r)||(this._up=d.vec3.clone(r),this.invalidate(!0,!1))}get fovy(){return this._fovy}set fovy(r){this._fovy!==r&&(this._fovy=r,this.invalidate(!1,!0))}set fovx(r){const n=r*g.DEG2RAD,i=2*Math.atan(Math.tan(n/2)*(1/this.aspect))*g.RAD2DEG;this._fovy!==i&&(this._fovy=i,this.invalidate(!1,!0))}fovFromLens(r,n){const i=2*Math.atan(r/(2*n));this.fovx=i*g.RAD2DEG}get near(){return this._near}set near(r){this._near!==r&&(r>=this._far&&g.log(g.LogLevel.Warning,`near expected to be smaller than far (${this._far}), given ${r}`),this._near=r,this.invalidate(!1,!0))}get far(){return this._far}set far(r){this._far!==r&&(this._near>=r&&g.log(g.LogLevel.Warning,`far expected to be greater than near (${this._near}), given ${r}`),this._far=r,this.invalidate(!1,!0))}set viewport(r){this._viewport[0]===r[0]&&this._viewport[1]===r[1]||(this._viewport=v.duplicate2(r),this.invalidate(!1,!0))}get viewport(){return this._viewport}get width(){return this._viewport[0]}get height(){return this._viewport[1]}set aspect(r){this._aspect!==r&&(this._aspect=r)}get aspect(){return this._aspect}get view(){return this._view||(this._view=d.mat4.lookAt(l.m4(),this._eye,this._center,this._up)),this._view}get viewInverse(){return this._viewInverse!==void 0||(this._viewInverse=d.mat4.invert(l.m4(),this.view)),this._viewInverse}get projection(){return this._projection||(this._projection=d.mat4.perspective(l.m4(),this.fovy*g.DEG2RAD,this.aspect,this.near,this.far)),this._projection}get projectionInverse(){return this._projectionInverse!==void 0||(this._projectionInverse=d.mat4.invert(l.m4(),this.projection)),this._projectionInverse}get viewProjection(){return this._viewProjection||(this._viewProjection=d.mat4.multiply(l.m4(),this.projection,this.view),this._viewProjection=d.mat4.multiply(l.m4(),this.postViewProjection,this._viewProjection)),this._viewProjection}get viewProjectionInverse(){return this._viewProjectionInverse!==void 0||(this._viewProjectionInverse=d.mat4.invert(l.m4(),this.viewProjection)),this._viewProjectionInverse}get postViewProjection(){return this._postViewProjection?this._postViewProjection:d.mat4.identity(l.m4())}set postViewProjection(r){this._postViewProjection=r,this.invalidate(!1,!1,!0)}get altered(){return this._altered}set altered(r){this._altered=r}}c.Camera=p,p.DEFAULT_EYE=d.vec3.fromValues(0,0,1),p.DEFAULT_CENTER=d.vec3.fromValues(0,0,0),p.DEFAULT_UP=d.vec3.fromValues(0,1,0),p.DEFAULT_FOVY=45,p.DEFAULT_NEAR=2,p.DEFAULT_FAR=8},6491:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CameraModifier=void 0;const d=_(4082);c.CameraModifier=class{constructor(){this._camera=void 0,this._reference=new d.Camera}set camera(l){this._camera!==l&&(this._camera=l,l!==void 0&&(Object.assign(this._reference,l),this.update()))}}},7063:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Canvas=void 0;const d=_(7318),l=_(3659),g=_(2111),v=_(9696),p=_(4934),o=_(7677),r=_(4518),n=_(3863),i=_(5838),u=_(4841),s=_(8319),a=_(6346),h=_(4052),b=_(1284);class m extends a.Resizable{constructor(S,w){super(),this._framePrecisionSubject=new d.ReplaySubject(1),this._size=[0,0],this._sizeSubject=new d.ReplaySubject(1),this._frameScaleSubject=new d.ReplaySubject(1),this._frameSizeSubject=new d.ReplaySubject(1),this._element=S instanceof HTMLCanvasElement?S:document.getElementById(S),this._element.addEventListener("webglcontextcreationerror",X=>{console.log(X.statusMessage||"Unknown error")},!1),this.observe(this._element),this._mouseEventProvider=new u.MouseEventProvider(this._element,200),this._touchEventProvider=new h.TouchEventProvider(this._element,200),this._pointerEventProvider=new s.PointerEventProvider(this._element,200),this._element.style.touchAction="none";const N=this._element.dataset;let F;this._context=r.Context.request(this._element,w),this.configureController(N),this.configureSizeAndScale(N),this.configureContextLostAndRestore(),this.configureContextLostAndRestoreEmulation(),N.clearColor&&(F=g.parseVec4(N.clearColor),v.logIf(F===void 0,v.LogLevel.Warning,`data-clear-color could not be parsed, given '${N.clearColor}'`)),this._clearColor=F?new o.Color(p.tuple4(F)):m.DEFAULT_CLEAR_COLOR;let k=N.accumulationFormat?N.accumulationFormat:m.DEFAULT_FRAME_PRECISION;k in b.Wizard.Precision||(k=m.DEFAULT_FRAME_PRECISION,v.log(v.LogLevel.Warning,`unknown frame precision '${N.accumulationFormat}' changed to '${k}'`)),this._framePrecision=k,this.framePrecisionNext()}configureController(S){let w,N;this._controller=new n.Controller,this._controller.block(),S.multiFrameNumber&&(w=parseInt(S.multiFrameNumber,10),v.logIf(isNaN(w),v.LogLevel.Warning,`data-multi-frame-number could not be parsed, given '${S.multiFrameNumber}'`)),S.debugFrameNumber&&(N=parseInt(S.debugFrameNumber,10),v.logIf(isNaN(N),v.LogLevel.Warning,`data-debug-frame-number could not be parsed, given '${S.debugFrameNumber}'`)),this._controller.multiFrameNumber=w||m.DEFAULT_MULTI_FRAME_NUMBER,this._controller.debugFrameNumber=N||0;const F=!!w&&w!==this._controller.multiFrameNumber;v.logIf(F,v.LogLevel.Warning,`data-multi-frame-number changed to ${this._controller.multiFrameNumber}, given '${S.multiFrameNumber}'`);const k=!!N&&N!==this._controller.debugFrameNumber;v.logIf(k,v.LogLevel.Warning,`data-debug-frame-number changed to ${this._controller.debugFrameNumber}, given '${S.debugFrameNumber}'`)}configureSizeAndScale(S){let w,N;S.frameScale&&(w=g.parseVec2(S.frameScale),v.logIf(S.frameScale!==void 0&&w===void 0,v.LogLevel.Warning,`data-frame-scale could not be parsed, given '${S.frameScale}'`)),this._frameScale=w?p.tuple2(w):[1,1],S.frameSize&&(N=g.parseVec2(S.frameSize),v.logIf(S.frameSize!==void 0&&N===void 0,v.LogLevel.Warning,`data-frame-size could not be parsed, given '${S.frameSize}'`)),this._favorSizeOverScale=N!==void 0,this._frameSize=N?p.tuple2(N):[this._size[0],this._size[1]],this.onResize()}configureContextLostAndRestore(){this._element.addEventListener("webglcontextlost",S=>{S.preventDefault(),this.onContextLost()},!1),this._element.addEventListener("webglcontextrestored",()=>{this.onContextRestore()},!1)}configureContextLostAndRestoreEmulation(){this._lostContextExtension=this._context.gl.getExtension("WEBGL_lose_context")}onContextLost(){v.log(v.LogLevel.Warning,"WebGL Context lost. Discarding renderer..."),this._controller.cancel(),this._controller.block(),this._renderer&&this._renderer.discard()}onContextRestore(){v.log(v.LogLevel.Warning,"WebGL Context restored. Reinitializing renderer...");const S=this._renderer;this.unbind(),this.bind(S),this._controller.unblock();const w=this._element.style.visibility;this._element.style.visibility="hidden",this._element.offsetHeight,this._element.style.visibility=w}retrieveSize(){const S=a.Resizable.elementSize(this._element);S!==void 0?(this._size=[S[0],S[1]],this.sizeNext()):this._size=[0,0]}onResize(){if(this.retrieveSize(),this._size[0]===0||this._size[1]===0)return v.log(v.LogLevel.Debug,"canvas width or height is invalid, resize discarded and controller blocked"),void this._controller.block();this._element.width=this._size[0],this._element.height=this._size[1],this._renderer&&this._controller.block(),this._favorSizeOverScale?this.frameSize=this._frameSize:this.frameScale=this._frameScale,this._renderer&&(this._controller.unblock(),this._renderer.swap())}framePrecisionNext(){this._framePrecisionSubject.next(this._framePrecision)}sizeNext(){this._sizeSubject.next(this._size)}frameScaleNext(){this._frameScaleSubject.next(this._frameScale)}frameSizeNext(){this._frameSizeSubject.next(this._frameSize)}bind(S){this._renderer!==S&&(this.unbind(),S!==void 0&&(v.assert(this._controller.blocked,"expected controller to be blocked"),this._renderer=S,this._renderer.initialize(this.context,w=>this._controller.update(w),{pointerEventProvider:this._pointerEventProvider,mouseEventProvider:this._mouseEventProvider,eyeGazeEventProvider:this._eyeGazeEventProvider}),this._renderer.frameSize=this._frameSize,this._renderer.clearColor=this._clearColor.rgba,this._renderer.framePrecision=this._framePrecision,this._renderer.debugTexture=-1,this._controller.controllable=this._renderer,this._controller.unblock()))}unbind(){this._renderer!==void 0&&(this._controller.block(),this._controller.controllable=void 0,this._renderer=void 0)}dispose(){super.dispose(),this._renderer&&(this._renderer.uninitialize(),this.unbind())}resize(){this.onResize()}get controller(){return this._controller}get renderer(){return this._renderer}set renderer(S){this.bind(S)}get frameScale(){return this._frameScale}set frameScale(S){if(!isFinite(S[0])||!isFinite(S[1]))return void v.log(v.LogLevel.Warning,`expected finite frame size, non-finite values ignored, given [${S}]`);v.logIf(S[0]<0||S[0]>2,v.LogLevel.Info,`frame width scale clamped to [0.0,2.0], given ${S[0]}`),v.logIf(S[1]<0||S[1]>2,v.LogLevel.Info,`frame height scale clamped to [0.0,2.0], given ${S[0]}`);const w=l.vec2.create();g.clamp2(w,S,[0,0],[2,2]);const N=l.vec2.create();l.vec2.mul(N,this._size,w),l.vec2.max(N,[1,1],N),l.vec2.round(N,N),l.vec2.div(w,N,this._size),v.logIf(!l.vec2.exactEquals(w,S),2,`frame scale was adjusted to ${w.toString()}, given ${S.toString()}`),this._frameScale=p.tuple2(w),this._frameSize=p.tuple2(N),this._favorSizeOverScale=!1,this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}get frameScale$(){return this._frameScaleSubject.asObservable()}get frameSize(){return this._frameSize}set frameSize(S){if(!isFinite(S[0])||!isFinite(S[1]))return void v.log(v.LogLevel.Warning,`expected finite frame size, non-finite values ignored, given [${S}]`);v.logIf(S[0]<1||S[0]>this._size[0],v.LogLevel.Info,`frame width scale clamped to [1,${this._size[0]}], given ${S[0]}`),v.logIf(S[1]<1||S[1]>this._size[1],v.LogLevel.Info,`frame height scale clamped to [1, ${this._size[1]}], given ${S[1]}`);const w=l.vec2.create();g.clamp2(w,S,[1,1],this._size),l.vec2.round(w,w),v.logIf(!l.vec2.exactEquals(w,S),v.LogLevel.Warning,`frame size was adjusted to ${w.toString()}, given ${S.toString()}`);const N=l.vec2.create();l.vec2.div(N,w,this._size),this._frameScale=p.tuple2(N),this._frameSize=p.tuple2(w),this._favorSizeOverScale=!l.vec2.exactEquals(this._frameSize,this._size),this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}get frameSize$(){return this._frameSizeSubject.asObservable()}get clearColor(){return this._clearColor}set clearColor(S){this._clearColor=S,this._renderer&&(this._renderer.clearColor=this._clearColor.rgba)}get framePrecision(){return this._framePrecision}set framePrecision(S){this._framePrecision=S,this._renderer&&(this._renderer.framePrecision=this._framePrecision,this._framePrecision=this._renderer.framePrecision),this.framePrecisionNext()}get framePrecision$(){return this._framePrecisionSubject.asObservable()}get context(){return this._context}get backend(){return this._context.backendString}get size(){return this._size}get size$(){return this._sizeSubject.asObservable()}get width(){return this._size[0]}get height(){return this._size[1]}get element(){return this._element}get mouseEventProvider(){return this._mouseEventProvider}get touchEventProvider(){return this._touchEventProvider}testLoseContext(){this._lostContextExtension!==void 0&&this._lostContextExtension.loseContext()}testRestoreContext(){this._lostContextExtension!==void 0&&this._lostContextExtension.restoreContext()}get eyeGazeEventProvider(){return this._eyeGazeEventProvider}activateEyeGazeEventProvider(S,w){this._eyeGazeEventProvider=new i.EyeGazeEventProvider(S,w)}}c.Canvas=m,m.DEFAULT_CLEAR_COLOR=new o.Color([.203,.227,.25,1]),m.DEFAULT_FRAME_PRECISION=b.Wizard.Precision.auto,m.DEFAULT_MULTI_FRAME_NUMBER=0},6233:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CanvasRecorder=void 0;const d=_(9696);class l{constructor(v){d.assert(l.isSupported(),"Recording the canvas is not supported."),this._canvas=v,this._state=l.State.INACTIVE,this._images=new Array}static isSupported(){return window.MediaRecorder!==void 0}static isMIMETypeSupported(v){return MediaRecorder.isTypeSupported(v)}start(v,p="video/webm",o=4194304){d.assert(v>=0,"FPS has to be positive"),d.assert(this._state===l.State.INACTIVE,"Recorder has to be inactive."),d.assert(l.isMIMETypeSupported(p),`MIME type: ${p} is not supported.`),this._stream=this._canvas.element.captureStream(v),this._recorder=new MediaRecorder(this._stream,{mimeType:p,bitsPerSecond:o}),this._images.length=0,this._mimeType=p,this._recorder.ondataavailable=r=>this._images.push(r.data),this._recorder.onstop=()=>{this._onImagesAvailable&&this._onImagesAvailable(this._images)},this._recorder.start(),this._state=l.State.RECORDING}stop(){d.assert(this._state!==l.State.INACTIVE,"Recorder must not be inactive.");const v=this._stream.getTracks();d.assert(v.length===1,"CanvasRecorder uses outdated version of MediaStream API."),this._recorder.stop(),v[0].stop(),this._recorder=void 0,this._stream=void 0,this._state=l.State.INACTIVE}pause(){d.assert(this._state!==l.State.INACTIVE,"Recorder must not be inactive."),this._recorder.pause(),this._state=l.State.PAUSED}resume(){d.assert(this._state!==l.State.INACTIVE,"Recorder must not be inactive."),this._recorder.resume(),this._state=l.State.RECORDING}frame(){d.assert(this._state===l.State.RECORDING,"Recorder has to be recording.");const v=this._stream.getTracks();d.assert(v.length===1,"CanvasRecorder uses unknown implementation of MediaStream API."),d.assert(this._stream.requestFrame||v[0].requestFrame,"CanvasRecorder uses unknown implementation of MediaStream API."),this._stream.requestFrame?this._stream.requestFrame():v[0].requestFrame()}download(v){const p=URL.createObjectURL(this.blob),o=document.createElement("a");o.style.display="none",o.setAttribute("href",p),o.setAttribute("download",v),document.body.appendChild(o),o.click(),setTimeout(()=>{document.body.removeChild(o),window.URL.revokeObjectURL(p)},256)}get images(){return this._images}get state(){return this._state}get blob(){return new Blob(this._images,{type:this._mimeType})}set onImagesAvailable(v){this._onImagesAvailable=v}}c.CanvasRecorder=l,function(g){(function(v){v[v.INACTIVE=0]="INACTIVE",v[v.RECORDING=1]="RECORDING",v[v.PAUSED=2]="PAUSED"})(g.State||(g.State={}))}(l=c.CanvasRecorder||(c.CanvasRecorder={}))},4597:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ChangeLookup=void 0;const d=_(9696);class l{static alter(v,p){d.assert(p.hasOwnProperty("any"),"expected alterable object to provide 'any' key"),p.any=!0;const o=v.split("."),r=o.shift();if(d.assert(r===""||p.hasOwnProperty(r),`expected object to have key '${r}' in order to capture alterations`),r!==""&&typeof p[r]!="object")return void(p[r]=!0);if(r!==""&&o.length>0)return void l.alter(o.join("."),p[r]);const n=r!==""?p[r]:p;for(const i of Object.getOwnPropertyNames(n))i!=="any"&&l.alter(i,n)}static reset(v){for(const p of Object.getOwnPropertyNames(v))typeof v[p]!="object"?v[p]=!1:l.reset(v[p])}alter(v){return l.alter(v,this)}reset(){return l.reset(this)}}c.ChangeLookup=l},7677:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Color=void 0;const d=_(3659),l=_(2111),g=_(9696),v=_(4934);class p{constructor(r,n){this._rgba=[0,0,0,p.DEFAULT_ALPHA],this._altered=!1,r!==void 0&&(r.length===3&&n!==void 0?this.fromF32(r[0],r[1],r[2],n):r.length===4?(this.fromF32(r[0],r[1],r[2],r[3]),g.assert(n===void 0,"expected alpha to be undefined when given an 4-tuple in RGBA")):this.fromF32(r[0],r[1],r[2]))}static hue2rgb(r,n,i){return g.assert(i>=-1&&i<=2,"t is expected to be between -1 and 2"),i<0?i+=1:i>1&&(i-=1),6*i<1?r+6*(n-r)*i:2*i<1?n:3*i<2?r+6*(n-r)*(2/3-i):r}static to2CharHexCode(r){return(r<15.5/255?"0":"")+Math.round(255*r).toString(16)}static hsl2rgb(r){const n=v.clampf3(r,"HSL input");if(n[1]===0)return[n[2],n[2],n[2]];const i=n[2]<.5?n[2]*(1+n[1]):n[2]+n[1]-n[1]*n[2],u=2*n[2]-i;return[p.hue2rgb(u,i,n[0]+1/3),p.hue2rgb(u,i,n[0]),p.hue2rgb(u,i,n[0]-1/3)]}static rgb2hsl(r){const n=v.clampf3(r,"RGB input"),i=[0,0,0],u=Math.min(n[0],n[1],n[2]),s=Math.max(n[0],n[1],n[2]),a=s-u;if(i[2]=.5*(s+u),a===0)return i;i[1]=i[2]<.5?a/(s+u):a/(2-s-u);const h=((s-n[0])/6+a/2)/a,b=((s-n[1])/6+a/2)/a,m=((s-n[2])/6+a/2)/a;return n[0]===s?i[0]=m-b:n[1]===s?i[0]=h-m+1/3:i[0]=b-h+2/3,i}static lab2xyz(r){const n=v.clampf3(r,"LAB input"),i=(100*n[0]+16)/116,u=(256*n[1]-128)/500+i,s=i-(256*n[2]-128)/200,a=Math.pow(u,3),h=Math.pow(i,3),b=Math.pow(s,3);return[.95047*(a>.008856?a:(u-16/116)/7.787),1*(h>.008856?h:(i-16/116)/7.787),1.08883*(b>.008856?b:(s-16/116)/7.787)]}static xyz2lab(r){const n=[r[0]/.95047,r[1]/1,r[2]/1.08883],i=n[0]>.008856?Math.cbrt(n[0]):7.787*n[0]+16/116,u=n[1]>.008856?Math.cbrt(n[1]):7.787*n[1]+16/116,s=n[2]>.008856?Math.cbrt(n[2]):7.787*n[2]+16/116;return v.clampf3([(116*u-16)/100,(500*(i-u)+128)/256,(200*(u-s)+128)/256])}static xyz2rgb(r){const n=2.04137*r[0]+-.56495*r[1]+-.34469*r[2],i=-.96927*r[0]+1.87601*r[1]+.04156*r[2],u=.01345*r[0]+-.11839*r[1]+1.01541*r[2];return v.clampf3([n>0?Math.pow(n,1/2.19921875):0,i>0?Math.pow(i,1/2.19921875):0,u>0?Math.pow(u,1/2.19921875):0])}static rgb2xyz(r){const n=v.clampf3(r,"RGB input"),i=Math.pow(n[0],2.19921875),u=Math.pow(n[1],2.19921875),s=Math.pow(n[2],2.19921875);return[.57667*i+.18555*u+.18819*s,.29738*i+.62735*u+.07527*s,.02703*i+.07069*u+.9911*s]}static lab2rgb(r){return p.xyz2rgb(p.lab2xyz(r))}static rgb2lab(r){return p.xyz2lab(p.rgb2xyz(r))}static cmyk2rgb(r){const n=v.clampf4(r,"CMYK input"),i=1-n[3];return[(1-n[0])*i,(1-n[1])*i,(1-n[2])*i]}static rgb2cmyk(r){const n=v.clampf3(r,"RGB input"),i=1-Math.max(n[0],n[1],n[2]),u=1-i,s=u===0?0:1/u;return[(u-n[0])*s,(u-n[1])*s,(u-n[2])*s,i]}static hex2rgba(r){const n=[0,0,0,p.DEFAULT_ALPHA];if(!p.HEX_FORMAT_REGEX.test(r))return g.log(g.LogLevel.Warning,`hexadecimal RGBA color string must conform to either '0x0000', '#0000', '0000', '0x00000000', '#00000000', or '00000000', given '${r}'`),n;const i=r.startsWith("0x")?2:r.startsWith("#")?1:0,u=Math.floor((r.length-i)/3),s=u-1;return n[0]=parseInt(r[i+0*u]+r[i+0*u+s],16)/255,n[1]=parseInt(r[i+1*u]+r[i+1*u+s],16)/255,n[2]=parseInt(r[i+2*u]+r[i+2*u+s],16)/255,r.length-i!=4&&r.length-i!=8||(n[3]=parseInt(r[i+3*u]+r[i+3*u+s],16)/255),g.assert(!(isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])),`expected well formated hexadecimal RGBA string, given '${r}'`),n}static rgb2hex(r){const n=v.clampf3(r,"RGB input");return"#"+p.to2CharHexCode(n[0])+p.to2CharHexCode(n[1])+p.to2CharHexCode(n[2])}static rgba2hex(r){const n=v.clampf4(r,"RGBA input");return"#"+p.to2CharHexCode(n[0])+p.to2CharHexCode(n[1])+p.to2CharHexCode(n[2])+p.to2CharHexCode(n[3])}static lerp(r,n,i,u=p.Space.LAB){if(i<=0)return new p(r.rgba);if(i>=1)return new p(n.rgba);const s=d.vec4.create();switch(u){case p.Space.CMYK:d.vec4.lerp(s,r.cmyk,n.cmyk,i);const a=l.mix(r.a,n.a,i);return new p().fromCMYK(s[0],s[1],s[2],s[3],a);case p.Space.LAB:return d.vec4.lerp(s,r.laba,n.laba,i),new p().fromLAB(s[0],s[1],s[2],s[3]);case p.Space.HSL:return d.vec4.lerp(s,r.hsla,n.hsla,i),new p().fromHSL(s[0],s[1],s[2],s[3]);case p.Space.RGB:return d.vec4.lerp(s,r.rgba,n.rgba,i),new p().fromRGB(s[0],s[1],s[2],s[3])}}equals(r){return v.equals4(this._rgba,r._rgba)}fromF32(r,n,i,u=p.DEFAULT_ALPHA){const s=v.duplicate4(this._rgba);return this._rgba[0]=v.clampf(r,"red value"),this._rgba[1]=v.clampf(n,"green value"),this._rgba[2]=v.clampf(i,"blue value"),this._rgba[3]=v.clampf(u,"alpha value"),this._altered=!v.equals4(this._rgba,s),this}fromUI8(r,n,i,u=Math.floor(255*p.DEFAULT_ALPHA)){const s=v.duplicate4(this._rgba);return this._rgba[0]=l.clamp(r,0,255)/255,this._rgba[1]=l.clamp(n,0,255)/255,this._rgba[2]=l.clamp(i,0,255)/255,this._rgba[3]=l.clamp(u,0,255)/255,this._altered=!v.equals4(this._rgba,s),this}fromRGB(r,n,i,u=p.DEFAULT_ALPHA){const s=v.duplicate4(this._rgba);return this._rgba=v.clampf4([r,n,i,u],"RGBA input"),this._altered=!v.equals4(this._rgba,s),this}fromHSL(r,n,i,u=p.DEFAULT_ALPHA){const s=v.duplicate4(this._rgba),a=p.hsl2rgb([r,n,i]),h=v.clampf(u,"ALPHA input");return this._rgba=[a[0],a[1],a[2],h],this._altered=!v.equals4(this._rgba,s),this}fromLAB(r,n,i,u=p.DEFAULT_ALPHA){const s=v.duplicate4(this._rgba),a=p.lab2rgb([r,n,i]),h=v.clampf(u,"ALPHA input");return this._rgba=[a[0],a[1],a[2],h],this._altered=!v.equals4(this._rgba,s),this}fromCMYK(r,n,i,u,s=p.DEFAULT_ALPHA){const a=v.duplicate4(this._rgba),h=p.cmyk2rgb([r,n,i,u]),b=v.clampf(s,"ALPHA input");return this._rgba=[h[0],h[1],h[2],b],this._altered=!v.equals4(this._rgba,a),this}fromHex(r){const n=v.duplicate4(this._rgba);return this._rgba=p.hex2rgba(r),this._altered=!v.equals4(this._rgba,n),this}gray(r=p.GrayscaleAlgorithm.LinearLuminance){switch(r){case p.GrayscaleAlgorithm.Average:return(this._rgba[0]+this._rgba[1]+this._rgba[2])/3;case p.GrayscaleAlgorithm.LeastSaturatedVariant:return .5*(Math.max(this._rgba[0],this._rgba[1],this._rgba[2])-Math.min(this._rgba[0],this._rgba[1],this._rgba[2]));case p.GrayscaleAlgorithm.MinimumDecomposition:return Math.min(this._rgba[0],this._rgba[1],this._rgba[2]);case p.GrayscaleAlgorithm.MaximumDecomposition:return Math.max(this._rgba[0],this._rgba[1],this._rgba[2]);case p.GrayscaleAlgorithm.LinearLuminance:return .2126*this._rgba[0]+.7152*this._rgba[1]+.0722*this._rgba[2]}}tuple(r,n=!0){switch(r){case p.Space.RGB:return n?this.rgba:this.rgb;case p.Space.LAB:return n?this.laba:this.lab;case p.Space.CMYK:return n?this.cmyka:this.cmyk;case p.Space.HSL:return n?this.hsla:this.hsl}}get rgb(){return[this._rgba[0],this._rgba[1],this._rgba[2]]}get rgbUI8(){const r=new Uint8Array(3);return r[0]=Math.round(255*this._rgba[0]),r[1]=Math.round(255*this._rgba[1]),r[2]=Math.round(255*this._rgba[2]),r}get rgbF32(){const r=new Float32Array(3);return r[0]=this._rgba[0],r[1]=this._rgba[1],r[2]=this._rgba[2],r}get rgba(){return this._rgba}get rgbaUI8(){const r=new Uint8Array(4);return r[0]=Math.round(255*this._rgba[0]),r[1]=Math.round(255*this._rgba[1]),r[2]=Math.round(255*this._rgba[2]),r[3]=Math.round(255*this._rgba[3]),r}get rgbaF32(){return new Float32Array(this._rgba)}get r(){return this._rgba[0]}get g(){return this._rgba[1]}get b(){return this._rgba[2]}get a(){return this._rgba[3]}get hexRGB(){return p.rgb2hex(this.rgb)}get hexRGBA(){return p.rgba2hex(this._rgba)}get hsl(){return p.rgb2hsl(this.rgb)}get hsla(){const r=p.rgb2hsl(this.rgb);return[r[0],r[1],r[2],this._rgba[3]]}get lab(){return p.rgb2lab(this.rgb)}get laba(){const r=p.rgb2lab(this.rgb);return[r[0],r[1],r[2],this._rgba[3]]}get cmyk(){return p.rgb2cmyk(this.rgb)}get cmyka(){const r=p.rgb2cmyk(this.rgb);return[r[0],r[1],r[2],r[3],this._rgba[3]]}get altered(){return this._altered}set altered(r){this._altered=r}}c.Color=p,p.DEFAULT_ALPHA=1,p.HEX_FORMAT_REGEX=new RegExp(/^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$/i),function(o){(function(r){r.Average="average",r.LinearLuminance="linear-luminance",r.LeastSaturatedVariant="least-saturated-variant",r.MinimumDecomposition="minimum-decomposition",r.MaximumDecomposition="maximum-decomposition"})(o.GrayscaleAlgorithm||(o.GrayscaleAlgorithm={})),function(r){r.RGB="rgb",r.HSL="hsl",r.LAB="lab",r.CMYK="cmyk"}(o.Space||(o.Space={}))}(p=c.Color||(c.Color={}))},5252:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorScale=void 0;const d=_(2111),l=_(9696),g=_(7677),v=_(6869);class p{constructor(){this._hint=p.InterpolationHint.Linear,this._colors=new Array,this._inverted=!1}static stride(r){switch(r){case p.ArrayType.RGBA:case p.ArrayType.RGBAf:return 4;case p.ArrayType.RGB:case p.ArrayType.RGBf:default:return 3}}static fromPreset(r,n,i){return v.fetchJsonAsync(r,u=>{let s;for(const N of u)if(N.identifier===n){s=N;break}if(s===void 0)return;const a=s.format,h=p.stride(a),b=s.colors;let m=b.length-1;for(let N=0;N<b.length;++N)if(b[N].length===i*h){m=N;break}const M=b[m],S=s.positions;if(S===void 0)return p.fromArray(M,a,i,void 0);let w;for(let N=0;N<S.length;++N)S[N].length===M.length&&(w=S[N]);return p.fromArray(M,a,i,w)},p.SCHEMA.properties)}static fromArray(r,n,i,u){if(i===0||r.length===0)return new p;const s=r,a=p.stride(n),h=s.length/a,b=new Array(h);for(let N=0;N<s.length;N+=a){const F=new g.Color;switch(n){case p.ArrayType.RGB:F.fromUI8(s[N+0],s[N+1],s[N+2]);break;case p.ArrayType.RGBA:F.fromUI8(s[N+0],s[N+1],s[N+2],s[N+3]);break;case p.ArrayType.RGBf:F.fromF32(s[N+0],s[N+1],s[N+2]);break;case p.ArrayType.RGBAf:F.fromF32(s[N+0],s[N+1],s[N+2],s[N+3])}b[N/a]=F}const m=new p;if(u===void 0&&i===h)return m._colors=b,m;if(i===1&&m._colors.push(b[0]),u===void 0){(u=new Array(h))[0]=0;for(let N=1;N<h;++N)u[N]=N/(h-1)}l.assert(u.length===b.length,`expected number of positions (${u.length}) to match number of colors (${b.length})`);let M=0,S=M+1;const w=h-1;for(let N=0;N<i;++N){const F=N===0?0:N/(i-1);if(F<=u[M]){m._colors.push(b[M]);continue}if(u[w]<=F){m._colors.push(b[w]);continue}for(let X=M+1;X<h;++X)if(!(u[X]<F)){S=X,M=X-1;break}const k=(F-u[M])/(u[S]-u[M]);m._colors.push(g.Color.lerp(b[M],b[S],k,g.Color.Space.LAB))}return m}lerp(r,n=g.Color.Space.LAB){if(this._colors.length===0)return;if(this._colors.length===1)return this._colors[0];const i=d.clamp(r,0,1);if(i<=0)return this._colors[0];if(i>=1)return this._colors[this._colors.length-1];const u=r*this._colors.length,s=Math.floor(u),a=s+1;return a>=this._colors.length?this._colors[this._colors.length-1]:(l.assert(a<this._colors.length,`expected upper not exceed maximum color index: ${a} < ${this._colors.length}`),this._hint===p.InterpolationHint.Nearest?this._colors[u-s<=a-u?s:a]:g.Color.lerp(this._colors[s],this._colors[a],u-s,n))}color(r){if(!(r<0||r>=this._colors.length))return this._colors[r]}get colors(){return this._colors}set colors(r){this._colors=r}set hint(r){this._hint=r}get hint(){return this._hint}get length(){return this._colors.length}get inverted(){return this._inverted}invert(){this._colors.reverse(),this._inverted=!this._inverted}bitsUI8(r=g.Color.Space.RGB,n=!0){const i=this._colors.length,u=n?4:3,s=new Uint8Array(i*u);for(let a=0;a<i;++a){const h=this._colors[a].tuple(r,n);s[a*u+0]=255*h[0],s[a*u+1]=255*h[1],s[a*u+2]=255*h[2],n&&h.length===4&&(s[a*u+3]=255*h[3])}return s}bitsF32(r=g.Color.Space.RGB,n=!0){const i=this._colors.length,u=n?4:3,s=new Float32Array(i*u);for(let a=0;a<i;++a){const h=this._colors[a].tuple(r,n);s[a*u+0]=h[0],s[a*u+1]=h[1],s[a*u+2]=h[2],n&&h.length===4&&(s[a*u+3]=h[3])}return s}}c.ColorScale=p,p.SCHEMA=_(8632),function(o){(function(r){r.Linear="linear",r.Nearest="nearest"})(o.InterpolationHint||(o.InterpolationHint={})),function(r){r.sequential="sequential",r.diverging="diverging",r.qualitative="qualitative"}(o.ScaleType||(o.ScaleType={})),function(r){r.RGB="rgb",r.RGBf="rgbf",r.RGBA="rgba",r.RGBAf="rgbaf"}(o.ArrayType||(o.ArrayType={}))}(p=c.ColorScale||(c.ColorScale={}))},4518:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Context=void 0;const d=_(9696),l=_(423),g=_(7945),v=_(1985),p=_(8600),o=_(9568),r=_(5218);class n{constructor(u,s){this._attributes=void 0,this._extensions=new Array,this._allocationRegister=new g.AllocationRegister,this._context=u,this._mask=s;const a=u.toString();{const h=/WebGLRenderingContext/.test(a)||/CaptureContext/.test(a),b=/WebGL2RenderingContext/.test(a);this._backend=h?n.BackendType.WebGL1:b?n.BackendType.WebGL2:void 0}if(d.assert(this._backend!==void 0&&this._backend.valueOf()!==n.BackendType.Invalid.valueOf(),`context is neither webgl nor webgl2, given ${a}`),this.queryAttributes(),this.queryExtensionSupport(),this._mask&&this._mask.functionsUndefine)for(const h in this._mask.functionsUndefine)this._context[h]=void 0;this._gl2=new r.GL2Facade(this)}static createMasqueradeFromGETorDataAttribute(u){return v.ContextMasquerade.fromGET()||(u.msqrdH?v.ContextMasquerade.fromHash(u.msqrdH):u.msqrdP?v.ContextMasquerade.fromPreset(u.msqrdP):void 0)}static request(u,s=n.DEFAULT_ATTRIBUTES){const a=u.dataset,h=n.createMasqueradeFromGETorDataAttribute(a);let b,m=h?h.backend:a.backend?a.backend.toLowerCase():"auto";switch(m in n.BackendRequestType||(d.log(d.LogLevel.Warning,`unknown backend '${a.backend}' changed to '${n.BackendRequestType.auto}'`),m="auto"),m){case n.BackendRequestType.webgl:break;case n.BackendRequestType.experimental:case n.BackendRequestType.webgl1:case n.BackendRequestType.experimental1:m=n.BackendRequestType.webgl;break;case n.BackendRequestType.webgl2:case n.BackendRequestType.experimental2:m=n.BackendRequestType.webgl2;break;default:m=n.BackendRequestType.auto}return m!==n.BackendRequestType.webgl&&(b=this.requestWebGL2(u,s)),b||(b=this.requestWebGL1(u,s),d.logIf(b!==void 0&&m===n.BackendRequestType.webgl2,d.LogLevel.Info,`backend changed to '${n.BackendRequestType.webgl}', given '${m}'`)),d.assert(!!b,"creating a context failed"),new n(b,h)}static requestWebGL1(u,s=n.DEFAULT_ATTRIBUTES){let a=u.getContext(n.BackendRequestType.webgl,s);return a||(a=u.getContext(n.BackendRequestType.experimental,s),a===null?void 0:a)}static requestWebGL2(u,s=n.DEFAULT_ATTRIBUTES){let a=u.getContext(n.BackendRequestType.webgl2,s);return a||(a=u.getContext(n.BackendRequestType.experimental2,s),a===null?void 0:a)}queryAttributes(){const u=this._context.getContextAttributes();u!==null?this._attributes=u:d.log(d.LogLevel.Error,"querying context attributes failed (probably blocked)")}get alpha(){return!!this._attributes&&this._attributes.alpha}get antialias(){return!!this._attributes&&this._attributes.antialias}get depth(){return!!this._attributes&&this._attributes.depth}get failIfMajorPerformanceCaveat(){return!!this._attributes&&this._attributes.failIfMajorPerformanceCaveat}get premultipliedAlpha(){return!!this._attributes&&this._attributes.premultipliedAlpha}get preserveDrawingBuffer(){return!!this._attributes&&this._attributes.preserveDrawingBuffer}get stencil(){return!!this._attributes&&this._attributes.stencil}supports(u){if(this._mask&&this._mask.extensionsConceal.indexOf(u)>-1)return!1;switch(this._backend){case n.BackendType.WebGL1:d.assert(p.WEBGL1_EXTENSIONS.indexOf(u)>-1,`extension ${u} not available to WebGL1`);break;case n.BackendType.WebGL2:d.assert(p.WEBGL2_DEFAULT_EXTENSIONS.indexOf(u)===-1,`extension ${u} supported by default in WebGL2`),d.assert(p.WEBGL2_EXTENSIONS.indexOf(u)>-1,`extension ${u} not available to WebGL2`)}return this._extensions.indexOf(u)>-1}enable(u){for(const s of u)this.isWebGL1&&p.WEBGL1_EXTENSIONS.indexOf(s)===-1||this.isWebGL2&&p.WEBGL2_EXTENSIONS.indexOf(s)===-1||this.supports(s)!==!1&&this.extension(void 0,s)}queryExtensionSupport(){const u=this._context.getSupportedExtensions();if(u!==null){for(const s of u)this._mask&&this._mask.extensionsConceal.indexOf(s)>-1||this._extensions.push(s);this._backend===n.BackendType.WebGL1&&(this.ANGLE_instanced_arrays_supported=this.supports("ANGLE_instanced_arrays"),this.EXT_blend_minmax_supported=this.supports("EXT_blend_minmax"),this.EXT_color_buffer_half_float_supported=this.supports("EXT_color_buffer_half_float"),this.EXT_disjoint_timer_query_supported=this.supports("EXT_disjoint_timer_query"),this.EXT_frag_depth_supported=this.supports("EXT_frag_depth"),this.EXT_sRGB_supported=this.supports("EXT_sRGB"),this.EXT_shader_texture_lod_supported=this.supports("EXT_shader_texture_lod"),this.OES_element_index_uint_supported=this.supports("OES_element_index_uint"),this.OES_standard_derivatives_supported=this.supports("OES_standard_derivatives"),this.OES_texture_float_supported=this.supports("OES_texture_float"),this.OES_texture_half_float_supported=this.supports("OES_texture_half_float"),this.OES_vertex_array_object_supported=this.supports("OES_vertex_array_object"),this.WEBGL_color_buffer_float_supported=this.supports("WEBGL_color_buffer_float"),this.WEBGL_depth_texture_supported=this.supports("WEBGL_depth_texture"),this.WEBGL_draw_buffers_supported=this.supports("WEBGL_draw_buffers")),this._backend===n.BackendType.WebGL2&&(this.EXT_color_buffer_float_supported=this.supports("EXT_color_buffer_float"),this.EXT_disjoint_timer_query_webgl2_supported=this.supports("EXT_disjoint_timer_query_webgl2")),this.EXT_texture_filter_anisotropic_supported=this.supports("EXT_texture_filter_anisotropic"),this.OES_texture_float_linear_supported=this.supports("OES_texture_float_linear"),this.OES_texture_half_float_linear_supported=this.supports("OES_texture_half_float_linear"),this.WEBGL_compressed_texture_astc_supported=this.supports("WEBGL_compressed_texture_astc"),this.WEBGL_compressed_texture_atc_supported=this.supports("WEBGL_compressed_texture_atc"),this.WEBGL_compressed_texture_etc_supported=this.supports("WEBGL_compressed_texture_etc"),this.WEBGL_compressed_texture_etc1_supported=this.supports("WEBGL_compressed_texture_etc1"),this.WEBGL_compressed_texture_pvrtc_supported=this.supports("WEBGL_compressed_texture_pvrtc"),this.WEBGL_compressed_texture_s3tc_supported=this.supports("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb_supported=this.supports("WEBGL_compressed_texture_s3tc_srgb"),this.WEBGL_debug_renderer_info_supported=this.supports("WEBGL_debug_renderer_info"),this.WEBGL_debug_shaders_supported=this.supports("WEBGL_debug_shaders"),this.WEBGL_lose_context_supported=this.supports("WEBGL_lose_context")}else d.log(d.LogLevel.Error,"querying supported extensions failed (probably blocked)")}extension(u,s){return u===void 0&&(d.assert(this.supports(s),`extension ${s} expected to be supported`),u=this._context.getExtension(s)),u}get allocationRegister(){return this._allocationRegister}get backend(){return this._backend}get backendString(){switch(this._backend){case n.BackendType.WebGL1:return"WebGL";case n.BackendType.WebGL2:return"WebGL2";default:return}}get extensions(){return this._extensions}get mask(){return this._mask}get gl(){return this._context}get gl2facade(){return this._gl2}get isWebGL1(){return this._backend===n.BackendType.WebGL1}get isWebGL2(){return this._backend===n.BackendType.WebGL2}get supportsInstancedArrays(){return this.ANGLE_instanced_arrays_supported}get instancedArrays(){return this.extension(this.ANGLE_instanced_arrays,"ANGLE_instanced_arrays")}get supportsBlendMinmax(){return this.EXT_blend_minmax_supported}get blendMinmax(){return this.extension(this.EXT_blend_minmax,"EXT_blend_minmax")}get supportsColorBufferHalfFloat(){return this.EXT_color_buffer_half_float_supported}get colorBufferHalfFloat(){return this.extension(this.EXT_color_buffer_half_float,"EXT_color_buffer_half_float")}get supportsDisjointTimerQuery(){return this.EXT_disjoint_timer_query_supported}get disjointTimerQuery(){return this.extension(this.EXT_disjoint_timer_query,"EXT_disjoint_timer_query")}get supportsDisjointTimerQueryWebGL2(){return this.EXT_disjoint_timer_query_webgl2_supported}get disjointTimerQueryWebGL2(){return this.extension(this.EXT_disjoint_timer_query_webgl2,"EXT_disjoint_timer_query_webgl2")}get supportsFragDepth(){return this.EXT_frag_depth_supported}get fragDepth(){return this.extension(this.EXT_frag_depth,"EXT_frag_depth")}get supportsSRGB(){return this.EXT_sRGB_supported}get sRGB(){return this.extension(this.EXT_sRGB,"EXT_sRGB")}get supportsShaderTextureLOD(){return this.EXT_shader_texture_lod_supported}get shaderTextureLOD(){return this.extension(this.EXT_shader_texture_lod,"EXT_shader_texture_lod")}get supportsTextureFilterAnisotropic(){return this.EXT_texture_filter_anisotropic_supported}get textureFilterAnisotropic(){return this.extension(this.EXT_texture_filter_anisotropic,"EXT_texture_filter_anisotropic")}get supportsElementIndexUint(){return this.OES_element_index_uint_supported}get elementIndexUint(){return this.extension(this.OES_element_index_uint,"OES_element_index_uint")}get supportsStandardDerivatives(){return this.OES_standard_derivatives_supported}get standardDerivatives(){return this.extension(this.OES_standard_derivatives,"OES_standard_derivatives")}get supportsTextureFloat(){return this.OES_texture_float_supported}get textureFloat(){return this.extension(this.OES_texture_float,"OES_texture_float")}get supportsTextureFloatLinear(){return this.OES_texture_float_linear_supported}get textureFloatLinear(){return this.extension(this.OES_texture_float_linear,"OES_texture_float_linear")}get supportsTextureHalfFloat(){return this.OES_texture_half_float_supported}get textureHalfFloat(){return this.extension(this.OES_texture_half_float,"OES_texture_half_float")}get supportsTextureHalfFloatLinear(){return this.OES_texture_half_float_linear_supported}get textureHalfFloatLinear(){return this.extension(this.OES_texture_half_float_linear,"OES_texture_half_float_linear")}get supportsVertexArrayObject(){return this.OES_vertex_array_object_supported}get vertexArrayObject(){return this.extension(this.OES_vertex_array_object,"OES_vertex_array_object")}get supportsColorBufferFloat(){switch(this._backend){case n.BackendType.WebGL1:return this.WEBGL_color_buffer_float_supported;case n.BackendType.WebGL2:return this.EXT_color_buffer_float_supported;default:return}}get colorBufferFloat(){switch(this._backend){case n.BackendType.WebGL1:return this.extension(this.WEBGL_color_buffer_float,"WEBGL_color_buffer_float");case n.BackendType.WebGL2:return this.extension(this.EXT_color_buffer_float,"EXT_color_buffer_float");default:return}}get supportsCompressedTextureASTC(){return this.WEBGL_compressed_texture_astc_supported}get compressedTextureASTC(){return this.extension(this.WEBGL_compressed_texture_astc,"WEBGL_compressed_texture_astc")}get supportsCompressedTextureATC(){return this.WEBGL_compressed_texture_atc_supported}get compressedTextureATC(){return this.extension(this.WEBGL_compressed_texture_atc,"WEBGL_compressed_texture_atc")}get supportsCompressedTextureETC(){return this.WEBGL_compressed_texture_etc_supported}get compressedTextureETC(){return this.extension(this.WEBGL_compressed_texture_etc,"WEBGL_compressed_texture_etc")}get supportsCompressedTextureETC1(){return this.WEBGL_compressed_texture_etc1_supported}get compressedTextureETC1(){return this.extension(this.WEBGL_compressed_texture_etc1,"WEBGL_compressed_texture_etc1")}get supportsCompressedTexturePVRTC(){return this.WEBGL_compressed_texture_pvrtc_supported}get compressedTexturePVRTC(){return this.extension(this.WEBGL_compressed_texture_pvrtc,"WEBGL_compressed_texture_pvrtc")}get supportsCompressedTextureS3TC(){return this.WEBGL_compressed_texture_s3tc_supported}get compressedTextureS3TC(){return this.extension(this.WEBGL_compressed_texture_s3tc,"WEBGL_compressed_texture_s3tc")}get supportsCompressedTextureS3TCSRGB(){return this.WEBGL_compressed_texture_s3tc_srgb_supported}get compressedTextureS3TCSRGB(){return this.extension(this.WEBGL_compressed_texture_s3tc_srgb,"WEBGL_compressed_texture_s3tc_srgb")}get supportsDebugRendererInfo(){return this.WEBGL_debug_renderer_info_supported}get debugRendererInfo(){return this.extension(this.WEBGL_debug_renderer_info,"WEBGL_debug_renderer_info")}get supportsDebugShaders(){return this.WEBGL_debug_shaders_supported}get debugShaders(){return this.extension(this.WEBGL_debug_shaders,"WEBGL_debug_shaders")}get supportsDepthTexture(){return this.WEBGL_depth_texture_supported}get depthTexture(){return this.extension(this.WEBGL_depth_texture,"WEBGL_depth_texture")}get supportsDrawBuffers(){return this.WEBGL_draw_buffers_supported}get drawBuffers(){return this.extension(this.WEBGL_draw_buffers,"WEBGL_draw_buffers")}get supportsLoseContext(){return this.WEBGL_lose_context_supported}get loseContext(){return this.extension(this.WEBGL_lose_context,"WEBGL_lose_context")}get supportsBlitFramebuffer(){return this._context.blitFramebuffer!==void 0}get supportsReadBuffer(){return this._context.readBuffer!==void 0}get supportsTexImage3D(){return this._context.texImage3D!==void 0}param(u){return d.assert(!!this._context,"expected context to be valid"),this._context.getParameter(u)}hash(){return o.ExtensionsHash.encode(this._backend,this._extensions)}about(){const u="ok",s="na";if(this._backend===n.BackendType.Invalid)return new Array;d.assert(!!this._context,"expected context to be valid");const a=this._context,h=new Array;h.push(["BACKEND (GLOPERATE)",this.backend]),h.push(["CONTEXT_HASH (GLOPERATE)",this.hash()]),h.push(["RENDERER",this.param(a.RENDERER)]),h.push(["VENDOR",this.param(a.VENDOR)]),h.push(["VERSION",this.param(a.VERSION)]),h.push(["SHADING_LANGUAGE_VERSION",this.param(a.SHADING_LANGUAGE_VERSION)]),h.push(["UNMASKED_VENDOR_WEBGL",this.supportsDebugRendererInfo?this.param(this.debugRendererInfo.UNMASKED_VENDOR_WEBGL):s]),h.push(["UNMASKED_RENDERER_WEBGL",this.supportsDebugRendererInfo?this.param(this.debugRendererInfo.UNMASKED_RENDERER_WEBGL):s]),h.push(["ALPHA (ATTRIBUTE)",String(this.alpha)]),h.push(["ANTIALIAS (ATTRIBUTE)",String(this.antialias)]),h.push(["DEPTH (ATTRIBUTE)",String(this.depth)]),h.push(["FAIL_IF_MAJOR_PERFORMANCE_CAVEAT (ATTRIBUTE)",String(this.failIfMajorPerformanceCaveat)]),h.push(["PREMULTIPLIED_ALPHA (ATTRIBUTE)",String(this.premultipliedAlpha)]),h.push(["PRESERVE_DRAWING_BUFFER (ATTRIBUTE)",String(this.preserveDrawingBuffer)]),h.push(["STENCIL (ATTRIBUTE)",String(this.stencil)]),h.push(["DEVICE_PIXEL_RATIO (WINDOW)",window.devicePixelRatio]),h.push(["APP_CODE_NAME (NAVIGATOR)",window.navigator.appCodeName]),h.push(["APP_NAME (NAVIGATOR)",window.navigator.appName]),h.push(["APP_VERSION (NAVIGATOR)",window.navigator.appVersion]),h.push(["PLATFORM (NAVIGATOR)",window.navigator.platform]),h.push(["HARDWARE_CONCURRENCY (NAVIGATOR)",window.navigator.appCodeName]),h.push(["VENDOR (NAVIGATOR)",window.navigator.vendor]),h.push(["VENDOR_SUB (NAVIGATOR)",window.navigator.vendorSub]),h.push(["MAX_COMBINED_TEXTURE_IMAGE_UNITS",this.param(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS)]),h.push(["MAX_CUBE_MAP_TEXTURE_SIZE",this.param(a.MAX_CUBE_MAP_TEXTURE_SIZE)]),h.push(["MAX_FRAGMENT_UNIFORM_VECTORS",this.param(a.MAX_FRAGMENT_UNIFORM_VECTORS)]),h.push(["MAX_RENDERBUFFER_SIZE",this.param(a.MAX_RENDERBUFFER_SIZE)]),h.push(["MAX_TEXTURE_IMAGE_UNITS",this.param(a.MAX_TEXTURE_IMAGE_UNITS)]),h.push(["MAX_TEXTURE_SIZE",this.param(a.MAX_TEXTURE_SIZE)]),h.push(["MAX_VARYING_VECTORS",this.param(a.MAX_VARYING_VECTORS)]),h.push(["MAX_VERTEX_ATTRIBS",this.param(a.MAX_VERTEX_ATTRIBS)]),h.push(["MAX_VERTEX_TEXTURE_IMAGE_UNITS",this.param(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS)]),h.push(["MAX_VERTEX_UNIFORM_VECTORS",this.param(a.MAX_VERTEX_UNIFORM_VECTORS)]);const b=this.param(a.MAX_VIEWPORT_DIMS);if(h.push(["MAX_VIEWPORT_DIMS (WIDTH)",b?b[0]:null]),h.push(["MAX_VIEWPORT_DIMS (HEIGHT)",b?b[1]:null]),this.isWebGL2){const m=this._context;h.push(["MAX_3D_TEXTURE_SIZE",this.param(m.MAX_3D_TEXTURE_SIZE)]),h.push(["MAX_ARRAY_TEXTURE_LAYERS",this.param(m.MAX_ARRAY_TEXTURE_LAYERS)]),h.push(["MAX_CLIENT_WAIT_TIMEOUT_WEBGL",this.param(m.MAX_CLIENT_WAIT_TIMEOUT_WEBGL)]),h.push(["MAX_COLOR_ATTACHMENTS",this.param(m.MAX_COLOR_ATTACHMENTS)]),h.push(["MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",this.param(m.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS)]),h.push(["MAX_COMBINED_UNIFORM_BLOCKS",this.param(m.MAX_COMBINED_UNIFORM_BLOCKS)]),h.push(["MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",this.param(m.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS)]),h.push(["MAX_DRAW_BUFFERS",this.param(m.MAX_DRAW_BUFFERS)]),h.push(["MAX_ELEMENT_INDEX",this.param(m.MAX_ELEMENT_INDEX)]),h.push(["MAX_ELEMENTS_INDICES",this.param(m.MAX_ELEMENTS_INDICES)]),h.push(["MAX_ELEMENTS_VERTICES",this.param(m.MAX_ELEMENTS_VERTICES)]),h.push(["MAX_FRAGMENT_INPUT_COMPONENTS",this.param(m.MAX_FRAGMENT_INPUT_COMPONENTS)]),h.push(["MAX_FRAGMENT_UNIFORM_BLOCKS",this.param(m.MAX_FRAGMENT_UNIFORM_BLOCKS)]),h.push(["MAX_FRAGMENT_UNIFORM_COMPONENTS",this.param(m.MAX_FRAGMENT_UNIFORM_COMPONENTS)]),h.push(["MAX_PROGRAM_TEXEL_OFFSET",this.param(m.MAX_PROGRAM_TEXEL_OFFSET)]),h.push(["MAX_SAMPLES",this.param(m.MAX_SAMPLES)]),h.push(["MAX_SERVER_WAIT_TIMEOUT",this.param(m.MAX_SERVER_WAIT_TIMEOUT)]),h.push(["MAX_TEXTURE_LOD_BIAS",this.param(m.MAX_TEXTURE_LOD_BIAS)]),h.push(["MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",this.param(m.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS)]),h.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",this.param(m.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS)]),h.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",this.param(m.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS)]),h.push(["MAX_UNIFORM_BLOCK_SIZE",this.param(m.MAX_UNIFORM_BLOCK_SIZE)]),h.push(["MAX_UNIFORM_BUFFER_BINDINGS",this.param(m.MAX_UNIFORM_BUFFER_BINDINGS)]),h.push(["MAX_VARYING_COMPONENTS",this.param(m.MAX_VARYING_COMPONENTS)]),h.push(["MAX_VERTEX_OUTPUT_COMPONENTS",this.param(m.MAX_VERTEX_OUTPUT_COMPONENTS)]),h.push(["MAX_VERTEX_UNIFORM_BLOCKS",this.param(m.MAX_VERTEX_UNIFORM_BLOCKS)]),h.push(["MAX_VERTEX_UNIFORM_COMPONENTS",this.param(m.MAX_VERTEX_UNIFORM_COMPONENTS)]),h.push(["MIN_PROGRAM_TEXEL_OFFSET",this.param(m.MIN_PROGRAM_TEXEL_OFFSET)])}if(this.isWebGL1)for(const m of p.WEBGL1_EXTENSIONS)h.push([m,this.supports(m)?u:s]);else if(this.isWebGL2){for(const m of p.WEBGL2_DEFAULT_EXTENSIONS)h.push([`${m} (default)`,u]);for(const m of p.WEBGL2_EXTENSIONS)h.push([m,this.supports(m)?u:s])}return h}aboutString(){const u=this.about();let s=0;for(const m of u)s=Math.max(m[0].length,s);let a=0,h="";const b=this.isWebGL2?63+p.WEBGL2_DEFAULT_EXTENSIONS.length:-1;for(const m of u){switch(a){case 2:case 6:case 8:case 15:case 16:case 23:case 35:case 63:case b:h+=`
`}h+=`  ${m[0]} ${"-".repeat(s-m[0].length)}-- ${m[1]}
`,++a}return h+=`
`,h}logAbout(u=d.LogLevel.Info){d.log(u,`context.about

`+this.aboutString())}logAboutIf(u,s=d.LogLevel.Info){d.logIf(u,s,`context.about

`+this.aboutString())}byteSizeOfFormat(u){return l.byteSizeOfFormat(this,u)}}c.Context=n,n.DEFAULT_ATTRIBUTES={alpha:!0,antialias:!1,depth:!0,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},function(i){(function(u){u.Invalid="invalid",u.WebGL1="webgl1",u.WebGL2="webgl2"})(i.BackendType||(i.BackendType={})),function(u){u.auto="auto",u.webgl="webgl",u.experimental="experimental-webgl",u.webgl1="webgl1",u.experimental1="experimental-webgl1",u.webgl2="webgl2",u.experimental2="experimental-webgl2"}(i.BackendRequestType||(i.BackendRequestType={}))}(n=c.Context||(c.Context={}))},1985:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ContextMasquerade=void 0;const d=_(9696),l=_(9568);class g{constructor(){this._extensionsStrive=new Array,this._extensionsConceal=new Array,this._functionsUndefine=new Array}static fromHash(p){const o=new g,r=l.ExtensionsHash.decode(p);return o._backend=r[0],o._extensionsStrive=r[1],o._extensionsConceal=l.ExtensionsHash.complement(o._backend,o._extensionsStrive),o}static fromPreset(p){const o=new g,r=new Array;let n;for(const i of g.presets())if(r.push(i.identifier),i.identifier===p){n=i;break}if(n===void 0&&d.assert(!1,`expected valid identifier, available ['${r.join("', '")}'], given '${p}'`),n=n,n.extensions_hash!==void 0){const i=l.ExtensionsHash.decode(n.extensions_hash);o._backend=i[0],o._extensionsStrive=i[1]}else o._backend=n.backend;return d.assert(o._backend!==void 0,"expected backend to be included in preset"),n.extensions_strive===void 0?(o._extensionsStrive=[],o._extensionsConceal=n.extensions_conceal?n.extensions_conceal:[]):(o._extensionsStrive=n.extensions_strive,o._extensionsConceal=l.ExtensionsHash.complement(o._backend,n.extensions_strive)),o._functionsUndefine=n.functions_undefine?n.functions_undefine:[],o}static fromGET(){const p=d.GETparameter("msqrd_h");if(p!==void 0)return g.fromHash(p);const o=d.GETparameter("msqrd_p");return o!==void 0?g.fromPreset(o):void 0}static presets(){return this.MASQUERADE_JSON}get backend(){return this._backend}get extensionsStrive(){return this._extensionsStrive}get extensionsConceal(){return this._extensionsConceal}get functionsUndefine(){return this._functionsUndefine}}c.ContextMasquerade=g,g.MASQUERADE_JSON=_(7456)},3863:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Controller=void 0;const d=_(7318),l=_(9696),g=_(2111);class v{constructor(){this._batchSize=1,this._multiFrameNumber=1,this._multiFrameNumberSubject=new d.ReplaySubject(1),this._debugFrameNumber=0,this._debugFrameNumberSubject=new d.ReplaySubject(1),this._frameNumber=0,this._frameNumberSubject=new d.ReplaySubject(1),this._multiFrameDelay=0,this._postFrameEventSubject=new d.Subject,this._postSwapEventSubject=new d.Subject,this._animationFrameID=0,this._block=!1,this._blockedUpdates=0,this._intermediateFrameCount=0,this._multiFrameCount=0,this._intermediateFrameTimes=new Array(2),this._multiTime=[0,0],this._invalidated=!1,this._force=!1}set debug(o){o&&l.logVerbosity()<l.LogLevel.Debug&&(l.logVerbosity(l.LogLevel.Debug),l.log(l.LogLevel.Debug,`changed log verbosity to ${l.LogLevel.Debug} (debug)`)),v._debug=o}set batch(o){l.log(l.LogLevel.Warning,"(adaptive) batch multi-frame rendering is experimental for now"),this._batchSize=Math.max(1,o)}request(o=v.RequestType.Frame){this._animationFrameID=0,this._block?this._blockedUpdates++:this._animationFrameID=window.requestAnimationFrame(()=>this.invoke(o))}invoke(o){if(this._animationFrameID!==0){if(l.assert(this._controllable!==void 0,"frame sequence invoked without controllable set"),this._invalidated&&(this._invalidated=!1,(this.invokeUpdate()||this._force)&&(this._force=!1,this._frameNumber=0,this.cancelWaitMultiFrame(),this.invokePrepare())),o===v.RequestType.Frame&&this._frameNumber===1)return this._timeoutID===void 0&&this.startWaitMultiFrame(),void(this._animationFrameID=0);this.isMultiFrameFinished()?this._animationFrameID=0:(this.invokeFrameAndSwap(),this.request())}}invokeUpdate(){return l.logIf(v._debug,l.LogLevel.Debug,`c invoke update     | pending: '${this._animationFrameID}', mfnum: ${this._multiFrameNumber}`),this._controllable.update(this._multiFrameNumber)}invokePrepare(){l.logIf(v._debug,l.LogLevel.Debug,"c invoke prepare    |"),this._multiFrameTime=0,this._intermediateFrameTimes[0]=Number.MAX_VALUE,this._intermediateFrameTimes[1]=Number.MIN_VALUE,this._multiTime[0]=performance.now(),this._controllable.prepare(),this._multiTime[1]=performance.now();const o=this._multiTime[1]-this._multiTime[0];this._multiFrameTime=o,this._updateFrameTime=o}invokeFrameAndSwap(){l.logIf(v._debug,l.LogLevel.Debug,`c invoke frame      | pending: '${this._animationFrameID}'`);const o=this._debugFrameNumber>0;l.assert(!o||this._frameNumber<this._debugFrameNumber,"frame number about to exceed debug-frame number");const r=performance.now();let n=Math.min(this._multiFrameNumber,this._frameNumber+this._batchSize);for(this._debugFrameNumber>0&&(n=Math.min(n,this._debugFrameNumber));this._frameNumber<n;++this._frameNumber)l.logIf(v._debug,l.LogLevel.Debug,`c -> frame          | frame: ${this._frameNumber}`),this._controllable.frame(this._frameNumber),this._postFrameEventSubject.next(this._frameNumber),++this._intermediateFrameCount;l.logIf(v._debug,l.LogLevel.Debug,"c -> swap           |"),this._controllable.swap(),this._postSwapEventSubject.next(this._frameNumber),this._multiTime[1]=performance.now();const i=this._multiTime[1]-r;this._multiFrameTime+=i,this._intermediateFrameTimes[0]=Math.min(this._intermediateFrameTimes[0],i),this._intermediateFrameTimes[1]=Math.max(this._intermediateFrameTimes[1],i),this.frameNumberNext()}startWaitMultiFrame(){this._timeoutID=window.setTimeout(()=>{this.request(v.RequestType.MultiFrame),this._timeoutID=void 0},this._multiFrameDelay)}cancelWaitMultiFrame(){this._timeoutID!==void 0&&(window.clearTimeout(this._timeoutID),this._timeoutID=void 0)}isMultiFrameFinished(){return this._debugFrameNumber>0?this._frameNumber===this._debugFrameNumber:this._frameNumber===this._multiFrameNumber}multiFrameNumberNext(){this._multiFrameNumberSubject.next(this._multiFrameNumber)}debugFrameNumberNext(){this._debugFrameNumberSubject.next(this._debugFrameNumber)}frameNumberNext(){this._frameNumberSubject.next(this._frameNumber)}update(o=!1){this._invalidated=!0,this._force=this._force||o,this._animationFrameID===0&&this.request()}block(){l.logIf(v._debug,l.LogLevel.Debug,`c block   ${this._block?"(ignored) ":"          "}|`),this._block=!0}unblock(){l.logIf(v._debug,l.LogLevel.Debug,"c unblock "+(this._block?"          ":"(ignored) ")+`| blocked: #${this._blockedUpdates}`),this._block&&(this._block=!1,this._blockedUpdates>0&&(this._blockedUpdates=0,this.update()))}cancel(){this._animationFrameID!==0&&(window.cancelAnimationFrame(this._animationFrameID),this._animationFrameID=0)}get blocked(){return this._block}set controllable(o){o!==this._controllable&&(this._controllable=o,this.update(!0))}get multiFrameNumber(){return this._multiFrameNumber}set multiFrameNumber(o){const r=Math.max(1,isNaN(o)?1:o);r!==this._multiFrameNumber&&(this._multiFrameNumber=r,this.multiFrameNumberNext(),l.logIf(r!==o,l.LogLevel.Debug,`multi-frame number adjusted to ${r}, given ${o}`),this.debugFrameNumber>this.multiFrameNumber?this.debugFrameNumber=this.multiFrameNumber:this.update())}get multiFrameNumber$(){return this._multiFrameNumberSubject.asObservable()}get debugFrameNumber(){return this._debugFrameNumber}set debugFrameNumber(o){const r=g.clamp(isNaN(o)?0:o,0,this.multiFrameNumber);r!==this._debugFrameNumber&&(this._debugFrameNumber=r,this.debugFrameNumberNext(),l.logIf(r!==o,l.LogLevel.Debug,`debug-frame number adjusted to ${r}, given ${o}`),this.update(this.debugFrameNumber<this._frameNumber))}get debugFrameNumber$(){return this._debugFrameNumberSubject.asObservable()}set multiFrameDelay(o){const r=Math.max(0,o);r!==this._multiFrameDelay&&(this._multiFrameDelay=r)}get multiFrameDelay(){return this._multiFrameDelay}get frameNumber(){return this._frameNumber}get frameNumber$(){return this._frameNumberSubject.asObservable()}get intermediateFrameCount(){return this._intermediateFrameCount}get multiFrameCount(){return this._multiFrameCount}get averageFrameTime(){return this._frameNumber===0?0:this._multiFrameTime/this._frameNumber}get updateFrameTime(){return this._updateFrameTime}get minimumFrameTime(){return this._intermediateFrameTimes[0]}get maximumFrameTime(){return this._intermediateFrameTimes[1]}get multiFrameTime(){return this._frameNumber===0?0:this._multiTime[1]-this._multiTime[0]}get framesPerSecond(){return this._frameNumber===0?0:1e3/(this.multiFrameTime/this._frameNumber)}get postFrameEvent$(){return this._postFrameEventSubject.asObservable()}get postSwapEvent$(){return this._postSwapEventSubject.asObservable()}}c.Controller=v,v._debug=!1,function(p){(function(o){o[o.Frame=0]="Frame",o[o.MultiFrame=1]="MultiFrame"})(p.RequestType||(p.RequestType={}))}(v=c.Controller||(c.Controller={}))},2380:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CuboidGeometry=void 0;const d=_(3659),l=_(6404),g=_(4894);class v extends g.Geometry{constructor(o,r,n=!1,i=[1,1,1]){super(o,r),this._vertexLocation=0,this._extent=d.vec3.fromValues(1,1,1),this._uvCoordinates=!1,r=r!==void 0&&r!==""?r:this.constructor.name;const u=new l.Buffer(o,r+"VBO");this._buffers.push(u);const s=new l.Buffer(o,`${r}IndicesVBO`);this._buffers.push(s),this._extent=d.vec3.clone(i),this._uvCoordinates=n}bindBuffers(){this._uvCoordinates===!1?this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1):(this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,20,0,!0,!1),this._buffers[0].attribEnable(this._uvCoordLocation,2,this.context.gl.FLOAT,!1,20,12,!1,!1)),this._buffers[1].bind()}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0),this._uvCoordinates&&this._buffers[0].attribDisable(this._uvCoordLocation,!1,!0),this._buffers[1].unbind()}initialize(o=0,r=1){this._vertexLocation=o,this._uvCoordLocation=r;const n=this.context.gl,i=super.initialize([n.ARRAY_BUFFER,n.ELEMENT_ARRAY_BUFFER],[o,r]),u=this._uvCoordinates;let s=u?v.VERTICES_UV:v.VERTICES;return s=s.map((a,h)=>a*(u===!1?.5*this._extent[h%3]:h%5<3?.5*this._extent[h%5]:1)),this._buffers[0].data(s,n.STATIC_DRAW),this._buffers[1].data(u?v.INDICES_UV:v.INDICES,n.STATIC_DRAW),this._count=u?v.INDICES_UV.length:v.INDICES.length,i}draw(){const o=this.context.gl;o.drawElements(o.TRIANGLE_STRIP,this._count,o.UNSIGNED_BYTE,0)}get vertexLocation(){return this._vertexLocation}get uvCoordLocation(){return this._uvCoordLocation}get extent(){return this._extent}}c.CuboidGeometry=v,v.VERTICES=new Float32Array([-1,-1,1,1,-1,1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),v.INDICES=new Uint8Array([0,1,2,3,7,1,5,4,7,6,2,4,0,1]),v.VERTICES_UV=new Float32Array([-1,-1,1,0,0,1,-1,1,1,0,-1,1,1,0,1,1,1,1,1,1,-1,1,1,0,0,1,1,1,1,0,1,1,-1,1,1,1,1,1,0,1,1,-1,1,0,0,1,-1,-1,1,0,1,-1,1,1,1,-1,-1,-1,0,0,1,-1,-1,0,0,-1,-1,-1,1,0,1,1,-1,0,1,-1,1,-1,1,1,-1,1,-1,0,1,-1,1,1,1,1,-1,-1,1,1,0,-1,-1,1,0,1]),v.INDICES_UV=new Uint8Array([3,2,1,0,10,19,11,18,11,17,16,4,16,5,6,7,6,8,9,10,9,11,12,13,14,15])},7922:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GeosphereGeometry=void 0;const d=_(9696),l=_(6404),g=_(4894),v=_(7498);class p extends g.Geometry{constructor(r,n,i=1,u=!0){super(r,n),this._diameter=1,this._textured=!1,this._size=0,n=n!==void 0&&n!==""?n:this.constructor.name,this._diameter=i,this._textured=u;const s=new l.Buffer(r,n+"IndexBuffer");this._buffers.push(s);const a=new l.Buffer(r,n+"VBO");if(this._buffers.push(a),this._textured){const h=new l.Buffer(r,n+"UV");this._buffers.push(h)}}bindBuffers(){this._buffers[0].bind(),this._buffers[1].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._textured&&this._buffers[2].attribEnable(this._texCoordLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].unbind(),this._buffers[1].attribDisable(this._vertexLocation,!0,!0),this._textured&&this._buffers[2].attribDisable(this._texCoordLocation,!0,!0)}initialize(r=0,n=1){const i=this.context.gl;this._vertexLocation=r,this._texCoordLocation=n;const u=super.initialize([i.ELEMENT_ARRAY_BUFFER,i.ARRAY_BUFFER,i.ARRAY_BUFFER],[8,r,n]);d.assert(this._buffers[0]!==void 0&&this._buffers[0].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),d.assert(this._buffers[1]!==void 0&&this._buffers[1].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),this._textured&&d.assert(this._buffers[2]!==void 0&&this._buffers[2].object instanceof WebGLBuffer,"expected valid WebGLBuffer");const s=new v.Icosahedron;s.generateGeometry(3),this._textured&&s.generateTextureCoordinates();const a=s.faces,h=new Uint16Array(3*a.length);let b=0;for(const S of a)h[b+0]=S[0],h[b+1]=S[1],h[b+2]=S[2],b+=3;this._buffers[0].data(h,i.STATIC_DRAW),this._size=3*a.length;const m=s.vertices,M=new Float32Array(3*m.length);b=0;for(const S of m)M[b+0]=S[0]*this._diameter,M[b+1]=S[1]*this._diameter,M[b+2]=S[2]*this._diameter,b+=3;if(this._buffers[1].data(M,i.STATIC_DRAW),this._textured){const S=s.texcoords,w=new Float32Array(2*S.length);if(S&&S.length>0){b=0;for(const N of S)w[b+0]=N[0],w[b+1]=N[1],b+=2}this._buffers[2].data(w,i.STATIC_DRAW)}return u}draw(){const r=this.context.gl;r.drawElements(r.TRIANGLES,this._size,r.UNSIGNED_SHORT,0)}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}}c.GeosphereGeometry=p},7498:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Icosahedron=void 0;const d=_(3659),l=_(2111);c.Icosahedron=class{constructor(){}baseVertices(){const g=.5*(1+Math.sqrt(5)),v=1/Math.sqrt(g*g+1),p=g*v;return[d.vec3.fromValues(-v,+p,0),d.vec3.fromValues(+v,+p,0),d.vec3.fromValues(-v,-p,0),d.vec3.fromValues(+v,-p,0),d.vec3.fromValues(0,-v,+p),d.vec3.fromValues(0,+v,+p),d.vec3.fromValues(0,-v,-p),d.vec3.fromValues(0,+v,-p),d.vec3.fromValues(+p,0,-v),d.vec3.fromValues(+p,0,+v),d.vec3.fromValues(-p,0,-v),d.vec3.fromValues(-p,0,+v)]}baseFaces(){return[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]]}refine(g,v,p){const o=new Map;for(let r=0;r<p;r++){const n=v.length;for(let i=0;i<n;i++){const u=v[i],s=u[0],a=u[1],h=u[2],b=this.split(s,a,g,o),m=this.split(a,h,g,o),M=this.split(h,s,g,o);v[i]=[b,m,M],v.push([s,b,M]),v.push([a,m,b]),v.push([h,M,m])}}}split(g,v,p,o){const r=g<v,n=((r?g:v)<<16)+(r?v:g);if(o.has(n))return o.get(n);const i=d.vec3.add(l.v3(),p[g],p[v]);d.vec3.normalize(i,i),p.push(i);const u=p.length-1;return o.set(n,u),u}generateGeometry(g){this._vertices=this.baseVertices(),this._faces=this.baseFaces(),g>0&&this.refine(this._vertices,this._faces,Math.min(Math.max(g,0),8))}generateTextureCoordinates(){this._texcoords=new Array;for(const g of this._vertices){const v=d.vec3.normalize(l.v3(),g),p=d.vec2.fromValues(.5-Math.atan2(v[2],v[0])/(2*Math.PI),Math.asin(v[1])/Math.PI+.5);this._texcoords.push(p)}}get faces(){return this._faces}get vertices(){return this._vertices}get texcoords(){return this._texcoords}}},2194:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ResourceManager=c.PlaneGeometry=c.GeosphereGeometry=c.Icosahedron=c.CuboidGeometry=void 0;var d=_(2380);Object.defineProperty(c,"CuboidGeometry",{enumerable:!0,get:function(){return d.CuboidGeometry}});var l=_(7498);Object.defineProperty(c,"Icosahedron",{enumerable:!0,get:function(){return l.Icosahedron}});var g=_(7922);Object.defineProperty(c,"GeosphereGeometry",{enumerable:!0,get:function(){return g.GeosphereGeometry}});var v=_(4574);Object.defineProperty(c,"PlaneGeometry",{enumerable:!0,get:function(){return v.PlaneGeometry}});var p=_(9045);Object.defineProperty(c,"ResourceManager",{enumerable:!0,get:function(){return p.ResourceManager}})},4574:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PlaneGeometry=void 0;const d=_(3659),l=_(6404),g=_(4894);class v extends g.Geometry{constructor(o,r){super(o,r),this._vertexLocation=0,this._texCoordLocation=1,this._translation=d.vec3.fromValues(0,0,0),this._scale=d.vec3.fromValues(1,1,1),this._rotation=d.quat.create(),r=r!==void 0&&r!==""?r:this.constructor.name;const n=new l.Buffer(o,r+"VertexVBO"),i=new l.Buffer(o,r+"TexCoordVBO"),u=new l.Buffer(o,r+"IndexBuffer");this._buffers.push(n),this._buffers.push(i),this._buffers.push(u)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[1].attribEnable(this._texCoordLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[2].bind()}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0),this._buffers[1].attribDisable(this._texCoordLocation,!0,!0),this._buffers[2].unbind()}initialize(o=0,r=1){const n=this.context.gl;this._vertexLocation=o,this._texCoordLocation=r;const i=super.initialize([n.ARRAY_BUFFER,n.ARRAY_BUFFER,n.ELEMENT_ARRAY_BUFFER],[o,r,8]);return this._buffers[0].data(v.VERTICES,n.STATIC_DRAW),this._buffers[1].data(v.UV,n.STATIC_DRAW),this._buffers[2].data(v.INDICES,n.STATIC_DRAW),i}draw(){const o=this.context.gl;o.drawElements(o.TRIANGLE_STRIP,v.INDICES.length,o.UNSIGNED_BYTE,0)}set translation(o){this._translation=o}set scale(o){this._scale=d.vec3.fromValues(o[0],1,o[1])}set rotation(o){this._rotation=o}get transformation(){const o=d.mat4.create();return d.mat4.fromRotationTranslationScale(o,this._rotation,this._translation,this._scale)}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}}c.PlaneGeometry=v,v.VERTICES=new Float32Array([-1,0,-1,-1,0,1,1,0,-1,1,0,1]),v.UV=new Float32Array([-1,-1,-1,1,1,-1,1,1]),v.INDICES=new Uint8Array([0,1,2,3])},9045:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ResourceManager=void 0;const d=_(9696),l=_(6404),g=_(4894),v=_(9922),p=_(6942);c.ResourceManager=class{constructor(o){this._texture2Ds=new Map,this._materials=new Map,this._geometries=new Map,this._buffers=new Map,this._context=o}fetchTexture2D(o,r,n=!1){if(this._texture2Ds.has(o))return;const i=new p.Texture2D(this._context,o);return d.assert(i.identifier===o,"expected object identifier to be unchanged"),this._texture2Ds.set(o,i),i.fetch(r,n)}add(o,r){const n=new Array;if(o instanceof p.Texture2D){const i=o;for(const u of r)this._texture2Ds.has(u)||(this._texture2Ds.set(u,i),n.push(u))}if(o instanceof v.Material){const i=o;for(const u of r)this._materials.has(u)||(this._materials.set(u,i),n.push(u))}if(o instanceof g.Geometry){const i=o;for(const u of r)this._geometries.has(u)||(this._geometries.set(u,i),n.push(u))}if(o instanceof l.Buffer){const i=o;for(const u of r)this._buffers.has(u)||(this._buffers.set(u,i),n.push(u))}return n}get(o){return this._texture2Ds.has(o)?this._texture2Ds.get(o):this._materials.has(o)?this._materials.get(o):this._geometries.has(o)?this._geometries.get(o):this._buffers.has(o)?this._buffers.get(o):void 0}uninitialize(){for(const o of Array.from(this._geometries.values()))o.initialized&&o.uninitialize();this._geometries.clear();for(const o of Array.from(this._texture2Ds.values()))o.initialized&&o.uninitialize();this._texture2Ds.clear();for(const o of Array.from(this._buffers.values()))o.initialized&&o.uninitialize();this._buffers.clear(),this._materials.clear()}}},7491:function(x,c,_){var d=this&&this.__createBinding||(Object.create?function(r,n,i,u){u===void 0&&(u=i),Object.defineProperty(r,u,{enumerable:!0,get:function(){return n[i]}})}:function(r,n,i,u){u===void 0&&(u=i),r[u]=n[i]}),l=this&&this.__setModuleDefault||(Object.create?function(r,n){Object.defineProperty(r,"default",{enumerable:!0,value:n})}:function(r,n){r.default=n}),g=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(r!=null)for(var i in r)i!=="default"&&Object.prototype.hasOwnProperty.call(r,i)&&d(n,r,i);return l(n,r),n};Object.defineProperty(c,"__esModule",{value:!0}),c.debug=void 0;const v=g(_(1604)),p=g(_(493));var o;(o=c.debug||(c.debug={})).TestRenderer=p.TestRenderer,o.TestNavigation=v.TestNavigation},1604:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TestNavigation=void 0;const d=_(7595);c.TestNavigation=class{constructor(l,g){this._altered=!1,this._eventHandler=new d.EventHandler(l,g),this._eventHandler.pushMouseEnterHandler((v,p)=>this.onMouseEnter(v,p)),this._eventHandler.pushMouseLeaveHandler((v,p)=>this.onMouseLeave(v,p))}onMouseEnter(l,g){this._altered=!1}onMouseLeave(l,g){this._altered=!0}update(){this._eventHandler.update()}reset(){this._altered=!1}get altered(){return this._altered}}},493:(x,c,_)=>{const d=_(9696),l=_(3666),g=_(3411),v=_(4073),p=_(6786),o=_(9564),r=_(7570),n=_(4895),i=_(7540),u=_(3205),s=_(5263),a=_(6942),h=_(1604);var b;(function(m){class M extends u.Renderer{constructor(){super(...arguments),this._extensions=!1}onInitialize(w,N,F){const k=this._context.gl,X=this._context.gl2facade;this._extensions===!1&&this._context.isWebGL1&&(d.assert(this._context.supportsStandardDerivatives,"expected OES_standard_derivatives support"),this._context.standardDerivatives,this._extensions=!0);const $=new s.Shader(this._context,k.VERTEX_SHADER,"testrenderer.vert");$.initialize(_(354));const V=new s.Shader(this._context,k.FRAGMENT_SHADER,"testrenderer.frag");V.initialize(_(9587)),this._program=new n.Program(this._context),this._program.initialize([$,V]),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uFrameNumber=this._program.uniform("u_frameNumber"),this._ndcTriangle=new r.NdcFillingTriangle(this._context);const Y=this._program.attribute("a_vertex",0);return this._ndcTriangle.initialize(Y),this._ndcOffsetKernel=new g.AntiAliasingKernel(this._multiFrameNumber),this._defaultFBO=new p.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new a.Texture2D(this._context,"ColorRenderTexture"),this._depthRenderbuffer=new i.Renderbuffer(this._context,"DepthRenderbuffer"),this._intermediateFBO=new o.Framebuffer(this._context,"IntermediateFBO"),this._accumulate=new l.AccumulatePass(this._context),this._accumulate.initialize(this._ndcTriangle),this._accumulate.precision=this._framePrecision,this._accumulate.texture=this._colorRenderTexture,this._blit=new v.BlitPass(this._context),this._blit.initialize(this._ndcTriangle),this._blit.readBuffer=X.COLOR_ATTACHMENT0,this._blit.drawBuffer=k.BACK,this._blit.target=this._defaultFBO,this._testNavigation=new h.TestNavigation(()=>this.invalidate(),F),!0}onUninitialize(){super.uninitialize(),this._uNdcOffset=-1,this._uFrameNumber=-1,this._program.uninitialize(),this._ndcTriangle.uninitialize(),this._intermediateFBO.uninitialize(),this._defaultFBO.uninitialize(),this._colorRenderTexture.uninitialize(),this._depthRenderbuffer.uninitialize(),this._blit.uninitialize(),this._accumulate.uninitialize()}onDiscarded(){this._altered.alter("frameSize"),this._altered.alter("multiFrameNumber"),this._altered.alter("framePrecision"),this._altered.alter("clearColor")}onUpdate(){this._testNavigation.update();const w=this._testNavigation.altered;return this._testNavigation.reset(),!(!w&&!this._altered.any)&&w}onPrepare(){const w=this._context.gl,N=this._context.gl2facade;this._intermediateFBO.initialized?this._altered.frameSize&&this._intermediateFBO.resize(this._frameSize[0],this._frameSize[1]):(this._colorRenderTexture.initialize(this._frameSize[0],this._frameSize[1],this._context.isWebGL2?w.RGBA8:w.RGBA,w.RGBA,w.UNSIGNED_BYTE),this._depthRenderbuffer.initialize(this._frameSize[0],this._frameSize[1],w.DEPTH_COMPONENT16),this._intermediateFBO.initialize([[N.COLOR_ATTACHMENT0,this._colorRenderTexture],[w.DEPTH_ATTACHMENT,this._depthRenderbuffer]])),this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber),this._altered.framePrecision&&(this._accumulate.precision=this._framePrecision),this._altered.clearColor&&this._intermediateFBO.clearColor(this._clearColor),this._accumulate.update(),this._altered.reset()}onFrame(w){const N=this._context.gl;N.viewport(0,0,this._frameSize[0],this._frameSize[1]),this._program.bind();const F=this._ndcOffsetKernel.get(w);F[0]=2*F[0]/this._frameSize[0],F[1]=2*F[1]/this._frameSize[1],N.uniform2fv(this._uNdcOffset,F),N.uniform1i(this._uFrameNumber,w),this._intermediateFBO.clear(N.COLOR_BUFFER_BIT,!0,!1),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._intermediateFBO.unbind(),this._accumulate.frame(w)}onSwap(){this._blit.framebuffer=this._accumulate.framebuffer?this._accumulate.framebuffer:this._blit.framebuffer=this._intermediateFBO,this._blit.frame()}}m.TestRenderer=M})(b||(b={})),x.exports=b},26:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DebugPass=void 0;const d=_(9696),l=_(4895),g=_(5263),v=_(4073);class p extends v.BlitPass{constructor(){super(...arguments),this._debug=p.Mode.Depth,this._near=0,this._far=0}createProgram(){d.assert(this._program===void 0,"expected blit program to be undefined before its creation");const r=this._context.gl,n=new g.Shader(this._context,r.VERTEX_SHADER,"blit.vert (debug)");n.initialize(_(985));const i=new g.Shader(this._context,r.FRAGMENT_SHADER,"blit_debug.frag (debug)");return i.initialize(_(8356)),this._program=new l.Program(this._context,"DebugProgram"),this._program.initialize([n,i]),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uSrcBounds=this._program.uniform("u_srcBounds"),this._uDstBounds=this._program.uniform("u_dstBounds"),this._uNearest=this._program.uniform("u_nearest"),this._uDebugMode=this._program.uniform("u_mode"),this._uLinearize=this._program.uniform("u_linearize"),this._program.bind(),r.uniform1i(this._program.uniform("u_source"),0),r.uniform1i(this._uDebugMode,this._debug),this._program.unbind(),this._program.valid}initialize(r){const n=super.initialize(r);return this.enforceProgramBlit=!0,n&&this.createProgram()}uninitialize(){super.uninitialize(),this._uDebugMode=void 0,this._uLinearize=void 0}set debug(r){this.assertInitialized(),this._debug!==r&&(this._debug=r,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform1i(this._uDebugMode,this._debug),this._program.unbind()))}set near(r){this._near=r||0,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform2f(this._uLinearize,this._near,this._far),this._program.unbind())}set far(r){this._far=r||0,this._program!==void 0&&this._program.valid&&(this._program.bind(),this._context.gl.uniform2f(this._uLinearize,this._near,this._far),this._program.unbind())}}c.DebugPass=p,function(o){(function(r){r[r.None=0]="None",r[r.Depth=1]="Depth",r[r.DepthLinear=2]="DepthLinear",r[r.DepthPacked=3]="DepthPacked",r[r.DepthLinearPacked=4]="DepthLinearPacked"})(o.Mode||(o.Mode={}))}(p=c.DebugPass||(c.DebugPass={}))},6786:function(x,c,_){var d=this&&this.__decorate||function(o,r,n,i){var u,s=arguments.length,a=s<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(o,r,n,i);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(a=(s<3?u(a):s>3?u(r,n,a):u(r,n))||a);return s>3&&a&&Object.defineProperty(r,n,a),a};Object.defineProperty(c,"__esModule",{value:!0}),c.DefaultFramebuffer=void 0;const l=_(9696),g=_(9564),v=_(1030);class p extends g.Framebuffer{create(){return this._object=g.Framebuffer.DEFAULT_FRAMEBUFFER,this._valid=!0,this._clearColors=new Array(1),this._clearDepth=1,this._clearStencil=0,this.clear=this.es2Clear,this._object}delete(){this._object=void 0,this._valid=!1}hasAttachment(r){return!1}bind(r=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(r,this._object)}clearColor(r){super.clearColor(r)}resize(){l.assert(!1,"the default framebuffer cannot be resized directly")}get width(){return this.context.gl.canvas.width}get height(){return this.context.gl.canvas.height}}d([v.Initializable.assert_initialized()],p.prototype,"bind",null),c.DefaultFramebuffer=p},172:function(x,c,_){var d=this&&this.__decorate||function(s,a,h,b){var m,M=arguments.length,S=M<3?a:b===null?b=Object.getOwnPropertyDescriptor(a,h):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(s,a,h,b);else for(var w=s.length-1;w>=0;w--)(m=s[w])&&(S=(M<3?m(S):M>3?m(a,h,S):m(a,h))||S);return M>3&&S&&Object.defineProperty(a,h,S),S};Object.defineProperty(c,"__esModule",{value:!0}),c.EnvironmentTextureType=c.EnvironmentRenderingPass=void 0;const l=_(9696),g=_(1030),v=_(7570),p=_(4895),o=_(5263),r=_(6942),n=_(945);class i extends g.Initializable{constructor(a){super(),this._skipCubeLod=!1,this._altered=!0,this._context=a,this._cubeMapProgram=new p.Program(a,"CubemapEnvironmentProgram"),this._equiMapProgram=new p.Program(a,"EquimapEnvironmentProgram"),this._polarMapProgram=new p.Program(a,"PolarmapEnvironmentProgram"),this._sphereMapProgram=new p.Program(a,"SpheremapEnvironmentProgram"),this._ndcTriangle=new v.NdcFillingTriangle(this._context,"EnvironmentNdcTriangle")}initialize(){const a=this._context.gl;this._ndcTriangle.initialize();const h=new o.Shader(this._context,a.VERTEX_SHADER,"env-projections.vert");h.initialize(_(8170));const b=new o.Shader(this._context,a.FRAGMENT_SHADER,"env-projections.frag");b.initialize(_(4965),!1),b.replace("PROJECTION_TYPE","CUBE_MAP"),b.compile(),this._cubeMapProgram.initialize([h,b],!1),this._cubeMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._cubeMapProgram.link(),this._cubeMapProgram.bind(),a.uniform1i(this._cubeMapProgram.uniform("u_cubemap"),0),this._uSkipLod=this._cubeMapProgram.uniform("u_skipLod"),this._cubeMapProgram.unbind();const m=new o.Shader(this._context,a.FRAGMENT_SHADER,"env-projections.frag");m.initialize(_(4965),!1),m.replace("PROJECTION_TYPE","EQUI_MAP"),m.compile(),this._equiMapProgram.initialize([h,m],!1),this._equiMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._equiMapProgram.link(),this._equiMapProgram.bind(),a.uniform1i(this._equiMapProgram.uniform("u_equirectmap"),0),this._equiMapProgram.unbind();const M=new o.Shader(this._context,a.FRAGMENT_SHADER,"env-projections.frag");M.initialize(_(4965),!1),M.replace("PROJECTION_TYPE","SPHERE_MAP"),M.compile(),this._sphereMapProgram.initialize([h,M],!1),this._sphereMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._sphereMapProgram.link(),this._sphereMapProgram.bind(),a.uniform1i(this._sphereMapProgram.uniform("u_spheremap"),0),this._sphereMapProgram.unbind();const S=new o.Shader(this._context,a.FRAGMENT_SHADER,"env-projections.frag");return S.initialize(_(4965),!1),S.replace("PROJECTION_TYPE","POLAR_MAP"),S.compile(),this._polarMapProgram.initialize([h,S],!1),this._polarMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._polarMapProgram.link(),this._polarMapProgram.bind(),a.uniform1iv(this._polarMapProgram.uniform("u_polarmap"),[0,1]),this._polarMapProgram.unbind(),!0}uninitialize(){this._cubeMapProgram.uninitialize(),this._equiMapProgram.uninitialize(),this._sphereMapProgram.uninitialize(),this._polarMapProgram.uninitialize()}update(){if(this._altered===!1)return;const a=this._context.gl;this._cubeMapProgram.bind(),a.uniform1i(this._uSkipLod,this._skipCubeLod),this._altered=!1}frame(){const a=this._context.gl;l.assert(this._camera!==void 0,"Camera is undefined in environment rendering pass."),l.assert(this._environmentTexture!==void 0,"Environment texture is undefined in environment rendering pass.");let h=this._cubeMapProgram;this._envTextureType===u.EquirectangularMap?(l.assert(this._environmentTexture instanceof r.Texture2D,"Input texture expected to be Texture2D for equirectangular mapping."),this._environmentTexture.bind(a.TEXTURE0),h=this._equiMapProgram):this._envTextureType===u.SphereMap?(l.assert(this._environmentTexture instanceof r.Texture2D,"Input texture expected to be Texture2D for sphere mapping."),this._environmentTexture.bind(a.TEXTURE0),h=this._sphereMapProgram):this._envTextureType===u.CubeMap?(l.assert(this._environmentTexture instanceof n.TextureCube,"Input texture expected to be a TextureCube for cube mapping."),this._environmentTexture.bind(a.TEXTURE0),h=this._cubeMapProgram):this._envTextureType===u.PolarMap&&(l.assert(this._environmentTexture2!==void 0,"Two input textures expected for polar mapping."),l.assert(this._environmentTexture instanceof r.Texture2D,"Input texture expected to be a Texture2D for polar mapping."),l.assert(this._environmentTexture2 instanceof r.Texture2D,"Input texture expected to be a Texture2D for polar mapping."),this._environmentTexture.bind(a.TEXTURE0),this._environmentTexture2.bind(a.TEXTURE1),h=this._polarMapProgram),h.bind(),a.uniformMatrix4fv(h.uniform("u_viewProjectionInverse"),!1,this._camera.viewProjectionInverse),this._ndcTriangle.bind(),this._ndcTriangle.draw(),h.unbind()}set environmentTextureType(a){this._envTextureType=a}set environmentTexture(a){this._environmentTexture=a}set environmentTexture2(a){this._environmentTexture2=a}set camera(a){this._camera=a}set skipCubeLod(a){this._skipCubeLod!==a&&(this._skipCubeLod=a,this._altered=!0)}}var u;d([g.Initializable.initialize()],i.prototype,"initialize",null),d([g.Initializable.uninitialize()],i.prototype,"uninitialize",null),c.EnvironmentRenderingPass=i,function(s){s[s.CubeMap=0]="CubeMap",s[s.EquirectangularMap=1]="EquirectangularMap",s[s.SphereMap=2]="SphereMap",s[s.PolarMap=3]="PolarMap"}(u=c.EnvironmentTextureType||(c.EnvironmentTextureType={}))},7595:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.EventHandler=void 0;const d=_(3659),l=_(9696),g=_(5838),v=_(4841),p=_(8319),o=_(4052);c.EventHandler=class{constructor(r,n){this._subscriptions=new Array,this._latestMouseEventsByType=new Map,this._previousMouseEventsByType=new Map,this._mouseEventHandlerByType=new Map,this._latestTouchEventsByType=new Map,this._previousTouchEventsByType=new Map,this._touchEventHandlerByType=new Map,this._latestPointerEventsByType=new Map,this._previousPointerEventsByType=new Map,this._pointerEventHandlerByType=new Map,this._latestEyeGazeEventsByType=new Map,this._previousEyeGazeEventsByType=new Map,this._eyeGazeEventHandlerByType=new Map,this._invalidate=r,this._mouseEventProvider=n.mouseEventProvider,this._mouseEventProvider.preventDefault(v.MouseEventProvider.Type.Wheel),this._pointerEventProvider=n.pointerEventProvider,this._eyeGazeEventProvider=n.eyeGazeEventProvider}invalidate(r=!1){this._invalidate&&this._invalidate(r)}pushMouseEventHandler(r,n){if(this._mouseEventHandlerByType.has(r))return void this._mouseEventHandlerByType.get(r).push(n);this._mouseEventHandlerByType.set(r,new Array),this._previousMouseEventsByType.set(r,new Array);const i=new Array;this._latestMouseEventsByType.set(r,i),l.assert(this._mouseEventProvider!==void 0,"expected valid mouse event provider");const u=this._mouseEventProvider.observable(r);switch(r){case v.MouseEventProvider.Type.Wheel:default:this._subscriptions.push(u.subscribe(s=>{i.push(s),this.invalidate()}))}this._mouseEventHandlerByType.get(r).push(n)}invokeMouseEventHandler(r){const n=this._mouseEventHandlerByType.get(r);if(n===void 0||n.length===0)return;const i=this._latestMouseEventsByType.get(r);if(i.length===0)return;const u=this._previousMouseEventsByType.get(r);n.forEach(s=>s(i,u)),Object.assign(u,i),i.length=0}pushTouchEventHandler(r,n){if(this._touchEventHandlerByType.has(r))return void this._touchEventHandlerByType.get(r).push(n);this._touchEventHandlerByType.set(r,new Array),this._previousTouchEventsByType.set(r,new Array);const i=new Array;this._latestTouchEventsByType.set(r,i),l.assert(this._touchEventProvider!==void 0,"expected valid touch event provider");const u=this._touchEventProvider.observable(r);this._subscriptions.push(u.subscribe(s=>{i.push(s),this.invalidate()})),this._touchEventHandlerByType.get(r).push(n)}invokeTouchEventHandler(r){const n=this._touchEventHandlerByType.get(r);if(n===void 0||n.length===0)return;const i=this._latestTouchEventsByType.get(r);if(i.length===0)return;const u=this._previousTouchEventsByType.get(r);n.forEach(s=>s(i,u)),Object.assign(u,i),i.length=0}pushPointerEventHandler(r,n){if(this._pointerEventHandlerByType.has(r))return void this._pointerEventHandlerByType.get(r).push(n);this._pointerEventHandlerByType.set(r,new Array),this._previousPointerEventsByType.set(r,new Array);const i=new Array;this._latestPointerEventsByType.set(r,i),l.assert(this._pointerEventProvider!==void 0,"expected valid pointer event provider");const u=this._pointerEventProvider.observable(r);this._subscriptions.push(u.subscribe(s=>{i.push(s),this.invalidate()})),this._pointerEventHandlerByType.get(r).push(n)}invokePointerEventHandler(r){const n=this._pointerEventHandlerByType.get(r);if(n===void 0||n.length===0)return;const i=this._latestPointerEventsByType.get(r);if(i.length===0)return;const u=this._previousPointerEventsByType.get(r);n.forEach(s=>s(i,u)),Object.assign(u,i),i.length=0}pushEyeGazeEventHandler(r,n){if(this._eyeGazeEventHandlerByType.has(r))return void this._eyeGazeEventHandlerByType.get(r).push(n);this._eyeGazeEventHandlerByType.set(r,new Array),this._previousEyeGazeEventsByType.set(r,new Array);const i=new Array;this._latestEyeGazeEventsByType.set(r,i),l.assert(this._eyeGazeEventProvider!==void 0,"expected valid eye gaze event provider");const u=this._eyeGazeEventProvider.observable(r);this._subscriptions.push(u.subscribe(s=>{i.push(s),this.invalidate()})),this._eyeGazeEventHandlerByType.get(r).push(n)}invokeEyeGazeEventHandler(r){const n=this._eyeGazeEventHandlerByType.get(r);if(n===void 0||n.length===0)return;const i=this._latestEyeGazeEventsByType.get(r);if(i.length===0)return;const u=this._previousEyeGazeEventsByType.get(r);n.forEach(s=>s(i,u)),Object.assign(u,i),i.length=0}dispose(){this._latestMouseEventsByType.forEach(r=>r.length=0),this._previousMouseEventsByType.forEach(r=>r.length=0),this._latestTouchEventsByType.forEach(r=>r.length=0),this._previousTouchEventsByType.forEach(r=>r.length=0),this._latestPointerEventsByType.forEach(r=>r.length=0),this._previousPointerEventsByType.forEach(r=>r.length=0),this._previousEyeGazeEventsByType.forEach(r=>r.length=0),this._latestEyeGazeEventsByType.forEach(r=>r.length=0);for(const r of this._subscriptions)r.unsubscribe()}update(){this.invokeMouseEventHandler(v.MouseEventProvider.Type.Click),this.invokeMouseEventHandler(v.MouseEventProvider.Type.Enter),this.invokeMouseEventHandler(v.MouseEventProvider.Type.Leave),this.invokeMouseEventHandler(v.MouseEventProvider.Type.Down),this.invokeMouseEventHandler(v.MouseEventProvider.Type.Up),this.invokeMouseEventHandler(v.MouseEventProvider.Type.Move),this.invokeMouseEventHandler(v.MouseEventProvider.Type.Wheel),this.invokeTouchEventHandler(o.TouchEventProvider.Type.Start),this.invokeTouchEventHandler(o.TouchEventProvider.Type.End),this.invokeTouchEventHandler(o.TouchEventProvider.Type.Move),this.invokeTouchEventHandler(o.TouchEventProvider.Type.Cancel),this.invokePointerEventHandler(p.PointerEventProvider.Type.Move),this.invokePointerEventHandler(p.PointerEventProvider.Type.Down),this.invokePointerEventHandler(p.PointerEventProvider.Type.Enter),this.invokePointerEventHandler(p.PointerEventProvider.Type.Up),this.invokePointerEventHandler(p.PointerEventProvider.Type.Leave),this.invokePointerEventHandler(p.PointerEventProvider.Type.Cancel),this.invokeEyeGazeEventHandler(g.EyeGazeEventProvider.Type.EyeGazeData),this.invokeEyeGazeEventHandler(g.EyeGazeEventProvider.Type.NewServerMessage),this.invokeEyeGazeEventHandler(g.EyeGazeEventProvider.Type.ConnectionStatus),this.invokeEyeGazeEventHandler(g.EyeGazeEventProvider.Type.BinaryMessageParsingError)}offsets(r,n=!0){const i=new Array;let u=!1;if(r instanceof MouseEvent){const a=r;u=a.offsetX!==0&&a.offsetY!==0,i.push(u?d.vec2.fromValues(a.offsetX,a.offsetY):d.vec2.fromValues(a.clientX,a.clientY))}else if(r instanceof WheelEvent){const a=r;u=a.offsetX!==0&&a.offsetY!==0,i.push(u?d.vec2.fromValues(a.offsetX,a.offsetY):d.vec2.fromValues(a.clientX,a.clientY))}else if(r instanceof TouchEvent){const a=r;for(let h=0;h<a.touches.length;++h){const b=a.touches.item(h);i.push(d.vec2.fromValues(b.clientX,b.clientY))}}if(u){if(n)for(const a of i)d.vec2.scale(a,a,window.devicePixelRatio);return i}const s=(r.target||r.currentTarget||r.srcElement).getBoundingClientRect();for(const a of i)a[0]=Math.floor(a[0]-s.left),a[1]=Math.floor(a[1]-s.top),n&&d.vec2.scale(a,a,window.devicePixelRatio);return i}pushClickHandler(r){this.pushMouseEventHandler(v.MouseEventProvider.Type.Click,r)}pushMouseEnterHandler(r){this.pushMouseEventHandler(v.MouseEventProvider.Type.Enter,r)}pushMouseLeaveHandler(r){this.pushMouseEventHandler(v.MouseEventProvider.Type.Leave,r)}pushMouseDownHandler(r){this.pushMouseEventHandler(v.MouseEventProvider.Type.Down,r)}pushMouseUpHandler(r){this.pushMouseEventHandler(v.MouseEventProvider.Type.Up,r)}pushMouseMoveHandler(r){this.pushMouseEventHandler(v.MouseEventProvider.Type.Move,r)}pushMouseWheelHandler(r){this.pushMouseEventHandler(v.MouseEventProvider.Type.Wheel,r)}pushTouchStartHandler(r){this.pushTouchEventHandler(o.TouchEventProvider.Type.Start,r)}pushTouchEndHandler(r){this.pushTouchEventHandler(o.TouchEventProvider.Type.End,r)}pushTouchMoveHandler(r){this.pushTouchEventHandler(o.TouchEventProvider.Type.Move,r)}pushTouchCancelHandler(r){this.pushTouchEventHandler(o.TouchEventProvider.Type.Cancel,r)}pushPointerUpHandler(r){this.pushPointerEventHandler(p.PointerEventProvider.Type.Up,r)}pushPointerDownHandler(r){this.pushPointerEventHandler(p.PointerEventProvider.Type.Down,r)}pushPointerEnterHandler(r){this.pushPointerEventHandler(p.PointerEventProvider.Type.Enter,r)}pushPointerLeaveHandler(r){this.pushPointerEventHandler(p.PointerEventProvider.Type.Leave,r)}pushPointerMoveHandler(r){this.pushPointerEventHandler(p.PointerEventProvider.Type.Move,r)}pushPointerCancelHandler(r){this.pushPointerEventHandler(p.PointerEventProvider.Type.Cancel,r)}pushEyeGazeDataHandler(r){this.pushEyeGazeEventHandler(g.EyeGazeEventProvider.Type.EyeGazeData,r)}pushEyeGazeServerMessageHandler(r){this.pushEyeGazeEventHandler(g.EyeGazeEventProvider.Type.NewServerMessage,r)}pushEyeGazeConnectionStatusHandler(r){this.pushEyeGazeEventHandler(g.EyeGazeEventProvider.Type.ConnectionStatus,r)}pushEyeGazeBinaryMessageParsingErrorHandler(r){this.pushEyeGazeEventHandler(g.EyeGazeEventProvider.Type.BinaryMessageParsingError,r)}requestPointerLock(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!0)}exitPointerLock(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!1)}}},8600:x=>{var c;(function(_){_.WEBGL1_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"],_.WEBGL2_EXTENSIONS=["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","OES_texture_half_float_linear","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"],_.WEBGL2_DEFAULT_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_half_float","OES_vertex_array_object","WEBGL_depth_texture","WEBGL_draw_buffers"]})(c||(c={})),x.exports=c},9568:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ExtensionsHash=void 0;const d=_(9696),l=_(8600);class g{static encode64(p){return d.assert(p>=0&&p<=63,`expected bitfield in range [ 0b000000, 0b111111 ], given ${p}`),g.BASE64_ALPHABET[p]}static decode64(p){d.assert(p.length===1,`expected single base64 character, given '${p}'`);const o=g.BASE64_ALPHABET.indexOf(p);return d.assert(o>-1,`unknown base64 character, given '${p}'`),o}static encode(p,o){const r=g.LATEST_VERSION,n=g.EXTENSIONS_BY_VERSION.get(r),i=g.WEBGL_BACKENDS.indexOf(p);d.assert(i>-1,`expected valid backend ${g.WEBGL_BACKENDS}, given ${p} `);let u=g.encode64(r<<3|i+1);if(o.length===0)return u;let s=0;for(let a=0;a<n.length;++a)s|=o.indexOf(n[a])>-1?32>>a%6:0,a%6<5&&a<n.length-1||(u+=g.encode64(s),s=0);return u}static decode(p){const o=g.decode64(p[0]),r=o>>3,n=(7&o)-1;d.assert(n<g.WEBGL_BACKENDS.length,`expected valid backend index, given ${n}`);const i=g.WEBGL_BACKENDS[n];d.assert(g.EXTENSIONS_BY_VERSION.has(r),`expected valid hash version, given ${r}`);const u=g.EXTENSIONS_BY_VERSION.get(r),s=Math.ceil(u.length/6)+1;d.assert(p.length===s,`expected hash of version ${r} to have a length of ${s}, given ${p}`);const a=new Array;for(let h=1;h<p.length;++h){const b=g.decode64(p[h]),m=6*(h-1);32&b&&a.push(u[m+0]),16&b&&a.push(u[m+1]),8&b&&a.push(u[m+2]),4&b&&a.push(u[m+3]),2&b&&a.push(u[m+4]),1&b&&a.push(u[m+5])}return[i,a]}static complement(p,o){const r=g.WEBGL_BACKENDS.indexOf(p);return d.assert(r>-1,`expected valid backend ${g.WEBGL_BACKENDS}, given ${p} `),g.WEBGL_EXTENSIONS_BY_BACKEND.get(r).filter(n=>o.indexOf(n)<0)}}c.ExtensionsHash=g,g.WEBGL_BACKENDS=["webgl1","webgl2"],g.WEBGL_EXTENSIONS_BY_BACKEND=new Map([[0,l.WEBGL1_EXTENSIONS],[1,l.WEBGL2_EXTENSIONS]]),g.EXTENSIONS_BY_VERSION=new Map([[0,["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_shader_texture_lod","EXT_sRGB","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"]]]),g.LATEST_VERSION=0,g.BASE64_ALPHABET="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-+"},378:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.EyeGazeDataStreams=c.EyeGazeDataStream=c.EyeGazeEventTarget=void 0;const d=_(2497);class l extends EventTarget{}c.EyeGazeEventTarget=l;class g{constructor(){this._eyeGazeDataStreams=new v,this._eyeGazeEventTarget=new EventTarget}generateStreamConfigByte(){const o=Uint8Array.from([0]);return this._eyeGazeDataStreams.gazePosition&&(o[0]=1|o[0]),this._eyeGazeDataStreams.gazeOrigin&&(o[0]=2|o[0]),this._eyeGazeDataStreams.eyePositionNormalized&&(o[0]=4|o[0]),this._eyeGazeDataStreams.headPositionAndRotation&&(o[0]=8|o[0]),this._eyeGazeDataStreams.userPresence&&(o[0]=16|o[0]),o}performHandshake(){this._eyeGazeDataStreams.recalculateNumberOfFloats();const o=this.generateStreamConfigByte();this._webSocket.send(o)}parseEyeTrackingData(o){if(o.length<this._eyeGazeDataStreams.expectedNumberOfFloats)return new CustomEvent(g.BINARY_MESSAGE_PARSING_ERROR);let r=0;const n=new d.EyeGazeData;return this._eyeGazeDataStreams.gazePosition&&(n.gazePositionXY[0]=o[r++],n.gazePositionXY[1]=o[r++]),this._eyeGazeDataStreams.gazeOrigin&&(n.gazeOriginRightXYZ[0]=o[r++],n.gazeOriginRightXYZ[1]=o[r++],n.gazeOriginRightXYZ[2]=o[r++],n.gazeOriginLeftXYZ[0]=o[r++],n.gazeOriginLeftXYZ[1]=o[r++],n.gazeOriginLeftXYZ[2]=o[r++]),this._eyeGazeDataStreams.eyePositionNormalized&&(n.eyePositionRightNormalizedXYZ[0]=o[r++],n.eyePositionRightNormalizedXYZ[1]=o[r++],n.eyePositionRightNormalizedXYZ[2]=o[r++],n.eyePositionLeftNormalizedXYZ[0]=o[r++],n.eyePositionLeftNormalizedXYZ[1]=o[r++],n.eyePositionLeftNormalizedXYZ[2]=o[r++]),this._eyeGazeDataStreams.headPositionAndRotation&&(n.headPositionXYZ[0]=o[r++],n.headPositionXYZ[1]=o[r++],n.headPositionXYZ[2]=o[r++],n.headRotationXYZ[0]=o[r++],n.headRotationXYZ[1]=o[r++],n.headRotationXYZ[2]=o[r++]),this._eyeGazeDataStreams.userPresence&&(n.userPresence=o[r]!==0),new CustomEvent(g.EYE_GAZE_DATA,{detail:{eyeGazeData:n}})}onOpen(o){this.dispatchEvent(new CustomEvent(g.CONNECTION_STATUS,{detail:{message:g.SUCCESSFULLY_CONNECTED_TO_SERVER,event:o}})),this.performHandshake()}onClose(o){this.dispatchEvent(new CustomEvent(g.CONNECTION_STATUS,{detail:{message:g.DISCONNECTED_TO_SERVER,event:o}}))}onError(o){this.dispatchEvent(new CustomEvent(g.CONNECTION_STATUS,{detail:{message:g.CONNECTION_ERROR,event:o}}))}async onMessage(o){if(typeof o.data!="string"){const r=await o.data.arrayBuffer(),n=new Float32Array(r);this.dispatchEvent(this.parseEyeTrackingData(n))}else this.dispatchEvent(new CustomEvent(g.NEW_SERVER_MESSAGE,{detail:{message:o.data}}))}connect(o){this._webSocket=new WebSocket(o),this._webSocket.onopen=r=>{this.onOpen(r)},this._webSocket.onclose=r=>{this.onClose(r)},this._webSocket.onerror=r=>{this.onError(r)},this._webSocket.onmessage=r=>{this.onMessage(r)}}addEventListener(o,r,n){this._eyeGazeEventTarget.addEventListener(o,r||null,n)}dispatchEvent(o){return this._eyeGazeEventTarget.dispatchEvent(o)}removeEventListener(o,r,n){this._eyeGazeEventTarget.removeEventListener(o,r||null,n)}get connectionState(){return this._webSocket.readyState}get eyeGazeDataStreams(){return this._eyeGazeDataStreams}set eyeGazeDataStreams(o){this._eyeGazeDataStreams!==o&&(this._eyeGazeDataStreams=o)}}c.EyeGazeDataStream=g,g.EYE_GAZE_DATA="eyegazedata",g.NEW_SERVER_MESSAGE="newservermessage",g.CONNECTION_STATUS="connectionstatus",g.BINARY_MESSAGE_PARSING_ERROR="binarymessageparsingerror",g.SUCCESSFULLY_CONNECTED_TO_SERVER="successfully connected to server",g.DISCONNECTED_TO_SERVER="disconnected to server",g.CONNECTION_ERROR="connection error with server";class v{constructor(){this.gazePosition=!1,this.gazeOrigin=!1,this.eyePositionNormalized=!1,this.headPositionAndRotation=!1,this.userPresence=!1,this.expectedNumberOfFloats=0}recalculateNumberOfFloats(){let o=0;this.gazePosition&&(o+=2),this.gazeOrigin&&(o+=6),this.eyePositionNormalized&&(o+=6),this.headPositionAndRotation&&(o+=6),this.userPresence&&(o+=1),this.expectedNumberOfFloats=o}}c.EyeGazeDataStreams=v},2497:(x,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.EyeGazeData=void 0,c.EyeGazeData=class{constructor(){this.gazePositionXY=[0,0],this.gazeOriginRightXYZ=[0,0,0],this.gazeOriginLeftXYZ=[0,0,0],this.eyePositionRightNormalizedXYZ=[0,0,0],this.eyePositionLeftNormalizedXYZ=[0,0,0],this.headPositionXYZ=[0,0,0],this.headRotationXYZ=[0,0,0],this.userPresence=!1}toString(){let _="";return _+=`Gaze Position: ${this.gazePositionXY}
`,_+=`Gaze Origin Right: ${this.gazeOriginRightXYZ}
`,_+=`Gaze Origin Left: ${this.gazeOriginLeftXYZ}
`,_+=`Eye Position Normalized Right: ${this.eyePositionRightNormalizedXYZ}
`,_+=`Eye Position Normalized Left: ${this.eyePositionLeftNormalizedXYZ}
`,_+=`Head Position: ${this.headPositionXYZ}
`,_+=`Head Rotation: ${this.headRotationXYZ}
`,_+=`User Presence: ${this.userPresence}
`,_}}},5838:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.EyeGazeEventProvider=void 0;const d=_(7318),l=_(9696),g=_(378);class v{constructor(o,r){l.assert(o!==void 0,`expected a valid eye gaze data streams object on initialization, given ${o}.`),this._eyeGazeDataStream=new g.EyeGazeDataStream,this._eyeGazeDataStream.eyeGazeDataStreams=o,this._eyeGazeDataStream.connect(r)}preventDefaultOnEvent(o,r){l.bitInBitfield(this._preventDefaultMask,o)&&r.preventDefault()}allowDefault(...o){for(const r of o)l.bitInBitfield(this._preventDefaultMask,r)&&(this._preventDefaultMask&=~r)}preventDefault(...o){for(const r of o)l.bitInBitfield(this._preventDefaultMask,r)||(this._preventDefaultMask|=r)}observable(o){switch(o){case v.Type.EyeGazeData:return this.EyeGazeData$;case v.Type.NewServerMessage:return this.NewServerMessage$;case v.Type.ConnectionStatus:return this.ConnectionStatus$;case v.Type.BinaryMessageParsingError:return this.BinaryMessageParsingError$;default:return}}get EyeGazeData$(){return this._eyeGazeDataSubject===void 0&&(this._eyeGazeDataSubject=new d.ReplaySubject(void 0,this._timeframe),this._eyeGazeDataListener=o=>{this.preventDefaultOnEvent(v.Type.EyeGazeData,o),this._eyeGazeDataSubject.next(o)},this._eyeGazeDataStream.addEventListener(g.EyeGazeDataStream.EYE_GAZE_DATA,this._eyeGazeDataListener)),this._eyeGazeDataSubject.asObservable()}get NewServerMessage$(){return this._newServerMessageSubject===void 0&&(this._newServerMessageSubject=new d.ReplaySubject(void 0,this._timeframe),this._newServerMessageListener=o=>{this.preventDefaultOnEvent(v.Type.NewServerMessage,o),this._newServerMessageSubject.next(o)},this._eyeGazeDataStream.addEventListener(g.EyeGazeDataStream.NEW_SERVER_MESSAGE,this._newServerMessageListener)),this._newServerMessageSubject.asObservable()}get ConnectionStatus$(){return this._connectionStatusSubject===void 0&&(this._connectionStatusSubject=new d.ReplaySubject(void 0,this._timeframe),this._connectionStatusListener=o=>{this.preventDefaultOnEvent(v.Type.ConnectionStatus,o),this._connectionStatusSubject.next(o)},this._eyeGazeDataStream.addEventListener(g.EyeGazeDataStream.CONNECTION_STATUS,this._connectionStatusListener)),this._connectionStatusSubject.asObservable()}get BinaryMessageParsingError$(){return this._binaryMessageParsingErrorSubject===void 0&&(this._binaryMessageParsingErrorSubject=new d.ReplaySubject(void 0,this._timeframe),this._binaryMessageParsingErrorListener=o=>{this.preventDefaultOnEvent(v.Type.BinaryMessageParsingError,o),this._binaryMessageParsingErrorSubject.next(o)},this._eyeGazeDataStream.addEventListener(g.EyeGazeDataStream.BINARY_MESSAGE_PARSING_ERROR,this._binaryMessageParsingErrorListener)),this._eyeGazeDataSubject.asObservable()}}c.EyeGazeEventProvider=v,function(p){(function(o){o[o.EyeGazeData=1]="EyeGazeData",o[o.NewServerMessage=2]="NewServerMessage",o[o.ConnectionStatus=4]="ConnectionStatus",o[o.BinaryMessageParsingError=8]="BinaryMessageParsingError"})(p.Type||(p.Type={}))}(v=c.EyeGazeEventProvider||(c.EyeGazeEventProvider={}))},6869:(x,c,_)=>{const d=_(3607);var l;(function(g){const v=(p,o)=>`fetching '${p}' failed (${o.status}): ${o.statusText}`;g.fetchAsync=function(p,o){return new Promise((r,n)=>{const i=new XMLHttpRequest;i.open("GET",p,!0),i.responseType=o,i.onload=()=>{i.status<200||i.status>=300?n(v(p,i)):r(i.response)},i.onerror=()=>n(v(p,i)),i.ontimeout=()=>n(v(p,i)),i.send()})},g.fetchJsonAsync=function(p,o,r){return new Promise((n,i)=>{const u=new XMLHttpRequest;u.open("GET",p,!0),u.onload=()=>{if(u.status<200||u.status>=300)return void i(v(p,u));const s=u.responseText;if(r!==void 0&&!d.validate(s,r))return;let a;try{a=JSON.parse(s)}catch(b){return void i(`fetching '${p}' failed (${b.name}): ${b.message}`)}const h=o(a);h!==void 0?n(h):i(`fetching '${p}' failed (TransformError): transforming the object failed.`)},u.onerror=()=>i(v(p,u)),u.ontimeout=()=>i(v(p,u)),u.send()})}})(l||(l={})),x.exports=l},9870:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FirstPersonModifier=void 0;const d=_(3659),l=_(2111),g=_(6491);class v extends g.CameraModifier{constructor(){super(...arguments),this._rotation=d.mat4.create(),this._sensitivity=v.DEFAULT_SENSITIVITY}initiate(o){Object.assign(this._reference,this._camera),this._initialPoint=o}process(o,r){this._currentPoint=o;const n=d.vec2.create();r===void 0?d.vec2.subtract(n,this._initialPoint,this._currentPoint):d.vec2.copy(n,r),d.vec2.scale(n,n,window.devicePixelRatio*this._sensitivity),d.vec2.copy(this._initialPoint,this._currentPoint);const i=d.vec3.sub(l.v3(),this._reference.eye,this._reference.center);d.vec3.normalize(i,i);const u=d.vec3.cross(l.v3(),i,this._reference.up),s=d.mat4.fromRotation(l.m4(),-n[0],this._reference.up),a=d.mat4.fromRotation(l.m4(),n[1],u);d.mat4.mul(this._rotation,a,s),this.update()}update(){if(this._camera===void 0)return;const o=d.mat4.fromTranslation(l.m4(),this._reference.eye);d.mat4.multiply(o,o,this._rotation),d.mat4.translate(o,o,d.vec3.negate(l.v3(),this._reference.eye));const r=d.vec3.transformMat4(l.v3(),this._reference.center,o);this._camera.center=r,Object.assign(this._reference,this._camera)}set sensitivity(o){this._sensitivity=o}get sensitivity(){return this._sensitivity}}c.FirstPersonModifier=v,v.DEFAULT_SENSITIVITY=8e-4},423:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.byteSizeOfFormat=void 0;const d=_(9696);let l;const g=new Map;c.byteSizeOfFormat=function(v,p){const o=v.gl;if(p===void 0)return d.assert(!1,"expected given format to be defined"),0;if(function(n,i){const u=n.gl,s=n.gl2facade;if(i===void 0)return!1;if(l===void 0){const a=n.supportsDepthTexture?n.depthTexture.UNSIGNED_INT_24_8_WEBGL:void 0;l=new Array(u.UNSIGNED_BYTE,u.UNSIGNED_SHORT_5_6_5,u.UNSIGNED_SHORT_4_4_4_4,u.UNSIGNED_SHORT_5_5_5_1,u.UNSIGNED_SHORT,u.UNSIGNED_INT,a,u.FLOAT,s.HALF_FLOAT,u.BYTE,u.SHORT,u.INT,u.HALF_FLOAT,u.UNSIGNED_INT_2_10_10_10_REV,u.UNSIGNED_INT_10F_11F_11F_REV,u.UNSIGNED_INT_5_9_9_9_REV,u.UNSIGNED_INT_24_8,u.FLOAT_32_UNSIGNED_INT_24_8_REV)}return l.indexOf(i)>-1}(v,p))return d.assert(!1,`expected format instead of type ${p}`),0;if(p===o.DEPTH_COMPONENT||p===o.DEPTH_STENCIL)return d.assert(!1,"byte size of DEPTH_COMPONENT or DEPTH_STENCIL formats depends on active render buffer"),0;const r=function(n){if(g.has(n))return g.get(n);const i=n.gl,u=new Map([[i.ALPHA,1],[i.LUMINANCE,1],[i.R8,1],[i.R8I,1],[i.R8UI,1],[i.STENCIL_INDEX8,1],[i.DEPTH_COMPONENT16,2],[i.LUMINANCE_ALPHA,2],[i.R16F,2],[i.R16I,2],[i.R16UI,2],[i.RG8,2],[i.RG8I,2],[i.RG8UI,2],[i.RGB565,2],[i.RGB5_A1,2],[i.RGBA4,2],[i.DEPTH_COMPONENT24,3],[i.RGB,3],[i.RGB8,3],[i.RGB8UI,3],[i.SRGB,3],[i.SRGB8,3],[i.DEPTH24_STENCIL8,4],[i.DEPTH_COMPONENT32F,4],[i.R11F_G11F_B10F,4],[i.R32F,4],[i.R32I,4],[i.R32UI,4],[i.RG16F,4],[i.RG16I,4],[i.RG16UI,4],[i.RGB10_A2,4],[i.RGB10_A2UI,4],[i.RGB9_E5,4],[i.RGBA,4],[i.RGBA8,4],[i.RGBA8I,4],[i.RGBA8UI,4],[i.SRGB8_ALPHA8,4],[i.SRGB_ALPHA,4],[i.SRGB_ALPHA8,4],[i.SRGB_APLHA8,4],[i.DEPTH32F_STENCIL8,5],[i.RGB16F,6],[i.RG32F,8],[i.RG32I,8],[i.RG32UI,8],[i.RGBA16F,8],[i.RGBA16I,8],[i.RGBA16UI,8],[i.RGB32F,12],[i.RGBA32F,16],[i.RGBA32I,16],[i.RGBA32UI,16]]);return n.isWebGL1&&n.supportsSRGB&&(u.set(n.sRGB.SRGB_EXT,3),u.set(n.sRGB.SRGB_ALPHA_EXT,4),u.set(n.sRGB.SRGB8_ALPHA8_EXT,4)),n.supportsColorBufferFloat&&(u.set(n.colorBufferFloat.RGB32F_EXT,12),u.set(n.colorBufferFloat.RGBA32F_EXT,16)),g.set(n,u),u}(v).get(p);return d.assert(r!==void 0,`size of format ${p} is unknown`),r||0}},9564:function(x,c,_){var d=this&&this.__decorate||function(n,i,u,s){var a,h=arguments.length,b=h<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,u):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(n,i,u,s);else for(var m=n.length-1;m>=0;m--)(a=n[m])&&(b=(h<3?a(b):h>3?a(i,u,b):a(i,u))||b);return h>3&&b&&Object.defineProperty(i,u,b),b};Object.defineProperty(c,"__esModule",{value:!0}),c.Framebuffer=void 0;const l=_(9696),g=_(1030),v=_(2281),p=_(7540),o=_(6942);class r extends v.AbstractObject{constructor(){super(...arguments),this._buffersByAttachment=new Map,this._texturesByAttachment=new Map,this._colorClearQueue=new Array,this._drawBuffers=new Array,this._drawBuffersChanged=!1}static statusString(i,u){const s=i.gl;switch(u){case s.FRAMEBUFFER_COMPLETE:return"the framebuffer is ready to display (COMPLETE)";case s.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"the attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete (INCOMPLETE_ATTACHMENT)";case s.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"there is no attachment (INCOMPLETE_MISSING_ATTACHMENT)";case s.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"height and width of the attachment are not the same (INCOMPLETE_DIMENSIONS)";case s.FRAMEBUFFER_UNSUPPORTED:return"the format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer (UNSUPPORTED)";case s.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return"the values of gl.RENDERBUFFER_SAMPLES are different among attached renderbuffers, or are non-zero if the attached images are a mix of renderbuffers and textures (INCOMPLETE_MULTISAMPLE)";default:return l.assert(!1,`expected known framebuffer status, given ${u}`),""}}create(i){const u=this._context.gl,s=this.context.gl2facade;this._object=u.createFramebuffer(),this._clearColors=new Array(s.COLOR_ATTACHMENT_MAX-s.COLOR_ATTACHMENT0),this._clearDepth=1,this._clearStencil=0,this.clear=this.context.isWebGL1?this.es2Clear:this.es3Clear;for(const h of i){const b=h[0],m=h[1];if(m instanceof p.Renderbuffer?this._buffersByAttachment.set(b,m):m instanceof o.Texture2D&&this._texturesByAttachment.set(b,m),b<s.COLOR_ATTACHMENT_MIN||b>s.COLOR_ATTACHMENT_MAX)continue;this._drawBuffers.push(b);const M=b-u.COLOR_ATTACHMENT0;this._colorClearQueue.push(M),this._clearColors[M]=[0,0,0,0]}this._drawBuffersChanged=!0,u.bindFramebuffer(u.FRAMEBUFFER,this._object),this._buffersByAttachment.forEach((h,b)=>{u.framebufferRenderbuffer(u.FRAMEBUFFER,b,u.RENDERBUFFER,h.object)}),this._texturesByAttachment.forEach((h,b)=>{u.framebufferTexture2D(u.FRAMEBUFFER,b,u.TEXTURE_2D,h.object,0)}),s.drawBuffers&&s.drawBuffers(this._drawBuffers);const a=u.checkFramebufferStatus(u.FRAMEBUFFER);return this._valid=u.isFramebuffer(this._object)&&a===u.FRAMEBUFFER_COMPLETE,l.logIf(!this._valid,l.LogLevel.Warning,r.statusString(this.context,a)),u.bindFramebuffer(u.FRAMEBUFFER,r.DEFAULT_FRAMEBUFFER),this._object}delete(){l.assert(this._object instanceof WebGLFramebuffer,"expected WebGLFramebuffer object"),this.context.gl.deleteFramebuffer(this._object),this._object=void 0,this._valid=!1}es2Clear(i,u=!0,s=!0){const a=this.context.gl,h=l.bitInBitfield(i,a.DEPTH_BUFFER_BIT),b=l.bitInBitfield(i,a.STENCIL_BUFFER_BIT),m=l.bitInBitfield(i,a.COLOR_BUFFER_BIT);if(m||h||b){if(u&&this.bind(),m&&this._clearColors[0]!==void 0){const M=this._clearColors[0];a.clearColor(M[0],M[1],M[2],M[3])}h&&this._clearDepth!==void 0&&a.clearDepth(this._clearDepth),b&&this._clearStencil!==void 0&&a.clearStencil(this._clearStencil),a.clear(i),s&&this.unbind()}}es3Clear(i,u=!0,s=!0,a){const h=this.context.gl,b=l.bitInBitfield(i,h.DEPTH_BUFFER_BIT),m=l.bitInBitfield(i,h.STENCIL_BUFFER_BIT),M=l.bitInBitfield(i,h.COLOR_BUFFER_BIT);if(M||b||m){if(u&&this.bind(),M){if(window.chrome&&(window.chrome.webstore||window.chrome.runtime)){const S=this._clearColors[0]?this._clearColors[0]:[0,0,0,1];h.clearColor(S[0],S[1],S[2],S[3]),h.clear(h.COLOR_BUFFER_BIT)}for(const S of a||this._colorClearQueue)h.clearBufferfv(h.COLOR,S,this._clearColors[S])}b&&m?(h.clearStencil(this._clearStencil),h.clearDepth(this._clearDepth),h.clear(h.STENCIL_BUFFER_BIT|h.DEPTH_BUFFER_BIT)):b?h.clearBufferfv(h.DEPTH,0,[this._clearDepth]):m&&(h.clearStencil(this._clearStencil),h.clear(h.STENCIL_BUFFER_BIT)),s&&this.unbind()}}hasAttachment(i){return this._texturesByAttachment.has(i)||this._buffersByAttachment.has(i)}bind(i=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(i,this._object),this._drawBuffersChanged&&this.context.gl2facade.drawBuffers&&(this.context.gl2facade.drawBuffers(this._drawBuffers),this._drawBuffersChanged=!1)}unbind(i=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(i,r.DEFAULT_FRAMEBUFFER)}clearColor(i,u){l.assert(u===void 0||u===0||this.context.isWebGL2||this.context.supportsDrawBuffers,"WebGL2 context expected for clearing multiple color attachments.");const s=i[3]<1&&!this.context.alpha;l.logIf(s,l.LogLevel.Warning,"context has alpha disabled, clear color alpha is ignored");const a=[i[0],i[1],i[2],s?1:i[3]];if(this.context.premultipliedAlpha&&!s&&(a[0]*=a[3],a[1]*=a[3],a[2]*=a[3]),u!==void 0)this._clearColors[u]=a;else for(let h=0;h<this._clearColors.length;++h)this._clearColors[h]=a}clearDepth(i){this._clearDepth=i}clearStencil(i){this._clearStencil=i}texture(i){return this._texturesByAttachment.get(i)}resize(i,u,s=!0,a=!0){this._buffersByAttachment.forEach(h=>{h.resize(i,u,s,a)}),this._texturesByAttachment.forEach(h=>{h.resize(i,u,s,a)})}get width(){this.assertInitialized();let i=NaN;return this._buffersByAttachment.forEach(u=>{(isNaN(i)||u.width<i)&&(i=u.width)}),this._texturesByAttachment.forEach(u=>{(isNaN(i)||u.width<i)&&(i=u.width)}),i}get height(){this.assertInitialized();let i=NaN;return this._buffersByAttachment.forEach(u=>{(isNaN(i)||u.height<i)&&(i=u.height)}),this._texturesByAttachment.forEach(u=>{(isNaN(i)||u.height<i)&&(i=u.height)}),i}get size(){return[this.width,this.height]}set drawBuffers(i){this.assertInitialized();const u=this.context.gl2facade;for(const s of i)l.assert(this.hasAttachment(s),`valid attachment expected for draw buffer, given ${s}`),l.assert(s>=u.COLOR_ATTACHMENT_MIN&&s<=u.COLOR_ATTACHMENT_MAX,`color attachment expected for draw buffer, given ${s}`),this._drawBuffersChanged=this._drawBuffersChanged||this._drawBuffers.indexOf(s)===-1;this._drawBuffersChanged=this._drawBuffersChanged||i.length!==this._drawBuffers.length,this._drawBuffersChanged&&(this._drawBuffers=i)}get drawBuffers(){return this.assertInitialized(),this._drawBuffers}}r.DEFAULT_FRAMEBUFFER=void 0,d([g.Initializable.assert_initialized()],r.prototype,"es2Clear",null),d([g.Initializable.assert_initialized()],r.prototype,"es3Clear",null),d([g.Initializable.assert_initialized()],r.prototype,"bind",null),d([g.Initializable.assert_initialized()],r.prototype,"unbind",null),d([g.Initializable.assert_initialized()],r.prototype,"clearColor",null),d([g.Initializable.assert_initialized()],r.prototype,"clearDepth",null),d([g.Initializable.assert_initialized()],r.prototype,"clearStencil",null),d([g.Initializable.assert_initialized()],r.prototype,"texture",null),d([g.Initializable.assert_initialized()],r.prototype,"resize",null),c.Framebuffer=r},9544:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FrameCapture=void 0;const d=_(9696),l=_(9564),g=_(6786);class v{static createDataURL(o,r,n){const i=document.createElement("canvas"),u=i.getContext("2d");return i.width=o.width,i.height=o.height,u.putImageData(o,0,0),i.toDataURL(r,n)}static captureDefaultFramebuffer(o,r,n){const i=o.context.gl;o.bind(),i.readPixels(r.x,r.y,r.width,r.height,i.RGBA,i.UNSIGNED_BYTE,n),o.unbind()}static captureFramebuffer(o,r,n,i){const u=o.context.gl,s=o.texture(r);if(d.assert(s!==void 0,`Framebuffer does not have given attachment ${r}.`),d.assert(s.format===u.RGBA,`Unsupported texture format ${s.format}.`),d.assert(s.type===u.UNSIGNED_BYTE||s.type===u.FLOAT||s.type===u.HALF_FLOAT,`Unsupported texture type ${s.type}.`),u.readBuffer(r),s.type===u.FLOAT||s.type===u.HALF_FLOAT){const a=new Float32Array(n.width*n.height*4);u.readPixels(n.x,n.y,n.width,n.height,u.RGBA,u.FLOAT,a),a.forEach((h,b)=>{i[b]=255*h})}else s.type===u.UNSIGNED_BYTE&&u.readPixels(n.x,n.y,n.width,n.height,u.RGBA,u.UNSIGNED_BYTE,i)}static flipImageDataVertically(o){const r=o.height,n=o.data.length/r,i=Math.floor(r/2);for(let u=0;u<i;++u){const s=o.data.slice(u*n,(u+1)*n);o.data.copyWithin(u*n,(r-u-1)*n,(r-u)*n),o.data.set(s,(r-u-1)*n)}}static capture(o,r,n){const i=o.context.gl,u=o.size;n===void 0&&(n={x:0,y:0,width:u[0],height:u[1]}),r===void 0&&(r=i.COLOR_ATTACHMENT0);const s=new ImageData(n.width,n.height),a=new Uint8Array(s.data.buffer);return o.bind(i.READ_FRAMEBUFFER),o instanceof g.DefaultFramebuffer?v.captureDefaultFramebuffer(o,n,a):o instanceof l.Framebuffer&&v.captureFramebuffer(o,r,n,a),o.unbind(i.READ_FRAMEBUFFER),v.flipImageDataVertically(s),s}}c.FrameCapture=v},5714:function(x,c,_){var d=this&&this.__decorate||function(u,s,a,h){var b,m=arguments.length,M=m<3?s:h===null?h=Object.getOwnPropertyDescriptor(s,a):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(u,s,a,h);else for(var S=u.length-1;S>=0;S--)(b=u[S])&&(M=(m<3?b(M):m>3?b(s,a,M):b(s,a))||M);return m>3&&M&&Object.defineProperty(s,a,M),M};Object.defineProperty(c,"__esModule",{value:!0}),c.GaussFilter=void 0;const l=_(3659),g=_(9696),v=_(2111),p=_(1030),o=_(7570),r=_(4895),n=_(5263);class i extends p.Initializable{constructor(s){super(),this._kernelSize=7,this._standardDeviation=1,this._redistribute=!0,this._ndcTriangleShared=!1,this._context=s}recalculateWeights(){if(this._weights)return!1;const s=1/Math.sqrt(2*Math.PI)*this._standardDeviation,a=2*this._standardDeviation*this._standardDeviation;this._weights=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let h=0;for(let b=0;b<=Math.floor(this._kernelSize/2);b++)this._weights[b]=s*Math.pow(Math.E,-Math.pow(b,2)/a),h+=b>0?2*this._weights[b]:this._weights[b];if(this._redistribute){const b=1-h;for(let m=0;m<=Math.floor(this._kernelSize/2);m++)this._weights[m]+=this._weights[m]/h*b}return!0}get kernelSize(){return this._kernelSize}set kernelSize(s){g.assert(s>0,"Kernel size has to be positive."),g.assert(s<=2*(i._MAXKERNELSIZEHALF-1)+1,"Kernel size has to be smaller than "+(2*(i._MAXKERNELSIZEHALF-1)+2)+"."),g.assert(Number.isInteger(s),"Kernel size has to be an integer."),g.assert(s%2==1,"Kernel size has to be odd."),this._kernelSize=s,this._weights=void 0}get standardDeviation(){return this._standardDeviation}set standardDeviation(s){g.assert(s>0,"Standard deviation has to be positive."),this._standardDeviation=s,this._weights=void 0}get redistribute(){return this._redistribute}set redistribute(s){this._redistribute=s,this._weights=void 0}initialize(s){const a=this._context.gl,h=new n.Shader(this._context,a.VERTEX_SHADER,"gauss.vert");h.initialize(_(1622)),this._fragmentShader=new n.Shader(this._context,a.FRAGMENT_SHADER,"gauss.frag"),this._fragmentShader.replace("$KERNEL_HALF_SIZE",`${Math.floor(this.kernelSize/2)}`),this._fragmentShader.initialize(_(4472)),this._program=new r.Program(this._context),this._program.initialize([h,this._fragmentShader]),this._uDelta=this._program.uniform("u_delta"),this._uWeights=this._program.uniform("u_weights");const b=this._program.attribute("a_vertex",0);return s===void 0?this._ndcTriangle=new o.NdcFillingTriangle(this._context,"GaussFilterQuad"):(this._ndcTriangle=s,this._ndcTriangleShared=!0),this._ndcTriangle.initialize(b),!0}uninitialize(){this._program.uninitialize(),this._ndcTriangleShared||this._ndcTriangle.uninitialize()}filter(s,a){const h=this._context.gl,b=[l.vec2.fromValues(1,0),l.vec2.fromValues(0,1)];this.recalculateWeights()&&(this._fragmentShader.replace("$KERNEL_HALF_SIZE",`${Math.floor(this.kernelSize/2)}`),this._fragmentShader.compile(),this._program.link(),this._uDelta=this._program.uniform("u_delta"),this._uWeights=this._program.uniform("u_weights"),this._program.bind(),h.uniform1fv(this._uWeights,this._weights)),this._program.bind(),s.bind(h.TEXTURE0),h.uniform2fv(this._uDelta,l.vec2.divide(v.v2(),b[a],s.size)),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),s.unbind(h.TEXTURE0),this._program.unbind()}}i._MAXKERNELSIZEHALF=32,d([p.Initializable.initialize()],i.prototype,"initialize",null),d([p.Initializable.uninitialize()],i.prototype,"uninitialize",null),d([p.Initializable.assert_initialized()],i.prototype,"filter",null),c.GaussFilter=i,function(u){(function(s){s[s.Horizontal=0]="Horizontal",s[s.Vertical=1]="Vertical"})(u.Direction||(u.Direction={}))}(i=c.GaussFilter||(c.GaussFilter={}))},4894:function(x,c,_){var d=this&&this.__decorate||function(p,o,r,n){var i,u=arguments.length,s=u<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,r):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(p,o,r,n);else for(var a=p.length-1;a>=0;a--)(i=p[a])&&(s=(u<3?i(s):u>3?i(o,r,s):i(o,r))||s);return u>3&&s&&Object.defineProperty(o,r,s),s};Object.defineProperty(c,"__esModule",{value:!0}),c.Geometry=void 0;const l=_(1030),g=_(5590);class v extends l.Initializable{constructor(o,r){super(),this._buffers=new Array,r=r!==void 0&&r!==""?r:this.constructor.name,this._vertexArray=new g.VertexArray(o,`${r}VAO`)}initialize(...o){const r=o[0],n=o[1];let i=!0;for(let u=0;u<this._buffers.length;++u)i=this._buffers[u].initialize(r[u])&&i;return this._vertexArray.initialize(()=>this.bindBuffers(n),()=>this.unbindBuffers(n)),this._vertexArray.valid&&i}uninitialize(){this._vertexArray.uninitialize(),this._buffers.forEach(o=>o.uninitialize())}bind(){this._vertexArray.bind()}unbind(){this._vertexArray.unbind()}get buffers(){return this._buffers}get context(){return this._vertexArray.context}get vertexArray(){return this._vertexArray}}d([l.Initializable.initialize()],v.prototype,"initialize",null),d([l.Initializable.uninitialize()],v.prototype,"uninitialize",null),d([l.Initializable.assert_initialized()],v.prototype,"bind",null),d([l.Initializable.assert_initialized()],v.prototype,"unbind",null),c.Geometry=v},2111:(x,c,_)=>{const d=_(3659);var l;(function(g){function v(o){return o>0?o-Math.floor(o):o-Math.ceil(o)}g.sign=function(o){return o>0?1:o<0?-1:0},g.clamp=function(o,r,n){return Math.max(r,Math.min(n,o))},g.fract=v,g.v2=function(){return d.vec2.create()},g.clamp2=function(o,r,n,i){return o[0]=Math.max(n[0],Math.min(i[0],r[0])),o[1]=Math.max(n[1],Math.min(i[1],r[1])),o},g.abs2=function(o,r){return o[0]=Math.abs(r[0]),o[1]=Math.abs(r[1]),o},g.v3=function(){return d.vec3.create()},g.clamp3=function(o,r,n,i){return o[0]=Math.max(n[0],Math.min(i[0],r[0])),o[1]=Math.max(n[1],Math.min(i[1],r[1])),o[2]=Math.max(n[2],Math.min(i[2],r[2])),o},g.abs3=function(o,r){return o[0]=Math.abs(r[0]),o[1]=Math.abs(r[1]),o[2]=Math.abs(r[2]),o};const p=1/256;g.encode_float24x1_to_uint8x3=function(o,r){return o[0]=Math.floor(256*r),o[1]=Math.floor(256*v(256*r)),o[2]=Math.floor(256*v(65536*r)),o},g.decode_float24x1_from_uint8x3=function(o){return(o[0]+(o[1]+o[2]*p)*p)*p},g.encode_uint24_to_rgb8=function(o,r){return o[0]=r>>>0&255,o[1]=r>>>8&255,o[2]=r>>>16&255,o},g.encode_uint32_to_rgba8=function(o,r){return o[0]=r>>>0&255,o[1]=r>>>8&255,o[2]=r>>>16&255,o[3]=r>>>24&255,o},g.decode_uint24_from_rgb8=function(o){return o[0]+(o[1]<<8)+(o[2]<<16)},g.decode_uint32_from_rgba8=function(o){return o[0]+(o[1]<<8)+(o[2]<<16)+(o[3]<<24)>>>0},g.fromVec4=function(o){return o[3]===0?d.vec3.fromValues(o[0],o[1],o[2]):d.vec3.fromValues(o[0]/o[3],o[1]/o[3],o[2]/o[3])},g.v4=function(){return d.vec4.create()},g.clamp4=function(o,r,n,i){return o[0]=Math.max(n[0],Math.min(i[0],r[0])),o[1]=Math.max(n[1],Math.min(i[1],r[1])),o[2]=Math.max(n[2],Math.min(i[2],r[2])),o[3]=Math.max(n[3],Math.min(i[3],r[3])),o},g.abs4=function(o,r){return o[0]=Math.abs(r[0]),o[1]=Math.abs(r[1]),o[2]=Math.abs(r[2]),o[3]=Math.abs(r[3]),o},g.fromVec3=function(o){return d.vec4.fromValues(o[0],o[1],o[2],1)},g.parseVec2=function(o){if(o===void 0||o==="")return;let r=[];try{r=JSON.parse(`[${o}]`)}catch{return}return r.length!==2||isNaN(r[0])||isNaN(r[1])?void 0:d.vec2.clone(r)},g.parseVec3=function(o){if(o===void 0||o==="")return;let r=[];try{r=JSON.parse(`[${o}]`)}catch{return}return r.length!==3||isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?void 0:d.vec3.clone(r)},g.parseVec4=function(o){if(o===void 0||o==="")return;let r=[];try{r=JSON.parse(`[${o}]`)}catch{return}return r.length!==4||isNaN(r[0])||isNaN(r[1])||isNaN(r[2])||isNaN(r[3])?void 0:d.vec4.clone(r)},g.mix=function(o,r,n){return o*(1-n)+r*n},g.m2=function(){return d.mat2.create()},g.m3=function(){return d.mat3.create()},g.m4=function(){return d.mat4.create()}})(l||(l={})),x.exports=l},5218:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GL2Facade=void 0;const d=_(9696),l=_(4518);c.GL2Facade=class{constructor(g){this.drawBuffers=void 0,d.assert(g!==void 0,"gl2 facade expects a valid WebGL context"),this.queryHalfFloatSupport(g),this.queryColorAttachments(g),this.queryInstancedArraySupport(g),this.queryDrawBuffersSupport(g),this.queryVertexArrayObjectSupport(g),this.queryMaxUniformVec3Components(g),this.queryBufferSubDataInterface(g),this.queryTexImageInterface(g)}get HALF_FLOAT(){return this._halfFloat}queryHalfFloatSupport(g){switch(g.backend){case l.Context.BackendType.WebGL1:this._halfFloat=g.supportsTextureHalfFloat&&g.textureHalfFloat?g.textureHalfFloat.HALF_FLOAT_OES:void 0;break;case l.Context.BackendType.WebGL2:default:this._halfFloat=g.gl.HALF_FLOAT}}get COLOR_ATTACHMENT_MIN(){return this._colorAttachmentMin}get COLOR_ATTACHMENT_MAX(){return this._colorAttachmentMax}get COLOR_ATTACHMENT0(){return this._colorAttachments[0]}get COLOR_ATTACHMENT1(){return this._colorAttachments[1]}get COLOR_ATTACHMENT2(){return this._colorAttachments[2]}get COLOR_ATTACHMENT3(){return this._colorAttachments[3]}get COLOR_ATTACHMENT4(){return this._colorAttachments[4]}get COLOR_ATTACHMENT5(){return this._colorAttachments[5]}get COLOR_ATTACHMENT6(){return this._colorAttachments[6]}get COLOR_ATTACHMENT7(){return this._colorAttachments[7]}get COLOR_ATTACHMENT8(){return this._colorAttachments[8]}get COLOR_ATTACHMENT9(){return this._colorAttachments[9]}get COLOR_ATTACHMENT10(){return this._colorAttachments[10]}get COLOR_ATTACHMENT11(){return this._colorAttachments[11]}get COLOR_ATTACHMENT12(){return this._colorAttachments[12]}get COLOR_ATTACHMENT13(){return this._colorAttachments[13]}get COLOR_ATTACHMENT14(){return this._colorAttachments[14]}get COLOR_ATTACHMENT15(){return this._colorAttachments[15]}queryColorAttachments(g){const v=g.gl;switch(this._colorAttachments=new Array(16),this._colorAttachments[0]=v.COLOR_ATTACHMENT0,g.backend){case l.Context.BackendType.WebGL1:const p=g.supportsDrawBuffers?g.drawBuffers:void 0;if(this._colorAttachmentMin=this._colorAttachments[0],this._colorAttachmentMax=this._colorAttachmentMin+(p?v.getParameter(p.MAX_COLOR_ATTACHMENTS_WEBGL):0),this._colorAttachments[0]=p?p.COLOR_ATTACHMENT0_WEBGL:v.COLOR_ATTACHMENT0,!p)break;for(let o=1;o<16;++o)this._colorAttachments[o]=p.COLOR_ATTACHMENT0_WEBGL+o;break;case l.Context.BackendType.WebGL2:default:this._colorAttachmentMin=g.gl.COLOR_ATTACHMENT0,this._colorAttachmentMax=g.gl.COLOR_ATTACHMENT0+v.getParameter(v.MAX_COLOR_ATTACHMENTS);for(let o=0;o<16;++o)this._colorAttachments[o]=v.COLOR_ATTACHMENT0+o}}queryInstancedArraySupport(g){(g.isWebGL2||g.supportsInstancedArrays)&&(this.drawArraysInstanced=g.isWebGL2?(v,p,o,r)=>g.gl.drawArraysInstanced(v,p,o,r):(v,p,o,r)=>g.instancedArrays.drawArraysInstancedANGLE(v,p,o,r),this.drawElementsInstanced=g.isWebGL2?(v,p,o,r,n)=>g.gl.drawElementsInstanced(v,p,o,r,n):(v,p,o,r,n)=>g.instancedArrays.drawElementsInstancedANGLE(v,p,o,r,n),this.vertexAttribDivisor=g.isWebGL2?(v,p)=>g.gl.vertexAttribDivisor(v,p):(v,p)=>g.instancedArrays.vertexAttribDivisorANGLE(v,p))}get MAX_DRAW_BUFFERS(){return this._maxDrawBuffers}queryDrawBuffersSupport(g){(g.isWebGL2||g.supportsDrawBuffers)&&(this.drawBuffers=g.isWebGL2?v=>g.gl.drawBuffers(v):v=>g.drawBuffers.drawBuffersWEBGL(v),this._maxDrawBuffers=g.isWebGL2?g.gl.MAX_DRAW_BUFFERS:g.drawBuffers.MAX_DRAW_BUFFERS_WEBGL)}queryVertexArrayObjectSupport(g){(g.isWebGL2||g.supportsVertexArrayObject)&&(this.createVertexArray=g.isWebGL2?()=>g.gl.createVertexArray():()=>g.vertexArrayObject.createVertexArrayOES(),this.deleteVertexArray=g.isWebGL2?v=>g.gl.deleteVertexArray(v):v=>g.vertexArrayObject.deleteVertexArrayOES(v),this.isVertexArray=g.isWebGL2?v=>g.gl.isVertexArray(v):v=>g.vertexArrayObject.isVertexArrayOES(v),this.bindVertexArray=g.isWebGL2?v=>g.gl.bindVertexArray(v):v=>g.vertexArrayObject.bindVertexArrayOES(v))}get maxUniformVec3Components(){return this._maxUniformVec3Components}queryMaxUniformVec3Components(g){const v=g.gl;this._maxUniformVec3Components=g.isWebGL2?v.getParameter(v.MAX_VERTEX_UNIFORM_COMPONENTS):3*v.getParameter(v.MAX_VERTEX_UNIFORM_VECTORS)}queryBufferSubDataInterface(g){const v=g.gl;g.isWebGL2?this.bufferSubData=(p,o,r,n,i=0)=>v.bufferSubData(p,o,r,n,i):this.bufferSubData=(p,o,r,n=0,i=0)=>(d.logIf(n!==0,d.LogLevel.Warning,"srcOffset ignored (not supported in WebGL)"),d.logIf(i!==0,d.LogLevel.Warning,"length ignored (not supported in WebGL)"),v.bufferSubData(p,o,r))}queryTexImageInterface(g){const v=g.gl;g.isWebGL2?this.texImage2D=(p,o,r,n,i,u,s,a,h,b)=>h instanceof ArrayBuffer?v.texImage2D(p,o,r,n,i,u,s,a,h===void 0?null:h,b):(d.assert(b===void 0,"offset expected to be undefined for non ArrayBuffer source"),v.texImage2D(p,o,r,n,i,u,s,a,h===void 0?null:h)):this.texImage2D=(p,o,r,n,i,u,s,a,h,b)=>h===void 0?v.texImage2D(p,o,r,n,i,u,s,a,null):h instanceof Int8Array||h instanceof Uint8Array||h instanceof Uint8ClampedArray||h instanceof Int16Array||h instanceof Uint16Array||h instanceof Int32Array||h instanceof Uint32Array||h instanceof Float32Array||h instanceof Float64Array||h instanceof DataView?v.texImage2D(p,o,r,n,i,u,s,a,h):v.texImage2D(p,o,r,s,a,h),g.supportsTexImage3D?this.texImage3D=(p,o,r,n,i,u,s,a,h,b,m)=>b instanceof ArrayBuffer?v.texImage3D(p,o,r,n,i,u,s,a,h,b===void 0?null:b,m):(d.assert(m===void 0,"offset expected to be undefined for non ArrayBuffer source"),v.texImage3D(p,o,r,n,i,u,s,a,h,b===void 0?null:b)):this.texImage3D=(p,o,r,n,i,u,s,a,h,b,m)=>d.assert(!1,"texImage3D not supported on this context")}}},8269:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GLTFHelper=void 0;const d=_(9696);c.GLTFHelper=class{static modeToEnum(l,g){return(g<0||g>6)&&d.log(d.LogLevel.Error,`Specified draw mode is ${g} but is required to be between 0 and 6`),g===0?l.POINTS:g===1?l.LINES:g===2?l.LINE_LOOP:g===3?l.LINE_STRIP:g===4?l.TRIANGLES:g===5?l.TRIANGLE_STRIP:g===6?l.TRIANGLE_FAN:l.TRIANGLES}static nameToAttributeIndex(l){return l==="POSITION"?0:l==="NORMAL"?1:l==="TANGENT"?2:l==="TEXCOORD_0"?3:l==="TEXCOORD_1"?4:l==="TEXCOORD_2"?5:l==="JOINTS_0"?6:l==="WEIGHTS_0"?7:l==="COLOR_0"?8:(d.log(d.LogLevel.Warning,`Unknown attribute name '${l}' encountered.             Possibly this model uses an unsupported extension.`),-1)}}},5500:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GLTFLoader=void 0;const d=_(3659),l=_(9696),g=_(3041),v=_(8269),p=_(858),o=_(7964),r=_(4303),n=_(6404),i=_(2194),u=_(4895),s=_(9922),a=_(9981),h=_(5263),b=_(6942);c.GLTFLoader=class{constructor(m){this._context=m;const M=this._context.gl;this._resourceManager=new i.ResourceManager(this._context),this._scenes=new Array;const S=new h.Shader(this._context,M.VERTEX_SHADER,"gltf_default.vert");S.initialize(_(6263));const w=new h.Shader(this._context,M.FRAGMENT_SHADER,"gltf_default.frag");w.initialize(_(6277)),this._pbrProgram=new u.Program(this._context,"GLTFPbrProgram"),this._pbrProgram.initialize([S,w])}async loadTextures(m){const M=this._context.gl;this._uriTextureMap=new Map;const S=m.gltf.textures,w=m.gltf.images,N=m.gltf.samplers;if(!S||!w)return;let F=0;for(const k of S){if(k.source===void 0){l.log(l.LogLevel.Warning,"The GLTF model does not specify a texture source. Possibly it uses an unsupported extension."),F++;continue}const X=k.source,$=w[X],V=this._sceneName+"_texture_"+F,Y=$.name===void 0?$.uri:$.name;let Z=await m.imageData.get(X);if(!l.isPowerOfTwo(Z.width)||!l.isPowerOfTwo(Z.height)){const K=document.createElement("canvas");K.width=l.upperPowerOfTwo(Z.width),K.height=l.upperPowerOfTwo(Z.height);const re=K.getContext("2d");re===void 0&&l.log(l.LogLevel.Error,"Failed to create context while trying to resize non power of two texture"),re.drawImage(Z,0,0,K.width,K.height),Z=K}const J=new b.Texture2D(this._context,Y);if(J.initialize(Z.width,Z.height,M.RGBA8,M.RGBA,M.UNSIGNED_BYTE),J.data(Z),N===void 0||k.sampler===void 0)J.wrap(M.REPEAT,M.REPEAT),J.filter(M.LINEAR,M.LINEAR);else{const K=N[k.sampler];J.wrap(K.wrapS||M.REPEAT,K.wrapT||M.REPEAT),J.filter(K.magFilter||M.LINEAR,K.minFilter||M.LINEAR),K.minFilter!==M.NEAREST_MIPMAP_NEAREST&&K.minFilter!==M.LINEAR_MIPMAP_NEAREST&&K.minFilter!==M.NEAREST_MIPMAP_LINEAR&&K.minFilter!==M.LINEAR_MIPMAP_LINEAR||J.generateMipMap()}this._resourceManager.add(J,[Y,V]);const ee=$.uri?$.uri:V;this._uriTextureMap.set(ee,J),F++}}getTexture(m){const M=this._sceneName+"_texture_"+m,S=this._resourceManager.get(M);if(S!==void 0)return S;l.log(l.LogLevel.Warning,`Texture with index ${m} could not be located.`)}async loadMaterials(m){this._pbrDefaultMaterial=new o.GLTFPbrMaterial(this._context,"DefaultMaterial"),this._resourceManager.add(this._pbrDefaultMaterial,[this._pbrDefaultMaterial.name]);const M=m.gltf.materials;if(!M)return;let S=0;for(const w of M){const N=this._sceneName+"_material_"+S,F=new o.GLTFPbrMaterial(this._context,w.name),k=w.normalTexture;k!==void 0&&(F.normalTexture=this.getTexture(k.index),F.normalTexCoord=k.texCoord||0,F.normalScale=k.scale||1);const X=w.occlusionTexture;X!==void 0&&(F.occlusionTexture=this.getTexture(X.index),F.occlusionTexCoord=X.texCoord||0);const $=w.emissiveTexture;$!==void 0&&(F.emissiveTexture=this.getTexture($.index),F.emissiveTexCoord=$.texCoord||0),F.emissiveFactor=d.vec3.fromValues(0,0,0),w.emissiveFactor!==void 0&&(F.emissiveFactor=d.vec3.fromValues.apply(void 0,w.emissiveFactor)),F.alphaMode=o.GLTFAlphaMode.OPAQUE,w.alphaMode==="MASK"?(F.alphaMode=o.GLTFAlphaMode.MASK,w.alphaCutoff===void 0?F.alphaCutoff=.5:F.alphaCutoff=w.alphaCutoff):w.alphaMode==="BLEND"&&(F.alphaMode=o.GLTFAlphaMode.BLEND,F.isTransparent=!0),F.isDoubleSided=w.doubleSided||!1;const V=w.pbrMetallicRoughness;V===void 0&&l.log(l.LogLevel.Warning,"Model contains a material without PBR information");const Y=V.baseColorTexture;Y!==void 0&&(F.baseColorTexture=this.getTexture(Y.index),F.baseColorTexCoord=Y.texCoord||0);const Z=V.metallicRoughnessTexture;Z!==void 0&&(F.metallicRoughnessTexture=this.getTexture(Z.index),F.metallicRoughnessTexCoord=Z.texCoord||0),F.baseColorFactor=d.vec4.fromValues(1,1,1,1),V.baseColorFactor!==void 0&&(F.baseColorFactor=d.vec4.fromValues.apply(void 0,V.baseColorFactor)),F.metallicFactor=1,V.metallicFactor!==void 0&&(F.metallicFactor=V.metallicFactor),F.roughnessFactor=1,V.roughnessFactor!==void 0&&(F.roughnessFactor=V.roughnessFactor),this._resourceManager.add(F,[w.name,N]),S++}}inferBufferUsage(m,M){const S=this._context.gl,w=m.gltf.meshes,N=m.gltf.accessors;if(w===void 0||N===void 0)return l.log(l.LogLevel.Error,"Asset does not include any meshes or accessors"),S.ARRAY_BUFFER;for(const F of w)for(const k of F.primitives){const X=k.indices;if(X===void 0)continue;const $=N[X].bufferView;if($!==void 0&&$===M)return S.ELEMENT_ARRAY_BUFFER}return S.ARRAY_BUFFER}async loadBuffers(m){const M=this._context.gl,S=m.gltf.bufferViews,w=m.gltf.accessors;if(!S)return void l.log(l.LogLevel.Warning,"The asset does not include any buffer view information.");if(!w)return void l.log(l.LogLevel.Warning,"The asset does not include any accessor information.");let N=0;for(const k of S){const X=this._sceneName+"_bufferView_"+N,$=await m.bufferViewData(N);let V=k.target;V===void 0&&(V=this.inferBufferUsage(m,N));const Y=new n.Buffer(this._context,X);Y.initialize(V),Y.data($,M.STATIC_DRAW),this._resourceManager.add(Y,[X]),N++}let F=0;for(const k of w){const X=k.bufferView,$=k.sparse;if(X===void 0||$!==void 0){const V=this._sceneName+"_accessor_"+F,Y=new n.Buffer(this._context,V),Z=await m.accessorData(F);Y.initialize(M.ARRAY_BUFFER),Y.data(Z,M.STATIC_DRAW),this._resourceManager.add(Y,[V])}F++}}async loadMeshes(m){this._meshes=new Array,this._nameMeshMap=new Map;const M=m.gltf.meshes;if(M===void 0)return l.log(l.LogLevel.Warning,"The asset does not contain any mesh information"),this._meshes;let S=0;for(const w of M){const N=new p.GLTFMesh(w.name);for(const F of w.primitives){const k=await this.loadPrimitive(m,F,S);k!==void 0&&N.addPrimitive(k),S++}w.name&&this._nameMeshMap.set(w.name,N),this._meshes.push(N)}return this._meshes}async loadPrimitive(m,M,S){const w=this._context.gl,N=m.gltf.accessors,F=m.gltf.bufferViews;if(N===void 0)return void l.log(l.LogLevel.Error,"GLTF asset does not have any accessors.");if(F===void 0)return void l.log(l.LogLevel.Error,"GLTF asset does not have any buffer views.");let k=M.mode;const X=this._sceneName+"_primitive_"+S;k||(k=4);const $=v.GLTFHelper.modeToEnum(w,k),V=new Array;let Y=this._pbrDefaultMaterial;if(M.material!==void 0){const K=this._sceneName+"_material_"+M.material,re=this._resourceManager.get(K);re!==void 0?Y=re:l.log(l.LogLevel.Warning,`Material ${K} could not be found.`)}let Z,J=0;for(const K in M.attributes){const re=v.GLTFHelper.nameToAttributeIndex(K);K==="NORMAL"&&(J|=o.GLTFShaderFlags.HAS_NORMALS),K==="TANGENT"&&(J|=o.GLTFShaderFlags.HAS_TANGENTS),K==="COLOR_0"&&(J|=o.GLTFShaderFlags.HAS_COLORS),K!=="TEXCOORD_0"&&K!=="TEXCOORD_1"&&K!=="TEXCOORD_2"||(J|=o.GLTFShaderFlags.HAS_UV);const ue=M.attributes[K],ie=N[ue],de=ie.bufferView,Te=ie.sparse;let pe,Oe=0;if(de===void 0||Te!==void 0){const Re=this._sceneName+"_accessor_"+ue;pe=this._resourceManager.get(Re)}else{const Re=F[de],Ae=this._sceneName+"_bufferView_"+de;pe=this._resourceManager.get(Ae),Oe=Re.byteStride||0}const Q=new r.VertexBinding;Q.buffer=pe,Q.attributeIndex=re,Q.numVertices=ie.count,Q.normalized=ie.normalized||!1,Q.size=g.GLTF_ELEMENTS_PER_TYPE[ie.type],Q.offset=ie.byteOffset||0,Q.stride=Oe,Q.type=ie.componentType,V.push(Q)}if(M.indices!==void 0){const K=N[M.indices],re=K.bufferView;!re===void 0&&l.log(l.LogLevel.Error,"Accessor does not reference a BufferView.");const ue=this._sceneName+"_bufferView_"+re,ie=this._resourceManager.get(ue);Z=new r.IndexBinding,Z.buffer=ie,Z.numIndices=K.count,Z.offset=K.byteOffset||0,Z.type=K.componentType}const ee=new r.GLTFPrimitive(this._context,V,Z,$,Y,J);return ee.initialize(),this._resourceManager.add(ee,[X]),ee}async generateScenes(m){const M=m.gltf.nodes,S=m.gltf.scenes;if(!M||!S)return void l.log(l.LogLevel.Warning,"The asset does not contain any nodes or scene information.");const w=new Map;let N=0;for(const X of M){const $=X.name||"node_"+N,V=new a.SceneNode($);if(w.set(N,V),X.matrix){const Y=d.mat4.fromValues.apply(void 0,X.matrix),Z=new s.TransformComponent(Y);V.addComponent(Z)}else if(X.translation||X.rotation||X.scale){let Y=d.quat.create();X.rotation&&(Y=d.quat.fromValues.apply(void 0,X.rotation));let Z=d.vec3.create();X.translation&&(Z=d.vec3.fromValues.apply(void 0,X.translation));let J=d.vec3.fromValues(1,1,1);X.scale&&(J=d.vec3.fromValues.apply(void 0,X.scale));const ee=d.mat4.fromRotationTranslationScale(d.mat4.create(),Y,Z,J),K=new s.TransformComponent(ee);V.addComponent(K)}if(X.mesh!==void 0){const Y=this._meshes[X.mesh];for(const Z of Y.primitives){const J=new s.GeometryComponent;J.material=Z.material,J.geometry=Z,V.addComponent(J)}}(X.skin||X.weights)&&l.log(l.LogLevel.Info,"Imported GLTF assets uses skins, which are not supported yet."),N++}N=0;for(const X of M){const $=w.get(N);if(l.assert($!==void 0,"Scene node could not be found."),X.children)for(const V of X.children){const Y=w.get(V);Y||l.log(l.LogLevel.Error,"Model references a node that does not exist."),$.addNode(Y)}N++}let F=0;for(const X of S){const $=X.name||"scene_"+F,V=new a.SceneNode($);if(X.nodes)for(const Y of X.nodes){const Z=w.get(Y);Z||l.log(l.LogLevel.Error,"Scene references a node that does not exist."),V.addNode(Z)}else l.log(l.LogLevel.Warning,`Scene ${$} does not contain any nodes.`);this._scenes.push(V),F++}const k=m.gltf.scene;k!==void 0&&(this._defaultScene=this._scenes[k])}async loadAsset(m){const M=new g.GltfLoader,S=await M.load(m),w=S.gltf;this._sceneName="scene",w.scenes&&w.scene&&w.scenes[w.scene].name&&(this._sceneName=w.scenes[w.scene].name),await this.loadTextures(S).then(()=>this.loadMaterials(S)).then(()=>this.loadBuffers(S)).then(()=>this.loadMeshes(S)).then(()=>this.generateScenes(S))}uninitialize(){this._scenes=[],this._defaultScene=void 0,this._resourceManager.uninitialize()}getMeshByName(m){return this._nameMeshMap.get(m)}get meshes(){return this._meshes}get uriTextureMap(){return this._uriTextureMap}get pbrProgram(){return this._pbrProgram}get scenes(){return this._scenes}get defaultScene(){return this._defaultScene!==void 0?this._defaultScene:this._scenes!==void 0&&this._scenes.length>0?this._scenes[0]:(l.log(l.LogLevel.Warning,"Default scene was requested, but none is available."),new a.SceneNode("EmptyScene"))}}},858:(x,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GLTFMesh=void 0,c.GLTFMesh=class{constructor(_){this._name=_,this._primitives=new Array}get primitives(){return this._primitives}addPrimitive(_){this._primitives.push(_)}}},7964:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GLTFPbrMaterial=c.GLTFAlphaMode=c.GLTFShaderFlags=void 0;const d=_(3659),l=_(9922);var g,v;(function(o){o[o.HAS_NORMALS=1]="HAS_NORMALS",o[o.HAS_TANGENTS=2]="HAS_TANGENTS",o[o.HAS_UV=4]="HAS_UV",o[o.HAS_COLORS=8]="HAS_COLORS",o[o.USE_IBL=16]="USE_IBL",o[o.HAS_BASECOLORMAP=32]="HAS_BASECOLORMAP",o[o.HAS_NORMALMAP=64]="HAS_NORMALMAP",o[o.HAS_EMISSIVEMAP=128]="HAS_EMISSIVEMAP",o[o.HAS_METALROUGHNESSMAP=256]="HAS_METALROUGHNESSMAP",o[o.HAS_OCCLUSIONMAP=512]="HAS_OCCLUSIONMAP",o[o.USE_TEX_LOD=1024]="USE_TEX_LOD"})(g=c.GLTFShaderFlags||(c.GLTFShaderFlags={})),function(o){o[o.OPAQUE=0]="OPAQUE",o[o.MASK=1]="MASK",o[o.BLEND=2]="BLEND"}(v=c.GLTFAlphaMode||(c.GLTFAlphaMode={}));class p extends l.Material{constructor(r,n){super(r,n),this.baseColorTexCoord=0,this.metallicRoughnessTexCoord=0,this.normalTexCoord=0,this.occlusionTexCoord=0,this.emissiveTexCoord=0,this._alphaMode=v.OPAQUE,this._alphaCutoff=1,this._baseColorFactor=d.vec4.fromValues(1,1,1,1),this._metallicFactor=1,this._roughnessFactor=1,this._emissiveFactor=d.vec3.fromValues(0,0,0),this._isDoubleSided=!1,this._normalScale=1}set baseColorTexture(r){this._baseColorTexture=r}get baseColorTexture(){return this._baseColorTexture}set metallicRoughnessTexture(r){this._metallicRoughnessTexture=r}get metallicRoughnessTexture(){return this._metallicRoughnessTexture}set normalTexture(r){this._normalTexture=r}get normalTexture(){return this._normalTexture}set occlusionTexture(r){this._occlusionTexture=r}get occlusionTexture(){return this._occlusionTexture}set emissiveTexture(r){this._emissiveTexture=r}get emissiveTexture(){return this._emissiveTexture}set emissiveFactor(r){this._emissiveFactor=r}get emissiveFactor(){return this._emissiveFactor}set baseColorFactor(r){this._baseColorFactor=r}get baseColorFactor(){return this._baseColorFactor}set metallicFactor(r){this._metallicFactor=r}get metallicFactor(){return this._metallicFactor}set roughnessFactor(r){this._roughnessFactor=r}get roughnessFactor(){return this._roughnessFactor}get normalScale(){return this._normalScale}set normalScale(r){this._normalScale=r}set isDoubleSided(r){this._isDoubleSided=r}get isDoubleSided(){return this._isDoubleSided}set alphaMode(r){this._alphaMode=r}get alphaMode(){return this._alphaMode}set alphaCutoff(r){this._alphaCutoff=r}get alphaCutoff(){return this._alphaCutoff}get flags(){let r=0;return this.baseColorTexture!==void 0&&(r|=g.HAS_BASECOLORMAP),this.metallicRoughnessTexture!==void 0&&(r|=g.HAS_METALROUGHNESSMAP),this.normalTexture!==void 0&&(r|=g.HAS_NORMALMAP),this.occlusionTexture!==void 0&&(r|=g.HAS_OCCLUSIONMAP),this.emissiveTexture!==void 0&&(r|=g.HAS_EMISSIVEMAP),r}}c.GLTFPbrMaterial=p},4303:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GLTFPrimitive=c.VertexBinding=c.IndexBinding=void 0;const d=_(4894),l=_(8269);c.IndexBinding=class{},c.VertexBinding=class{};class g extends d.Geometry{constructor(p,o,r,n,i,u,s){super(p,s),this._bindings=o,this._indexBinding=r,this._material=i,this._geometryFlags=u,this._drawMode=n}bindBuffers(){this._indexBinding&&this._indexBinding.buffer.bind();for(const p of this._bindings)p.buffer.attribEnable(p.attributeIndex,p.size,p.type,p.normalized,p.stride,p.offset,!0,!0)}unbindBuffers(){this._indexBinding&&this._indexBinding.buffer.unbind();for(const p of this._bindings)p.buffer.attribDisable(p.attributeIndex,!0,!0)}draw(){const p=this.context.gl;this._indexBinding?p.drawElements(this._drawMode,this._indexBinding.numIndices,this._indexBinding.type,this._indexBinding.offset):p.drawArrays(this._drawMode,0,this._bindings[0].numVertices)}get drawMode(){return this._drawMode}get material(){return this._material}get flags(){return this._geometryFlags}get indexBufferInformation(){return this._indexBinding}getVertexBufferInformationFromAttribute(p){const o=l.GLTFHelper.nameToAttributeIndex(p);for(const r of this._bindings)if(r.attributeIndex===o)return r}}c.GLTFPrimitive=g},3733:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GLTFMesh=c.GLTFPrimitive=c.GLTFShaderFlags=c.GLTFPbrMaterial=c.GLTFAlphaMode=c.GLTFLoader=void 0;var d=_(5500);Object.defineProperty(c,"GLTFLoader",{enumerable:!0,get:function(){return d.GLTFLoader}});var l=_(7964);Object.defineProperty(c,"GLTFAlphaMode",{enumerable:!0,get:function(){return l.GLTFAlphaMode}}),Object.defineProperty(c,"GLTFPbrMaterial",{enumerable:!0,get:function(){return l.GLTFPbrMaterial}}),Object.defineProperty(c,"GLTFShaderFlags",{enumerable:!0,get:function(){return l.GLTFShaderFlags}});var g=_(4303);Object.defineProperty(c,"GLTFPrimitive",{enumerable:!0,get:function(){return g.GLTFPrimitive}});var v=_(858);Object.defineProperty(c,"GLTFMesh",{enumerable:!0,get:function(){return v.GLTFMesh}})},1030:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Initializable=void 0;const d=_(9696);class l{constructor(){this._initialized=!1,this.assertInitialized=()=>l.assertInitializedFalse(this),this.assertUninitialized=()=>{}}static initialize(){return(v,p,o)=>{const r=o.value;return o.value=function(){return d.assert(this._initialized===!1,"re-initialization of initialized object not anticipated"),this._initialized=r.apply(this,arguments),this._initialized?(this.assertInitialized=()=>{},this.assertUninitialized=()=>l.assertUninitializedFalse(this)):(this.assertUninitialized=()=>{},this.assertInitialized=()=>l.assertInitializedFalse(this)),this._initialized},o}}static uninitialize(){return(v,p,o)=>{const r=o.value;return o.value=function(){d.assert(this._initialized===!0,"expected object to be initialized in order to uninitialize"),r.apply(this),this._initialized=!1,this.assertUninitialized=()=>{},this.assertInitialized=()=>l.assertInitializedFalse(this)},o}}static discard(){return(v,p,o)=>{const r=o.value;return o.value=function(){d.assert(this._initialized===!0,"expected object to be initialized in order to uninitialize"),r.apply(this),this._initialized=!1,this.assertUninitialized=()=>{},this.assertInitialized=()=>l.assertInitializedFalse(this)},o}}static assert_initialized(){return(v,p,o)=>{const r=o.value;return o.value=function(){return this.assertInitialized(),r.apply(this,arguments)},o}}static assert_uninitialized(){return(v,p,o)=>{const r=o.value;return o.value=function(){this.assertUninitialized(),r.apply(this,arguments)},o}}get initialized(){return this._initialized}}c.Initializable=l,l.assertInitializedFalse=g=>d.assert(!1,`instance of ${g.constructor.name} expected to be initialized`),l.assertUninitializedFalse=g=>d.assert(!1,`instance of ${g.constructor.name} not expected to be initialized`)},4563:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.KernelI8=c.KernelUI8=c.KernelI32=c.KernelUI32=c.KernelF32=c.AbstractKernel=void 0;const d=_(9696);class l{constructor(v,p,o=1,r=1){this._components=v,this._width=isNaN(p)?1:Math.max(1,p),this._height=Math.max(1,o),this._depth=Math.max(1,r),this.resize()}get(v,p,o){let r;switch(r=p===void 0&&o===void 0?this._components*v:this.index(v,p,o||0),d.assert(r<this.length,`index expected to be in range [0, ${this.length-1}], given ${r}`),this._components){case 1:return[this._samples[r]];case 2:return[this._samples[r],this._samples[r+1]];case 3:return[this._samples[r],this._samples[r+1],this._samples[r+2]];case 4:return[this._samples[r],this._samples[r+1],this._samples[r+2],this._samples[r+3]]}}set(v,p,o,r){let n;switch(d.assert(v.length===this._components,`number of components expected to be ${this._components}, given ${v.length}`),n=o===void 0&&r===void 0?this._components*Math.min(this.elements,Math.max(0,p)):this._components*this.index(p,o,r||0),d.assert(n<this.length,`index expected to be in range [0, ${this.length-1}], given ${n}`),this._components){case 4:this._samples[n+3]=v[3];case 3:this._samples[n+2]=v[2];case 2:this._samples[n+1]=v[1];case 1:this._samples[n+0]=v[0]}}fromJSON(v){d.assert(v.size&&v.size.width!==void 0&&v.size.height!==void 0&&v.size.depth!==void 0,`expected kernel width, height, and depth to be set, given '${v.size}'`);const p=r=>r.reduce((n,i)=>n.concat(Array.isArray(i)?p(i):i),[]);this._width=Math.max(1,v.size.width),this._height=Math.max(1,v.size.height),this._depth=Math.max(1,v.size.depth);const o=p(v.kernel);this._components=Math.floor(o.length/this.elements),this.resize(),this.fromArray(o)}index(v,p=0,o=0){return this._width*(this._height*Math.min(this._depth,Math.max(0,o))+Math.min(this._height,Math.max(0,p)))+Math.min(this._width,Math.max(0,v))}position(v){let p=Math.min(this.elements,Math.max(0,v));const o=Math.floor(p/(this._width*this._height));p-=o*this._width*this._height;const r=Math.floor(p/this._width);return p-=r*this._width,[p,r,o]}sort(v){if(this.elements<2)return;const p=Array(this.elements);for(let r=0;r<this.elements;++r){let n=0;switch(v){case l.SortApproach.BySquaredLength:default:for(let i=0;i<this._components;++i){const u=this._samples[r*this._components+i];n+=u*u}}p[r]=[r,n]}switch(v){case l.SortApproach.BySquaredLength:default:p.sort((r,n)=>r[1]-n[1])}const o=this._samples.slice();for(let r=0;r<p.length;++r)for(let n=0;n<this._components;++n){const i=p[r][0]*this._components+n,u=r*this._components+n;this._samples[u]=o[i]}}get samples(){return this._samples}get length(){return this._width*this._height*this._depth*this._components}get elements(){const v=this._width*this._height*this._depth;return isNaN(v)?0:v}get components(){return this._components}get width(){return this._width}get height(){return this._height}get depth(){return this._depth}get xStride(){return this.bytesPerComponent*this._components}get yStride(){return this.bytesPerComponent*this._components*this._width}get zStride(){return this.bytesPerComponent*this._components*this._width*this._depth}get bytesLength(){return this.bytesPerComponent*this._components*this._width*this._height*this._depth}}c.AbstractKernel=l,function(g){(function(v){v[v.BySquaredLength=0]="BySquaredLength"})(g.SortApproach||(g.SortApproach={}))}(l=c.AbstractKernel||(c.AbstractKernel={})),c.KernelF32=class extends l{resize(){this._samples=new Float32Array(this.length)}fromArray(g){d.assert(g.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Float32Array(g))}get bytesPerComponent(){return 4}},c.KernelUI32=class extends l{resize(){this._samples=new Uint32Array(this.length)}fromArray(g){d.assert(g.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint32Array(g))}get bytesPerComponent(){return 4}},c.KernelI32=class extends l{resize(){this._samples=new Int32Array(this.length)}fromArray(g){d.assert(g.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int32Array(g))}get bytesPerComponent(){return 4}},c.KernelUI8=class extends l{resize(){this._samples=new Uint8Array(this.length)}fromArray(g){d.assert(g.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint8Array(g))}get bytesPerComponent(){return 4}},c.KernelI8=class extends l{resize(){this._samples=new Int8Array(this.length)}fromArray(g){d.assert(g.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int8Array(g))}get bytesPerComponent(){return 4}}},4841:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.MouseEventProvider=void 0;const d=_(7318),l=_(9696),g=_(6157),v=_(9258);class p{constructor(r,n){this._pointerLockRequestPending=!1,l.assert(r!==void 0,`expected valid canvas element on initialization, given ${r}`),this._element=r,this._timeframe=n,this._element.addEventListener("click",()=>this.processPointerLockRequests()),(g.IS_EDGE||g.IS_IE11)&&this._element.addEventListener("dragstart",i=>i.preventDefault())}processPointerLockRequests(){this._pointerLockRequestPending&&v.PointerLock.request(this._element)}preventDefaultOnEvent(r,n){l.bitInBitfield(this._preventDefaultMask,r)&&n.preventDefault()}preventDefault(...r){for(const n of r)l.bitInBitfield(this._preventDefaultMask,n)||(this._preventDefaultMask|=n)}allowDefault(...r){for(const n of r)l.bitInBitfield(this._preventDefaultMask,n)&&(this._preventDefaultMask&=~n)}observable(r){switch(r){case p.Type.Click:return this.click$;case p.Type.Enter:return this.enter$;case p.Type.Leave:return this.leave$;case p.Type.Down:return this.down$;case p.Type.Up:return this.up$;case p.Type.Move:return this.move$;case p.Type.Wheel:return this.wheel$;case p.Type.Drag:return this.drag$;default:return}}set pointerLock(r){this._pointerLockRequestPending=r,r===!1&&(this._pointerLockRequestPending=!1,v.PointerLock.exit())}get pointerLock(){return v.PointerLock.active(this._element)}get click$(){return this._clickSubject===void 0&&(this._clickSubject=new d.ReplaySubject(void 0,this._timeframe),this._clickListener=r=>{this.preventDefaultOnEvent(p.Type.Click,r),this._clickSubject.next(r)},this._element.addEventListener("click",this._clickListener)),this._clickSubject.asObservable()}get enter$(){return this._enterSubject===void 0&&(this._enterSubject=new d.ReplaySubject(void 0,this._timeframe),this._enterListener=r=>{this.preventDefaultOnEvent(p.Type.Enter,r),this._enterSubject.next(r)},this._element.addEventListener("mouseenter",this._enterListener)),this._enterSubject.asObservable()}get leave$(){return this._leaveSubject===void 0&&(this._leaveSubject=new d.ReplaySubject(void 0,this._timeframe),this._leaveListener=r=>{this.preventDefaultOnEvent(p.Type.Leave,r),this._leaveSubject.next(r)},this._element.addEventListener("mouseleave",this._leaveListener)),this._leaveSubject.asObservable()}get down$(){return this._downSubject===void 0&&(this._downSubject=new d.ReplaySubject(void 0,this._timeframe),this._downListener=r=>{this.preventDefaultOnEvent(p.Type.Down,r),this._downSubject.next(r)},this._element.addEventListener("mousedown",this._downListener)),this._downSubject.asObservable()}get up$(){return this._upSubject===void 0&&(this._upSubject=new d.ReplaySubject(void 0,this._timeframe),this._upListener=r=>{this.preventDefaultOnEvent(p.Type.Up,r),this._upSubject.next(r)},this._element.addEventListener("mouseup",this._upListener)),this._upSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new d.ReplaySubject(void 0,this._timeframe),this._moveListener=r=>{this.preventDefaultOnEvent(p.Type.Move,r),this._moveSubject.next(r)},this._element.addEventListener("mousemove",this._moveListener)),this._moveSubject.asObservable()}get wheel$(){return this._wheelSubject===void 0&&(this._wheelSubject=new d.ReplaySubject(void 0,this._timeframe),this._wheelListener=r=>{this.preventDefaultOnEvent(p.Type.Wheel,r),this._wheelSubject.next(r)},this._element.addEventListener("wheel",this._wheelListener)),this._wheelSubject.asObservable()}get drag$(){return this._dragSubject===void 0&&(this._dragSubject=new d.ReplaySubject(void 0,this._timeframe),this._dragListener=r=>{this.preventDefaultOnEvent(p.Type.Drag,r),this._dragSubject.next(r)},this._element.addEventListener("drag",this._dragListener)),this._dragSubject.asObservable()}}c.MouseEventProvider=p,function(o){(function(r){r[r.Click=1]="Click",r[r.Wheel=2]="Wheel",r[r.Enter=4]="Enter",r[r.Leave=8]="Leave",r[r.Move=16]="Move",r[r.Down=32]="Down",r[r.Up=64]="Up",r[r.Drag=128]="Drag"})(o.Type||(o.Type={}))}(p=c.MouseEventProvider||(c.MouseEventProvider={}))},6157:(x,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IS_EDGE=c.IS_IE11=void 0,c.IS_IE11=typeof navigator=="undefined"?void 0:/MSIE 11|Windows/i.test(navigator.userAgent),c.IS_EDGE=typeof navigator=="undefined"?void 0:/Edge\/\d./i.test(navigator.userAgent)},8652:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Navigation=void 0;const d=_(3659),l=_(7595),g=_(9258),v=_(9696),p=_(9870),o=_(8287),r=_(8357),n=_(2763),i=_(2783),u=_(9817);class s{constructor(h,b){this._alwaysRotateOnMove=!1,this._invalidate=h,this._eventHandler=new l.EventHandler(h,b),this._eventHandler.pushPointerDownHandler((m,M)=>this.onPointerDown(m,M)),this._eventHandler.pushPointerUpHandler((m,M)=>this.onPointerUp(m,M)),this._eventHandler.pushPointerEnterHandler((m,M)=>this.onPointerEnter(m,M)),this._eventHandler.pushPointerLeaveHandler((m,M)=>this.onPointerLeave(m,M)),this._eventHandler.pushPointerMoveHandler((m,M)=>this.onPointerMove(m,M)),this._eventHandler.pushPointerCancelHandler((m,M)=>this.onPointerCancel(m,M)),this._eventHandler.pushMouseWheelHandler((m,M)=>this.onWheel(m,M)),this.rotationMetaphor=s.RotationMetaphor.Turntable,this._pan=new o.PanModifier,this._pinch=new r.PinchZoomModifier,this._wheelZoom=new u.WheelZoomModifier,this._activeEvents=new Map}mode(){const h=Array.from(this._activeEvents.values()),b=this.getPrimaryEvent(h);if(b===void 0)return void v.log(v.LogLevel.Warning,"No primary pointer event detected in Navigation::mode.");const m=b.pointerType==="mouse",M=b.pointerType==="touch"||b.pointerType==="pen",S=1&b.buttons,w=b.shiftKey,N=g.PointerLock.active()&&this._alwaysRotateOnMove,F=this._activeEvents.size;return N?s.Modes.Rotate:m&&S&&w&&F===1?s.Modes.Pan:M&&F===2?s.Modes.MultiTouch:m&&S&&F===1||M&&F===1?s.Modes.Rotate:void 0}resolveMultiTouch(){if(this._activeEvents.size<2)return void v.log(v.LogLevel.Warning,"MultiTouch resolution was canceled because less than two touches were detected.");const h=Array.from(this._activeEvents.values()),b=d.vec2.fromValues(h[0].movementX,h[0].movementY),m=d.vec2.fromValues(h[1].movementX,h[1].movementY);return d.vec2.length(b)===0||d.vec2.length(m)===0?s.Modes.Zoom:(d.vec2.normalize(b,b),d.vec2.normalize(m,m),d.vec2.dot(b,m)>.2?s.Modes.Pan:s.Modes.Zoom)}rotate(h){if(this._activeEvents.size!==1)return void v.log(v.LogLevel.Info,"Rotate event was canceled because less or more than two pointers were detected.");const b=Array.from(this._activeEvents.values()),m=this._eventHandler.offsets(b[0])[0];switch(this._rotationMetaphor){case s.RotationMetaphor.FirstPerson:const M=this._firstPerson;let S;g.PointerLock.active()&&event instanceof MouseEvent&&(S=d.vec2.fromValues(event.movementX,event.movementY)),h?M.initiate(m):M.process(m,S);break;case s.RotationMetaphor.Trackball:const w=this._trackball;h?w.initiate(m):w.process(m);break;case s.RotationMetaphor.Turntable:const N=this._turntable;h?N.initiate(m):N.process(m)}}pan(h){const b=Array.from(this._activeEvents.values()),m=this.getPrimaryEvent(b);if(m===void 0)return void v.log(v.LogLevel.Warning,"Pan event was canceled because no primary event was detected.");const M=this._eventHandler.offsets(m)[0],S=this._pan;h?S.initiate(M):S.process(M)}pinch(h){if(this._activeEvents.size!==2)return void v.log(v.LogLevel.Info,"Pinch event was canceled because less or more than two pointers were detected.");const b=Array.from(this._activeEvents.values()),m=this._eventHandler.offsets(b[0])[0],M=this._eventHandler.offsets(b[1])[0],S=this._pinch;h?S.initiate(m,M):S.process(m,M)}getPrimaryEvent(h){for(const b of h)if(b.isPrimary)return b}onPointerDown(h,b){for(const m of h)this._activeEvents.set(m.pointerId,m);switch(this._mode=this.mode(),this._mode){case s.Modes.Rotate:this.rotate(!0);break;case s.Modes.Pan:this.pan(!0);break;case s.Modes.Zoom:this.pinch(!0)}}onPointerUp(h,b){for(const m of h)this._activeEvents.delete(m.pointerId)}onPointerEnter(h,b){}onPointerLeave(h,b){for(const m of h)this._activeEvents.delete(m.pointerId)}onPointerCancel(h,b){for(const m of h)this._activeEvents.delete(m.pointerId)}onPointerMove(h,b){for(const w of h)this._activeEvents.set(w.pointerId,w);if(this._mode===void 0)return;const m=Array.from(this._activeEvents.values()),M=this.getPrimaryEvent(m);M&&M.pointerType==="mouse"&&(this._mode=this.mode());let S=!1;switch(this._mode===s.Modes.MultiTouch&&(this._mode=this.resolveMultiTouch(),S=!0),this._mode){case s.Modes.Rotate:this.rotate(S);break;case s.Modes.Pan:this.pan(S);break;case s.Modes.Zoom:this.pinch(S)}this._lastInteractionTime=performance.now()}onWheel(h,b){const m=h[0];this._wheelZoom.process(m.deltaY)}update(){this._eventHandler.update()}set camera(h){this._camera=h,this._firstPerson&&(this._firstPerson.camera=h),this._trackball&&(this._trackball.camera=h),this._turntable&&(this._turntable.camera=h),this._pan&&(this._pan.camera=h),this._pinch&&(this._pinch.camera=h),this._wheelZoom&&(this._wheelZoom.camera=h)}set rotationMetaphor(h){if(this._rotationMetaphor!==h){switch(this._firstPerson=void 0,this._trackball=void 0,this._turntable=void 0,this._eventHandler.exitPointerLock(),this._alwaysRotateOnMove=!1,this._rotationMetaphor=h,this._rotationMetaphor){case s.RotationMetaphor.FirstPerson:this._eventHandler.requestPointerLock(),this._alwaysRotateOnMove=!0,this._firstPerson=new p.FirstPersonModifier,this._firstPerson.camera=this._camera;break;case s.RotationMetaphor.Trackball:this._trackball=new n.TrackballModifier,this._trackball.camera=this._camera;break;case s.RotationMetaphor.Turntable:this._turntable=new i.TurntableModifier,this._turntable.camera=this._camera}this._invalidate(!0)}}get rotationMetaphor(){return this._rotationMetaphor}}c.Navigation=s,function(a){(function(h){h[h.Move=0]="Move",h[h.Pan=1]="Pan",h[h.MultiTouch=2]="MultiTouch",h[h.Rotate=3]="Rotate",h[h.Zoom=4]="Zoom",h[h.ZoomStep=5]="ZoomStep"})(a.Modes||(a.Modes={})),function(h){h.FirstPerson="firstperson",h.Flight="flight",h.Trackball="trackball",h.Turntable="turntable"}(a.RotationMetaphor||(a.RotationMetaphor={}))}(s=c.Navigation||(c.Navigation={}))},7429:function(x,c,_){var d=this&&this.__decorate||function(o,r,n,i){var u,s=arguments.length,a=s<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(o,r,n,i);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(a=(s<3?u(a):s>3?u(r,n,a):u(r,n))||a);return s>3&&a&&Object.defineProperty(r,n,a),a};Object.defineProperty(c,"__esModule",{value:!0}),c.NdcFillingRectangle=void 0;const l=_(6404),g=_(4894),v=_(1030);class p extends g.Geometry{constructor(r,n){super(r,n),n=n!==void 0&&n!==""?n:this.constructor.name;const i=new l.Buffer(r,`${n}VBO`);this._buffers.push(i)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0)}initialize(r=0){this._vertexLocation=r;const n=this.context.gl,i=super.initialize([n.ARRAY_BUFFER]);return this._buffers[0].data(p.VERTICES,n.STATIC_DRAW),i}draw(){const r=this.context.gl;r.drawArrays(r.TRIANGLE_STRIP,0,4)}get vertexLocation(){return this._vertexLocation}}p.VERTICES=new Float32Array([-1,-1,1,-1,-1,1,1,1]),d([v.Initializable.assert_initialized()],p.prototype,"draw",null),c.NdcFillingRectangle=p},7570:function(x,c,_){var d=this&&this.__decorate||function(o,r,n,i){var u,s=arguments.length,a=s<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(o,r,n,i);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(a=(s<3?u(a):s>3?u(r,n,a):u(r,n))||a);return s>3&&a&&Object.defineProperty(r,n,a),a};Object.defineProperty(c,"__esModule",{value:!0}),c.NdcFillingTriangle=void 0;const l=_(6404),g=_(4894),v=_(1030);class p extends g.Geometry{constructor(r,n){super(r,n),n=n!==void 0&&n!==""?n:this.constructor.name;const i=new l.Buffer(r,`${n}VBO`);this._buffers.push(i)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0)}initialize(r=0){this._vertexLocation=r;const n=this.context.gl,i=super.initialize([n.ARRAY_BUFFER]);return this._buffers[0].data(p.VERTICES,n.STATIC_DRAW),i}draw(){const r=this.context.gl;r.drawArrays(r.TRIANGLES,0,3)}get vertexLocation(){return this._vertexLocation}}p.VERTICES=new Float32Array([-1,-3,3,1,-1,1]),d([v.Initializable.assert_initialized()],p.prototype,"draw",null),c.NdcFillingTriangle=p},2281:function(x,c,_){var d=this&&this.__decorate||function(p,o,r,n){var i,u=arguments.length,s=u<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,r):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(p,o,r,n);else for(var a=p.length-1;a>=0;a--)(i=p[a])&&(s=(u<3?i(s):u>3?i(o,r,s):i(o,r))||s);return u>3&&s&&Object.defineProperty(o,r,s),s};Object.defineProperty(c,"__esModule",{value:!0}),c.AbstractObject=void 0;const l=_(9696),g=_(1030);class v extends g.Initializable{constructor(o,r){super(),this._valid=!1,this._referenceCount=0,this._context=o,this._identifier=r!==void 0&&r!==""?r:"Object"}initialize(...o){return this._identifier=this._context.allocationRegister.createUniqueIdentifier(this._identifier),this.create(...o),this._valid||(this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),l.log(l.LogLevel.Error,`initialization of '${this._identifier}' failed`)),this._valid}uninitialize(){this._context.allocationRegister.reallocate(this._identifier,0),this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),this.delete(),l.assert(this._object===void 0,`expected object '${this._identifier}' to be undefined after delete`),l.assert(this._valid===!1,`expected object '${this._identifier}' to be invalid after delete`)}get context(){return this._context}get identifier(){return this._identifier}get object(){return l.assert(this._object!==void 0,"access to undefined object"),this._object}get valid(){return this._valid}ref(){l.assert(this.initialized,"expected object to be initialized in order to be referenced"),++this._referenceCount}unref(){l.assert(this._referenceCount>0,"expected object to be referenced in order to decrease its reference count"),--this._referenceCount}}d([g.Initializable.initialize()],v.prototype,"initialize",null),d([g.Initializable.uninitialize()],v.prototype,"uninitialize",null),c.AbstractObject=v},8287:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PanModifier=void 0;const d=_(3659),l=_(2111),g=_(6491);class v extends g.CameraModifier{constructor(){super(...arguments),this._sensitivity=v.DEFAULT_SENSITIVITY,this._translation=l.v3()}initiate(o){Object.assign(this._reference,this._camera),this._initialPoint=o}process(o){this._currentPoint=o;const r=d.vec2.subtract(l.v2(),this._initialPoint,this._currentPoint);d.vec2.scale(r,r,window.devicePixelRatio*this._sensitivity);const n=d.vec3.sub(l.v3(),this._reference.eye,this._reference.center);d.vec3.normalize(n,n);const i=this._reference.up;d.vec3.normalize(i,i);const u=d.vec3.cross(l.v3(),i,n),s=d.vec3.scale(l.v3(),u,r[0]),a=d.vec3.scale(l.v3(),i,r[1]);d.vec3.negate(a,a),this._translation=d.vec3.add(l.v3(),a,s),this.update()}update(){if(this._camera===void 0)return;const o=d.mat4.fromTranslation(l.m4(),this._translation),r=d.vec3.transformMat4(l.v3(),this._reference.eye,o),n=d.vec3.transformMat4(l.v3(),this._reference.center,o);this._camera.eye=r,this._camera.center=n}}c.PanModifier=v,v.DEFAULT_SENSITIVITY=.002},8357:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PinchZoomModifier=void 0;const d=_(3659),l=_(2111),g=_(6491);class v extends g.CameraModifier{constructor(){super(...arguments),this._sensitivity=v.DEFAULT_SENSITIVITY,this._translation=l.v3()}initiate(o,r){Object.assign(this._reference,this._camera);const n=d.vec2.subtract(l.v2(),o,r);this._initialDistance=d.vec2.length(n)}process(o,r){const n=d.vec2.subtract(l.v2(),o,r);this._currentDistance=d.vec2.length(n);const i=(this._currentDistance/this._initialDistance-1)*v.DEFAULT_SENSITIVITY,u=d.vec3.sub(l.v3(),this._reference.center,this._reference.eye);d.vec3.normalize(u,u),this._translation=d.vec3.scale(l.v3(),u,i),this.update()}update(){if(this._camera===void 0)return;const o=d.mat4.fromTranslation(l.m4(),this._translation),r=d.vec3.transformMat4(l.v3(),this._reference.eye,o);this._camera.eye=r}}c.PinchZoomModifier=v,v.DEFAULT_SENSITIVITY=2},8319:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PointerEventProvider=void 0;const d=_(7318),l=_(9696),g=_(6157),v=_(9258);class p{constructor(r,n){this._pointerLockRequestPending=!1,l.assert(r!==void 0,`expected valid canvas element on initialization, given ${r}`),this._element=r,this._timeframe=n,this._element.addEventListener("click",()=>this.processPointerLockRequests()),(g.IS_EDGE||g.IS_IE11)&&this._element.addEventListener("dragstart",i=>i.preventDefault())}processPointerLockRequests(){this._pointerLockRequestPending&&v.PointerLock.request(this._element)}preventDefaultOnEvent(r,n){l.bitInBitfield(this._preventDefaultMask,r)&&n.preventDefault()}preventDefault(...r){for(const n of r)l.bitInBitfield(this._preventDefaultMask,n)||(this._preventDefaultMask|=n)}allowDefault(...r){for(const n of r)l.bitInBitfield(this._preventDefaultMask,n)&&(this._preventDefaultMask&=~n)}observable(r){switch(r){case p.Type.Enter:return this.enter$;case p.Type.Leave:return this.leave$;case p.Type.Down:return this.down$;case p.Type.Up:return this.up$;case p.Type.Move:return this.move$;case p.Type.Cancel:return this.cancel$;default:return}}set pointerLock(r){this._pointerLockRequestPending=r,r===!1&&(this._pointerLockRequestPending=!1,v.PointerLock.exit())}get pointerLock(){return v.PointerLock.active(this._element)}get enter$(){return this._enterSubject===void 0&&(this._enterSubject=new d.ReplaySubject(void 0,this._timeframe),this._enterListener=r=>{this.preventDefaultOnEvent(p.Type.Enter,r),this._enterSubject.next(r)},this._element.addEventListener("pointerenter",this._enterListener)),this._enterSubject.asObservable()}get leave$(){return this._leaveSubject===void 0&&(this._leaveSubject=new d.ReplaySubject(void 0,this._timeframe),this._leaveListener=r=>{this.preventDefaultOnEvent(p.Type.Leave,r),this._leaveSubject.next(r)},this._element.addEventListener("pointerleave",this._leaveListener)),this._leaveSubject.asObservable()}get down$(){return this._downSubject===void 0&&(this._downSubject=new d.ReplaySubject(void 0,this._timeframe),this._downListener=r=>{this.preventDefaultOnEvent(p.Type.Down,r),this._downSubject.next(r)},this._element.addEventListener("pointerdown",this._downListener)),this._downSubject.asObservable()}get up$(){return this._upSubject===void 0&&(this._upSubject=new d.ReplaySubject(void 0,this._timeframe),this._upListener=r=>{this.preventDefaultOnEvent(p.Type.Up,r),this._upSubject.next(r)},this._element.addEventListener("pointerup",this._upListener)),this._upSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new d.ReplaySubject(void 0,this._timeframe),this._moveListener=r=>{this.preventDefaultOnEvent(p.Type.Move,r),this._moveSubject.next(r)},this._element.addEventListener("pointermove",this._moveListener)),this._moveSubject.asObservable()}get cancel$(){return this._cancelSubject===void 0&&(this._cancelSubject=new d.ReplaySubject(void 0,this._timeframe),this._cancelListener=r=>{this.preventDefaultOnEvent(p.Type.Cancel,r),this._cancelSubject.next(r)},this._element.addEventListener("pointercancel",this._cancelListener)),this._cancelSubject.asObservable()}}c.PointerEventProvider=p,function(o){(function(r){r[r.Enter=1]="Enter",r[r.Leave=2]="Leave",r[r.Move=4]="Move",r[r.Down=8]="Down",r[r.Up=16]="Up",r[r.Cancel=32]="Cancel"})(o.Type||(o.Type={}))}(p=c.PointerEventProvider||(c.PointerEventProvider={}))},9258:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PointerLock=void 0;const d=_(9696);class l{static queryAndCacheAPI(){if(l._exit!==void 0)return;const v=window.document,p=[v.exitPointerLock,v.mozExitPointerLock,v.webkitExitPointerLock,void 0];let o=0;for(;o<p.length&&p[o]===void 0;++o);switch(o){case 0:l._exit=()=>v.exitPointerLock(),l._request=r=>r.requestPointerLock(),l._element=()=>v.pointerLockElement;break;case 1:l._exit=()=>v.mozCancelPointerLock(),l._request=r=>r.mozRequestPointerLock(),l._element=()=>v.mozPointerLockElement;break;case 2:l._exit=()=>v.webkitExitPointerLock(),l._request=r=>r.webkitRequestPointerLock(),l._element=()=>v.webkitPointerLockElement;break;default:d.assert(!1,"none of the following pointer lock apis was found: native, moz, or webkit")}}static active(v){return this._element!==void 0&&(v!==void 0&&l._element()===v||v===void 0&&l._element()!==void 0&&l._element()!==null)}static request(v,p){v!==void 0&&(l.queryAndCacheAPI(),l.active()&&l._element()!==v&&l._exit(),l.active()||l._request(v))}static exit(){l._exit&&l._exit()}}c.PointerLock=l},5254:function(){String.prototype.repeat===void 0&&(String.prototype.repeat=function(x){if(this===null)throw new TypeError("can't convert "+this+" to object");const c=""+this;if((x=+x)!=x&&(x=0),x<0)throw new RangeError("repeat count must be non-negative");if(x===1/0)throw new RangeError("repeat count must be less than infinity");if(x=Math.floor(x),c.length===0||x===0)return"";if(c.length*x>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");let _="";for(let d=0;d<x;d++)_+=c;return _}),String.prototype.startsWith===void 0&&(String.prototype.startsWith=function(x,c){return c=c||0,this.indexOf(x,c)===c}),String.prototype.endsWith===void 0&&(String.prototype.endsWith=function(x,c){return(c===void 0||c>this.length)&&(c=this.length),this.substring(c-x.length,c)===x}),String.prototype.includes===void 0&&(String.prototype.includes=function(x,c){return typeof c!="number"&&(c=0),!(c+x.length>this.length)&&this.indexOf(x,c)!==-1}),String.prototype.trimLeft===void 0&&(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}),String.prototype.trimRight===void 0&&(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}),Array.prototype.forEach===void 0&&(Array.prototype.forEach=(x,c)=>{const _=this.length;for(let d=0;d<_;d++)d in this&&x.call(c,this[d],d,this)}),Array.prototype.fill===void 0&&(Array.prototype.fill=(x,c,_)=>{if(this===null)throw new TypeError("this is null or not defined");const d=Object(this),l=d.length>>>0,g=c>>0;let v=g<0?Math.max(l+g,0):Math.min(g,l);const p=_===void 0?l:_>>0,o=p<0?Math.max(l+p,0):Math.min(p,l);for(;v<o;)d[v]=x,++v;return d}),Math.log10===void 0&&(Math.log10=x=>Math.log(x)*Math.LOG10E),Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),[Float32Array,Uint8Array,Int8Array,Uint32Array,Int32Array].forEach(x=>{x.prototype.slice||Object.defineProperty(x.prototype,"slice",{value:Array.prototype.slice}),x.prototype.reduce||Object.defineProperty(x.prototype,"reduce",{value:Array.prototype.reduce}),x.prototype.filter||Object.defineProperty(x.prototype,"filter",{value:Array.prototype.filter}),x.prototype.map||Object.defineProperty(x.prototype,"map",{value:Array.prototype.map}),x.prototype.indexOf||Object.defineProperty(x.prototype,"indexOf",{value:Array.prototype.indexOf})}),Object.assign===void 0&&Object.defineProperty(Object,"assign",{value(x,c){if(x===void 0&&x===null)throw new TypeError("Cannot convert undefined or null to object");const _=Object(x);for(let d=1;d<arguments.length;d++){const l=arguments[d];if(l!=null)for(const g in l)Object.prototype.hasOwnProperty.call(l,g)&&(_[g]=l[g])}return _},configurable:!0,writable:!0})},4895:function(x,c,_){var d=this&&this.__decorate||function(o,r,n,i){var u,s=arguments.length,a=s<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(o,r,n,i);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(a=(s<3?u(a):s>3?u(r,n,a):u(r,n))||a);return s>3&&a&&Object.defineProperty(r,n,a),a};Object.defineProperty(c,"__esModule",{value:!0}),c.Program=void 0;const l=_(9696),g=_(1030),v=_(2281);class p extends v.AbstractObject{constructor(){super(...arguments),this._shaders=new Array,this._linked=!1}create(r=new Array,n=!0){const i=this._context.gl;let u=0,s=0;for(const a of r)switch(a.type){case i.VERTEX_SHADER:++u;break;case i.FRAGMENT_SHADER:++s;break;default:l.assert(!1,"Unknown shader type detected.")}if(l.logIf(u<1,l.LogLevel.Error,"at least one vertex shader is expected"),l.logIf(s<1,l.LogLevel.Error,"at least one fragment shader is expected"),!(u<1||s<1))return this._object=i.createProgram(),this._valid=i.isProgram(this._object),l.assert(this._object instanceof WebGLProgram,"expected WebGLProgram object to be created"),r.length>0&&this.attach(r,n),this._object}delete(){l.assert(this._object!==void 0,"expected WebGLProgram object"),this._context.gl.deleteProgram(this._object),this._object=void 0,this._valid=!1}attach(r,n=!1){l.assert(this._object!==void 0,"expected a WebGLProgram object");const i=this._context.gl;for(const u of r instanceof Array?r:[r])this._shaders.indexOf(u)>-1||(this._shaders.push(u),u.initialized?(i.attachShader(this._object,u.object),u.ref()):l.log(l.LogLevel.Error,`shader '${u.identifier}' not initialized.`));return n&&this.link(),!0}detach(r){l.assert(this._object!==void 0,"expected WebGLProgram object");const n=this._context.gl;for(const i of r instanceof Array?r:[r]){const u=this._shaders.indexOf(i);u>-1&&this._shaders.splice(u),l.assert(i.initialized,`expected shader '${i.identifier}' to be initialized`),n.detachShader(this._object,i.object),i.unref()}}link(){l.assert(this._object!==void 0,"expected WebGLProgram object");const r=this._context.gl;if(r.linkProgram(this._object),r.getProgramParameter(this._object,r.LINK_STATUS))this._linked=!0;else{const n=r.getProgramInfoLog(this._object);l.log(l.LogLevel.Error,`linking of program '${this._identifier}' failed: '${n}'`),this._linked=!1}return this._linked}bind(){this._context.gl.useProgram(this._object)}unbind(){this._context.gl.useProgram(p.DEFAULT_PROGRAM)}uniform(r){return this._context.gl.getUniformLocation(this._object,r)}attribute(r,n){return n!==void 0?(l.logIf(this._linked,l.LogLevel.Debug,`name-to-generic attribute index mapping does go into effect on next linking, given ${r} -> ${n} (${this.identifier})`),this._context.gl.bindAttribLocation(this._object,n,r),n):this._context.gl.getAttribLocation(this._object,r)}get shaders(){return this._shaders}get linked(){return this._linked}}p.DEFAULT_PROGRAM=void 0,d([g.Initializable.assert_initialized()],p.prototype,"bind",null),d([g.Initializable.assert_initialized()],p.prototype,"unbind",null),d([g.Initializable.assert_initialized()],p.prototype,"uniform",null),d([g.Initializable.assert_initialized()],p.prototype,"attribute",null),c.Program=p},3607:(x,c,_)=>{const d=_(634),l=_(9696);function g(o,r){const n=r.properties,i=Object.getOwnPropertyNames(n);for(const u of i){const s=n[u],a=s.type==="object",h=o.hasOwnProperty(u),b=s.hasOwnProperty("properties"),m=s.hasOwnProperty("default");l.assert(b&&a||!b&&!a,`expected property '${u}' to be of type 'object', given '${s.type}'`),h&&b?p.complement(o[u],s):!h&&m&&Object.defineProperty(o,u,{value:s.default,writable:!0})}}function v(o,r){const n=r.items;if(n.type==="object")for(const i of Object.getOwnPropertyNames(o))i!=="length"&&p.complement(o[i],n)}var p;(function(o){o.validate=function(r,n,i){const u=new d.Validator;if(i!==void 0)for(const a of i)u.addSchema(a[0],a[1]);const s=u.validate(r,n);return l.logIf(!s.valid,l.LogLevel.Warning,`schema expected to be valid:
${s.toString()}`),s.valid},o.complement=function(r,n){if(r!==void 0)switch(l.assert(n.hasOwnProperty("properties")&&n.type==="object"||n.hasOwnProperty("items")&&n.type==="array",`expected schema to have 'properties' or 'items', given ${n}`),n.type){case"object":g(r,n);break;case"array":v(r,n)}},o.compare=function r(n,i,u,s=""){const a=u!==void 0;if(l.assert(!a||u.hasOwnProperty("any"),"expected allocation lookup object to have 'any' key"),n===void 0&&i!==void 0||n!==void 0&&i===void 0)return a&&u.alter(s),!0;let h=!0,b=[typeof n,typeof i];const m=[n instanceof Array,i instanceof Array];if(!(m[0]&&m[1]||b[0]==="object"&&b[1]==="object"))return h=n===i,!h&&a&&u.alter(`${s}`),!h;const M=Array.from(new Set(Array().concat(Object.getOwnPropertyNames(n),Object.getOwnPropertyNames(i))).values());for(const S of M){if(S==="length")continue;const w=[n[S],i[S]];b=[typeof w[0],typeof w[1]];const N=`${s}${s.length>0&&!m[0]?".":""}${m[0]?"":S}`;if(w[0]instanceof Array&&w[1]instanceof Array||b[0]==="object"&&b[1]==="object")h=h&&!r(w[0],w[1],u,N);else{if(b[0]===b[1]&&w[0]===w[1])continue;h=!1,a&&u.alter(N)}}return!h}})(p||(p={})),x.exports=p},5785:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.RandomSquareKernel=void 0;const d=_(9696),l=_(4563);class g extends l.KernelF32{constructor(p){super(2,p),this.generate()}generate(){d.assert(this.width>0,"expected every kernel to comprise at least one element"),this.set([0,0],0);for(let p=1;p<this.width;++p)this.set([d.rand(-.5,.5),d.rand(-.5,.5)],p)}get width(){return this._width}set width(p){this._width!==p&&(this._width=p,this.resize(),this.generate())}}c.RandomSquareKernel=g},3942:(x,c,_)=>{const d=_(3659),l=_(2111),g=_(9696);var v;(function(p){function o(u,s,a=1){const h=d.vec2.subtract(l.v2(),s,u);if(d.vec2.equals(h,d.vec2.fromValues(0,0)))return;const b=d.vec2.squaredLength(h),m=2*d.vec2.dot(h,u),M=m*m-4*b*(d.vec2.squaredLength(u)-a*a);if(M<0)return;const S=Math.sqrt(M),w=Math.min((-m+S)/(2*b),(-m-S)/(2*b)),N=d.vec2.scale(l.v2(),h,w);return d.vec2.add(N,N,u)}function r(u,s,a,h){const b=u,m=d.vec2.sub(l.v2(),s,u),M=a,S=d.vec2.sub(l.v2(),h,a),w=d.vec2.cross(l.v3(),m,S)[2];if(w===0)return;const N=d.vec2.sub(l.v2(),M,b),F=d.vec2.cross(l.v3(),N,d.vec2.scale(l.v2(),m,1/w))[2],k=d.vec2.cross(l.v3(),N,d.vec2.scale(l.v2(),S,1/w))[2];return F<0||F>1||k<0?void 0:[d.vec2.add(l.v2(),M,d.vec2.scale(l.v2(),S,F)),k]}function n(u,s,a=d.vec3.fromValues(0,0,0),h=d.vec3.fromValues(0,1,0)){const b=d.vec3.normalize(l.v3(),d.vec3.subtract(l.v3(),s,u)),m=d.vec3.dot(b,h);if(d.vec3.equals(b,[0,0,0])||m>=0)return;const M=d.vec3.dot(d.vec3.subtract(l.v3(),a,u),h)/m;return d.vec3.add(l.v3(),d.vec3.scale(l.v3(),b,M),u)}function i(u,s,a){const h=d.vec3.subtract(l.v3(),s,u),b=d.vec3.squaredLength(h);if(b===0)return 0;const m=d.vec3.subtract(l.v3(),a,u);return d.vec3.dot(m,h)/b}p.rayCircleIntersection=o,p.pointSquareIntersection=function(u,s=1){const a=l.abs2(l.v2(),u);return a[0]>=a[1]?d.vec2.fromValues(l.sign(u[0])*s,u[1]/a[0]*s):d.vec2.fromValues(u[0]/a[1]*s,l.sign(u[1])*s)},p.raySquareIntersection=function(u,s,a=1){const h=[d.vec2.fromValues(-a,+a),d.vec2.fromValues(-a,-a),d.vec2.fromValues(+a,-a),d.vec2.fromValues(+a,+a)],b=new Array;for(let m=0;m<4;++m){const M=r(u,s,h[m],h[(m+1)%4]);M&&b.push(M[1])}return b},p.rayLineIntersection=r,p.rayPlaneIntersection=n,p.raySphereIntersection=function(u,s,a=d.vec3.fromValues(0,0,0),h=1){const b=d.vec3.subtract(l.v3(),u,a),m=d.vec3.normalize(l.v3(),d.vec3.subtract(l.v3(),s,u)),M=d.vec3.dot(m,b),S=M*M-d.vec3.squaredLength(b)+h*h;if(!(S<=0))return d.vec3.add(l.v3(),u,d.vec3.scale(l.v3(),m,-M-Math.sqrt(S)))},p.rayPlaneIntersection_tube=function(u,s,a=1){const h=n(u,s);if(h!==void 0&&d.vec3.length(h)<a)return h;const b=o(d.vec2.fromValues(u[0],u[2]),d.vec2.fromValues(s[0],s[2]),a);return b?d.vec3.fromValues(b[0],0,b[1]):void 0},p.isPointWithinSquare=function(u,s=1){const a=l.abs2(l.v2(),u);return a[0]<=s&&a[1]<=s},p.isPointWithinNDC=function(u,s){const a=d.vec3.transformMat4(l.v3(),s,u),h=l.abs3(l.v3(),a);return h[0]<=1&&h[1]<=1&&a[2]>=0&&a[2]<=1},p.distancePointToRay=i,p.eyeWithPointInView=function(u,s){const a=d.vec3.subtract(l.v3(),u.center,u.eye),h=d.vec3.normalize(l.v3(),a),b=d.vec3.normalize(l.v3(),d.vec3.cross(l.v3(),h,u.up)),m=d.vec3.normalize(l.v3(),d.vec3.cross(l.v3(),b,h)),M=i(u.eye,u.center,s),S=d.vec3.add(l.v3(),u.eye,d.vec3.scale(l.v3(),a,M)),w=d.vec3.subtract(l.v3(),s,S),N=Math.abs(d.vec3.dot(w,b))/u.aspect,F=Math.abs(d.vec3.dot(w,m)),k=Math.max(N,F)/Math.tan(u.fovy*g.DEG2RAD*.5);return d.vec3.subtract(l.v3(),S,d.vec3.scale(l.v3(),h,k))}})(v||(v={})),x.exports=v},9314:function(x,c,_){var d=this&&this.__decorate||function(a,h,b,m){var M,S=arguments.length,w=S<3?h:m===null?m=Object.getOwnPropertyDescriptor(h,b):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(a,h,b,m);else for(var N=a.length-1;N>=0;N--)(M=a[N])&&(w=(S<3?M(w):S>3?M(h,b,w):M(h,b))||w);return S>3&&w&&Object.defineProperty(h,b,w),w};Object.defineProperty(c,"__esModule",{value:!0}),c.ReadbackPass=void 0;const l=_(3659),g=_(9696),v=_(2111),p=_(9564),o=_(1030),r=_(7570),n=_(4895),i=_(5263),u=_(6942);class s extends o.Initializable{constructor(h){super(),this._cache=!1,this._depthAttachment=0,this._cachedDepths=new Map,this._cachedIDs=new Map,this._buffer=new Uint8Array(4),this._ndcTriangleShared=!1,this._context=h}static maxClearDepth(){return v.decode_float24x1_from_uint8x3(l.vec3.fromValues(255,255,255))}onFrame(){this._cachedDepths.clear(),this._cachedIDs.clear()}hash(h,b){return 65535*b+h}directReadDepthAt(h,b){g.assert(this._depthFBO!==void 0&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");const m=this._depthFBO.texture(this._depthAttachment),M=this._context.gl,S=m.size;this._depthFBO.bind();const w=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]];return(this._context.isWebGL2||this._context.supportsDrawBuffers)&&M.readBuffer(this._depthAttachment),M.readPixels(h*w[0],S[1]-b*w[1],1,1,M.RGBA,M.UNSIGNED_BYTE,this._buffer),this._buffer}renderThenReadDepthAt(h,b){g.assert(this._depthFBO!==void 0&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");const m=this._depthFBO.texture(this._depthAttachment),M=this._context.gl,S=m.size,w=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]];return M.viewport(0,0,1,1),this._program.bind(),M.uniform2f(this._uOffset,h*w[0]/S[0],(S[1]-b*w[1])/S[1]),M.uniform2f(this._uScale,1/S[0],1/S[1]),m.bind(M.TEXTURE0),this._framebuffer.bind(),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),m.unbind(),(this._context.isWebGL2||this._context.supportsDrawBuffers)&&M.readBuffer&&M.readBuffer(M.COLOR_ATTACHMENT0),M.readPixels(0,0,1,1,M.RGBA,M.UNSIGNED_BYTE,this._buffer),this._framebuffer.unbind(),this._buffer}initialize(h,b){const m=this._context.gl,M=this._context.gl2facade;if(b)return this.readDepthAt=this.directReadDepthAt,!0;this.readDepthAt=this.renderThenReadDepthAt;const S=new i.Shader(this._context,m.VERTEX_SHADER,"ndcvertices.vert (readback)");S.initialize(_(3643));const w=new i.Shader(this._context,m.FRAGMENT_SHADER,"readbackdepth.frag");return w.initialize(_(5081)),this._program=new n.Program(this._context,"ReadbackDepthProgram"),this._program.initialize([S,w],!1),h===void 0?this._ndcTriangle=new r.NdcFillingTriangle(this._context):(this._ndcTriangle=h,this._ndcTriangleShared=!0),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uOffset=this._program.uniform("u_offset"),this._program.bind(),m.uniform1i(this._program.uniform("u_texture"),0),this._program.unbind(),this._texture=new u.Texture2D(this._context,"ReadbackRenderTexture"),this._texture.initialize(1,1,m.RGBA,m.RGBA,m.UNSIGNED_BYTE),this._framebuffer=new p.Framebuffer(this._context,"ReadbackFBO"),this._framebuffer.initialize([[M.COLOR_ATTACHMENT0,this._texture]]),!0}uninitialize(){this._context.isWebGL1&&!this._context.supportsDepthTexture||(!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._texture.uninitialize(),this._framebuffer.uninitialize())}depthAt(h,b){const m=this.hash(h,b);if(this._cache&&this._cachedDepths.has(m))return this._cachedDepths.get(m);const M=this.readDepthAt(h,b),S=M[0]===255&&M[1]===255&&M[2]===255?void 0:v.decode_float24x1_from_uint8x3(l.vec3.fromValues(M[0],M[1],M[2]));return this._cache&&this._cachedDepths.set(m,S),S}coordsAt(h,b,m,M){const S=this._depthFBO.texture(this._depthAttachment).size,w=m===void 0?this.depthAt(h,b):m;if(w===void 0)return;const N=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]],F=l.vec3.fromValues(h*N[0]*2/S[0]-1,1-b*N[1]*2/S[1],2*w-1);return l.vec3.transformMat4(l.vec3.create(),F,M)}idAt(h,b){const m=this.hash(h,b);if(this._cache&&this._cachedIDs.has(m))return this._cachedIDs.get(m);const M=this._context.gl,S=this._idFBO.texture(this._idAttachment).size,w=this._referenceSize===void 0?[1,1]:[S[0]/this._referenceSize[0],S[1]/this._referenceSize[1]];this._idFBO.bind(),this._context.isWebGL2&&M.readBuffer(this._idAttachment),M.readPixels(h*w[0],S[1]-b*w[1],1,1,M.RGBA,M.UNSIGNED_BYTE,this._buffer);const N=v.decode_uint32_from_rgba8(l.vec4.fromValues(this._buffer[0],this._buffer[1],this._buffer[2],this._buffer[3]));return this._cache&&this._cachedIDs.set(m,N),N}frame(){this.onFrame()}set cache(h){this._cache=h}set depthFBO(h){this._depthFBO=h}set depthAttachment(h){this._depthAttachment=h}set idFBO(h){this._idFBO=h}set idAttachment(h){this._idAttachment=h}set coordinateReferenceSize(h){this._referenceSize=h}}d([o.Initializable.assert_initialized()],s.prototype,"directReadDepthAt",null),d([o.Initializable.assert_initialized()],s.prototype,"renderThenReadDepthAt",null),d([o.Initializable.initialize()],s.prototype,"initialize",null),d([o.Initializable.uninitialize()],s.prototype,"uninitialize",null),d([o.Initializable.assert_initialized()],s.prototype,"depthAt",null),d([o.Initializable.assert_initialized()],s.prototype,"coordsAt",null),d([o.Initializable.assert_initialized()],s.prototype,"idAt",null),c.ReadbackPass=s},7540:function(x,c,_){var d=this&&this.__decorate||function(r,n,i,u){var s,a=arguments.length,h=a<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,i):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,n,i,u);else for(var b=r.length-1;b>=0;b--)(s=r[b])&&(h=(a<3?s(h):a>3?s(n,i,h):s(n,i))||h);return a>3&&h&&Object.defineProperty(n,i,h),h};Object.defineProperty(c,"__esModule",{value:!0}),c.Renderbuffer=void 0;const l=_(9696),g=_(423),v=_(1030),p=_(2281);class o extends p.AbstractObject{constructor(){super(...arguments),this._internalFormat=void 0}create(n,i,u,s=1){l.assert(n>0&&i>0,"renderbuffer object requires valid width and height greater than zero");const a=this.context.gl;this._object=a.createRenderbuffer(),this._width=n,this._height=i,this._internalFormat=u,this._samples=s,a.bindRenderbuffer(a.RENDERBUFFER,this._object),this._samples>1?a.renderbufferStorageMultisample(a.RENDERBUFFER,this._samples,u,n,i):a.renderbufferStorage(a.RENDERBUFFER,u,n,i),this._valid=a.isRenderbuffer(this._object),a.bindRenderbuffer(a.RENDERBUFFER,o.DEFAULT_RENDER_BUFFER);const h=n*i*g.byteSizeOfFormat(this.context,u);return this.context.allocationRegister.reallocate(this._identifier,h),this._object}delete(){l.assert(this._object instanceof WebGLRenderbuffer,"expected WebGLRenderbuffer object"),this.context.gl.deleteRenderbuffer(this._object),this._object=void 0,this._valid=!1,this._internalFormat=void 0,this._width=0,this._height=0}bind(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,this._object)}unbind(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,o.DEFAULT_RENDER_BUFFER)}resize(n,i,u=!1,s=!1){if(n===this._width&&i===this._height)return;this._width=n,this._height=i;const a=this.context.gl;u&&this.bind(),this._samples>1?a.renderbufferStorageMultisample(a.RENDERBUFFER,this._samples,this._internalFormat,n,i):a.renderbufferStorage(a.RENDERBUFFER,this._internalFormat,n,i),s&&this.unbind();const h=n*i*g.byteSizeOfFormat(this.context,this._internalFormat);this.context.allocationRegister.reallocate(this._identifier,h)}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get samples(){return this.assertInitialized(),this._samples}get multisampling(){return this.assertInitialized(),this._samples>1}get size(){return[this.width,this.height]}}o.DEFAULT_RENDER_BUFFER=void 0,d([v.Initializable.assert_initialized()],o.prototype,"bind",null),d([v.Initializable.assert_initialized()],o.prototype,"unbind",null),d([v.Initializable.assert_initialized()],o.prototype,"resize",null),c.Renderbuffer=o},3205:function(x,c,_){var d=this&&this.__decorate||function(a,h,b,m){var M,S=arguments.length,w=S<3?h:m===null?m=Object.getOwnPropertyDescriptor(h,b):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(a,h,b,m);else for(var N=a.length-1;N>=0;N--)(M=a[N])&&(w=(S<3?M(w):S>3?M(h,b,w):M(h,b))||w);return S>3&&w&&Object.defineProperty(h,b,w),w};Object.defineProperty(c,"__esModule",{value:!0}),c.Renderer=c.LoadingStatus=void 0;const l=_(7318),g=_(3659),v=_(9696),p=_(2111),o=_(4597),r=_(1030),n=_(4934),i=_(1284);var u;(function(a){a[a.Started=0]="Started",a[a.Finished=1]="Finished"})(u=c.LoadingStatus||(c.LoadingStatus={}));class s extends r.Initializable{constructor(){super(...arguments),this._altered=Object.assign(new o.ChangeLookup,{any:!1,multiFrameNumber:!1,frameSize:!1,canvasSize:!1,framePrecision:!1,clearColor:!1,debugTexture:!1}),this._frameSize=[0,0],this._canvasSize=[0,0],this._framePrecision=i.Wizard.Precision.half,this._clearColor=[0,0,0,1],this._debugTextures=new Array,this._debugTextureSubject=new l.ReplaySubject(1)}invalidate(h=!1){this._invalidate(h)}debugTextureNext(){this._debugTextureSubject.next(this._debugTexture)}get context(){return this.assertInitialized(),this._context}get canvasSize(){return this.assertInitialized(),this._canvasSize}get altered(){return this._altered.any}onSwap(){}startLoading(){this._isLoading=!0,this._loadingStatusSubscription.next(u.Started)}finishLoading(){this._isLoading=!1,this._loadingStatusSubscription.next(u.Finished)}initialize(h,b,m){return v.assert(h!==void 0,"valid webgl context required"),this._context=h,v.assert(b!==void 0,"valid multi-frame update callback required"),this._invalidate=b,this._isLoading=!0,this._loadingStatusSubscription=new l.ReplaySubject,this.onInitialize(h,b,m)}uninitialize(){this.onUninitialize()}discard(){this.onDiscarded()}update(h){return this._canvasSize[0]===this._context.gl.canvas.width&&this._canvasSize[1]===this._context.gl.canvas.height||(this._canvasSize[0]=this._context.gl.canvas.width,this._canvasSize[1]=this._context.gl.canvas.height,this._altered.alter("canvasSize")),this._multiFrameNumber!==h&&(this._multiFrameNumber=h,this._altered.alter("multiFrameNumber")),this.onUpdate()||this._altered.any}prepare(){this.onPrepare()}frame(h){this.onFrame(h)}swap(){this.onSwap()}frameCoords(h,b){const m=g.vec2.divide(p.v2(),this._frameSize,this.canvasSize);return g.vec2.floor(m,g.vec2.multiply(m,[h+.5,b+.5],m)),g.vec2.add(m,m,[.5,.5]),n.tuple2(m)}set frameSize(h){this.assertInitialized(),g.vec2.equals(this._frameSize,h)||(Object.assign(this._frameSize,h),this._altered.alter("frameSize"),this.invalidate())}set framePrecision(h){this.assertInitialized(),this._framePrecision!==h&&(this._framePrecision=h,this._altered.alter("framePrecision"),this.invalidate())}set clearColor(h){this.assertInitialized(),g.vec4.equals(this._clearColor,h)||(Object.assign(this._clearColor,h),this._altered.alter("clearColor"),this.invalidate())}get debugTextures(){return this.assertInitialized(),this._debugTextures}get debugTexture(){return this.assertInitialized(),this._debugTexture}set debugTexture(h){this.assertInitialized(),this._debugTexture!==h&&(v.logIf(h>=this._debugTextures.length,v.LogLevel.Error,`invalid texture index, debug texture disabled (index set to -1) | ${h} not in [-1,+${this._debugTextures.length-1}]`),this._debugTexture=h<this._debugTextures.length?p.clamp(h,-1,this._debugTextures.length-1):-1,this._altered.alter("debugTexture"),this.invalidate())}get debugTexture$(){return this._debugTextureSubject.asObservable()}get isLoading(){return this._isLoading}get loadingStatus$(){return this._loadingStatusSubscription.asObservable()}}d([r.Initializable.assert_initialized()],s.prototype,"invalidate",null),d([r.Initializable.initialize()],s.prototype,"initialize",null),d([r.Initializable.uninitialize()],s.prototype,"uninitialize",null),d([r.Initializable.discard()],s.prototype,"discard",null),d([r.Initializable.assert_initialized()],s.prototype,"update",null),d([r.Initializable.assert_initialized()],s.prototype,"prepare",null),d([r.Initializable.assert_initialized()],s.prototype,"frame",null),d([r.Initializable.assert_initialized()],s.prototype,"swap",null),c.Renderer=s},6346:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Resizable=void 0;const d=_(9696);class l{constructor(){if(this._resizeEventListener=()=>l.resize(),this._mutationEventListener=()=>{this._mutationObserver.takeRecords(),l.resize()},l.instances.length===0){const v=`on${l.EVENT_IDENTIFIER}`;l.eventSupported=document&&(v in document.documentElement||v in document.body),d.logIf(!l.eventSupported,d.LogLevel.Warning,"resize event not supported")}l.instances.length===0&&l.eventSupported&&window.addEventListener(l.EVENT_IDENTIFIER,this._resizeEventListener),l.instances.push(this)}static resize(){d.assert(l.instances.length>0,"resize event received without a single resizable registered"),l.instances.forEach(v=>v.onResize())}static elementSize(v){if(v===void 0||window===void 0||typeof window.devicePixelRatio!="number")return[0,0];const p=window.devicePixelRatio,o=getComputedStyle(v);if(o.width===null||!o.width.endsWith("px")||o.height===null||!o.height.endsWith("px"))return void d.log(d.LogLevel.Debug,`computed element size expected in 'px', given ${o.width} ${o.height}`);const r=[parseFloat(o.width),parseFloat(o.height)];return[Math.round(r[0]*p),Math.round(r[1]*p)]}observe(v){v!==void 0&&(this._mutationObserver=new MutationObserver(this._mutationEventListener)),this._mutationObserver.observe(v,l.MUTATION_OBSERVER_CONFIG)}dispose(){const v=l.instances.indexOf(this);d.assert(v!==-1,"invalid reference counting of resizable instances"),l.instances.splice(v,1),l.instances.length===0&&l.eventSupported&&window.removeEventListener(l.EVENT_IDENTIFIER,this._resizeEventListener),this._mutationObserver&&this._mutationObserver.disconnect()}}c.Resizable=l,l.EVENT_IDENTIFIER="resize",l.instances=[],l.eventSupported=!1,l.MUTATION_OBSERVER_CONFIG={attributes:!0,attributeFilter:["style","class"],childList:!0,subtree:!0}},9092:function(x,c,_){var d=this&&this.__decorate||function(n,i,u,s){var a,h=arguments.length,b=h<3?i:s===null?s=Object.getOwnPropertyDescriptor(i,u):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(n,i,u,s);else for(var m=n.length-1;m>=0;m--)(a=n[m])&&(b=(h<3?a(b):h>3?a(i,u,b):a(i,u))||b);return h>3&&b&&Object.defineProperty(i,u,b),b};Object.defineProperty(c,"__esModule",{value:!0}),c.ForwardSceneRenderPass=void 0;const l=_(3659),g=_(9696),v=_(4597),p=_(1030),o=_(3946);class r extends o.SceneRenderPass{constructor(i){super(),this._altered=Object.assign(new v.ChangeLookup,{any:!1,camera:!1}),this._context=i,this._opaqueGeometryMap=new Map,this._transparentGeometryMap=new Map}preprocessScene(){g.assert(this._scene!==void 0,"Scene was undefined during preprocessing."),this._scene!==void 0&&(this._opaqueGeometryMap.clear(),this._transparentGeometryMap.clear(),this.preprocessNode(this._scene,l.mat4.create()))}preprocessNode(i,u){const s=l.mat4.clone(u),a=i.componentsOfType("TransformComponent");if(g.assert(a.length<=1,"SceneNode can not have more than one transform component"),a.length===1){const b=a[0];l.mat4.mul(s,s,b.transform)}const h=i.componentsOfType("GeometryComponent");for(const b of h){const m=b,M=m.material,S=m.geometry;if(M.isTransparent){let w=this._transparentGeometryMap.get(M);w===void 0&&(w=[]),w.push([S,s]),this._transparentGeometryMap.set(M,w)}else{let w=this._opaqueGeometryMap.get(M);w===void 0&&(w=[]),w.push([S,s]),this._opaqueGeometryMap.set(M,w)}}if(i.nodes!==void 0)for(const b of i.nodes)this.preprocessNode(b,s)}renderGeometryMap(i){for(const u of Array.from(i.keys())){this.bindMaterial(u);const s=i.get(u);for(const[a,h]of s)a.bind(),this.bindGeometry!==void 0&&this.bindGeometry(a),this.updateModelTransform(h),a.draw(),a.unbind()}}initialize(){return!0}uninitialize(){}prepare(){}update(i=!1){}frame(){if(g.assert(this._target&&this._target.valid,"valid target expected"),g.assert(this._program&&this._program.valid,"valid program expected"),g.assert(this.updateModelTransform!==void 0,"Model transform function needs to be initialized."),g.assert(this.updateViewProjectionTransform!==void 0,"View Projection transform function needs to be initialized."),g.assert(this.bindMaterial!==void 0,"Material binding function needs to be initialized."),this._scene===void 0)return;const i=this._context.gl;i.enable(i.DEPTH_TEST);const u=this._target.size;i.viewport(0,0,u[0],u[1]);const s=this._clearColor;i.clearColor(s[0],s[1],s[2],s[3]),this._target.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT,!0,!1),this._program.bind(),this.bindUniforms!==void 0&&this.bindUniforms(),this.updateViewProjectionTransform(this._camera.viewProjection),this.drawCalls(),this._program.unbind(),i.disable(i.BLEND)}drawCalls(i=!0){this._scene!==void 0&&(this.renderGeometryMap(this._opaqueGeometryMap),i&&this.renderGeometryMap(this._transparentGeometryMap))}set target(i){this.assertInitialized(),this._target=i}set ndcOffset(i){this.assertInitialized(),this._ndcOffset=i}set camera(i){this.assertInitialized(),this._camera!==i&&(this._camera=i,this._altered.alter("camera"))}set clearColor(i){this._clearColor=i}set program(i){this._program=i}}d([p.Initializable.initialize()],r.prototype,"initialize",null),d([p.Initializable.uninitialize()],r.prototype,"uninitialize",null),d([p.Initializable.assert_initialized()],r.prototype,"update",null),d([p.Initializable.assert_initialized()],r.prototype,"frame",null),d([p.Initializable.assert_initialized()],r.prototype,"drawCalls",null),c.ForwardSceneRenderPass=r},4614:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GeometryComponent=void 0;const d=_(922);class l extends d.SceneNodeComponent{constructor(){super("GeometryComponent")}set geometry(v){this._geometry=v}get geometry(){return this._geometry}set material(v){this._material=v}get material(){return this._material}}c.GeometryComponent=l},9922:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SceneRenderPass=c.Material=c.GeometryComponent=c.TransformComponent=c.SceneNodeComponent=c.SceneNode=c.ForwardSceneRenderPass=void 0;var d=_(9092);Object.defineProperty(c,"ForwardSceneRenderPass",{enumerable:!0,get:function(){return d.ForwardSceneRenderPass}});var l=_(9981);Object.defineProperty(c,"SceneNode",{enumerable:!0,get:function(){return l.SceneNode}});var g=_(922);Object.defineProperty(c,"SceneNodeComponent",{enumerable:!0,get:function(){return g.SceneNodeComponent}});var v=_(8425);Object.defineProperty(c,"TransformComponent",{enumerable:!0,get:function(){return v.TransformComponent}});var p=_(4614);Object.defineProperty(c,"GeometryComponent",{enumerable:!0,get:function(){return p.GeometryComponent}});var o=_(9699);Object.defineProperty(c,"Material",{enumerable:!0,get:function(){return o.Material}});var r=_(3946);Object.defineProperty(c,"SceneRenderPass",{enumerable:!0,get:function(){return r.SceneRenderPass}})},9699:(x,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Material=void 0,c.Material=class{constructor(_,d){this._context=_,this._name=d,this._isTransparent=!1}get name(){return this._name}get isTransparent(){return this._isTransparent}set isTransparent(_){this._isTransparent=_}}},9981:(x,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SceneNode=void 0,c.SceneNode=class{constructor(_){this._nodes=new Array,this._components=new Array,this._name=_,this._parent=void 0}traverse(_){_(this);for(const d of this._nodes)d.traverse(_)}addNode(_){return _._parent=this,this._nodes.push(_),_}addComponent(_){return this._components.push(_),_}componentsOfType(_){return this._components.filter(d=>_===d.type)}get name(){return this._name}get parent(){return this._parent}get nodes(){return this._nodes}get components(){return this._components}get isLeaf(){return this._nodes.length===0}get isRoot(){return this._parent===void 0}}},922:(x,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SceneNodeComponent=void 0,c.SceneNodeComponent=class{constructor(_){this._type=_}get type(){return this._type}}},3946:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SceneRenderPass=void 0;const d=_(1030);class l extends d.Initializable{set scene(v){this._scene=v,this._scene!==void 0&&this.preprocessScene()}get scene(){return this._scene}}c.SceneRenderPass=l},8425:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TransformComponent=void 0;const d=_(922);class l extends d.SceneNodeComponent{constructor(v){super("TransformComponent"),this._transform=v}get transform(){return this._transform}}c.TransformComponent=l},5263:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Shader=void 0;const d=_(9696),l=_(2281);class g extends l.AbstractObject{constructor(p,o,r){super(p,r),this._compiled=!1;const n=p.gl;if(r===void 0)switch(o){case p.gl.FRAGMENT_SHADER:r="FragmentShader";break;case p.gl.VERTEX_SHADER:r="VertexShader";break;default:d.assert(!1,`expected either a FRAGMENT_SHADER (${n.FRAGMENT_SHADER}) or a VERTEX_SHADER (${n.VERTEX_SHADER}), given ${o}`)}this._type=o}create(p,o=!0){const r=this._context.gl;return this._object=r.createShader(this._type),this._valid=r.isShader(this._object),this._compiled=!1,d.assert(this._object instanceof WebGLShader,"expected WebGLShader object to be created"),p&&(this.source=p),p&&o&&this.compile(),this._object}delete(){d.assert(this._object!==void 0,"expected WebGLShader object"),this._context.gl.deleteShader(this._object),this._object=void 0,this._valid=!1,this._compiled=!1}compile(){const p=this._context.gl;let o=this.sourceWithReplacements;if(this._context.isWebGL2&&(o=`#version 300 es
${o}`),p.shaderSource(this._object,o),p.compileShader(this._object),this._compiled=p.getShaderParameter(this._object,p.COMPILE_STATUS),!this._compiled){const r=p.getShaderInfoLog(this._object);d.log(d.LogLevel.Error,`compilation of shader '${this._identifier}' failed: ${r}`)}}replace(p,o){this._replacements===void 0&&(this._replacements=new Map),this._replacements.set(p,o)}get type(){return this.assertInitialized(),this._type}set source(p){this._source!==p&&(this._source=p)}get source(){return this.assertInitialized(),this._source}get sourceWithReplacements(){if(this._replacements===void 0)return this._source;let p=this._source;return this._replacements.forEach((o,r)=>{const n=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");p=p.replace(new RegExp(n,"g"),o)}),p}get compiled(){return this.assertInitialized(),this._compiled}}c.Shader=g},6210:function(x,c,_){var d=this&&this.__decorate||function(u,s,a,h){var b,m=arguments.length,M=m<3?s:h===null?h=Object.getOwnPropertyDescriptor(s,a):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(u,s,a,h);else for(var S=u.length-1;S>=0;S--)(b=u[S])&&(M=(m<3?b(M):m>3?b(s,a,M):b(s,a))||M);return m>3&&M&&Object.defineProperty(s,a,M),M};Object.defineProperty(c,"__esModule",{value:!0}),c.ShadowPass=void 0;const l=_(9696),g=_(9564),v=_(5714),p=_(1030),o=_(7540),r=_(6942),n=_(1284);class i extends p.Initializable{constructor(s){super(),this._gaussFilterKernelSize=21,this._context=s}get shadowMapFBO(){return this._shadowMapFBO}get shadowMapTexture(){return this.hasBlur?this._blurTexture:this._shadowMapTexture}get hasBlur(){return this._shadowType!==i.ShadowMappingType.HardLinear}get blurSize(){return this._gaussFilterKernelSize}set blurSize(s){s!==this._gaussFilterKernelSize&&(this._gaussFilter!==void 0&&(this._gaussFilter.kernelSize=s,this._gaussFilter.standardDeviation=s/6),this._gaussFilterKernelSize=s)}resize(s,a=!0,h=!0){l.assert(s[0]>0&&s[1]>0,"Size has to be > 0."),this._shadowMapSize=s,this._shadowMapFBO.resize(this._shadowMapSize[0],this._shadowMapSize[1],a,h)}resizeBlurTexture(s,a=!0,h=!0){l.assert(s[0]>0&&s[1]>0,"Size has to be > 0."),this._blurredShadowMapSize=s,this._intermediateBlurFBO.resize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],a,h),this._blurFBO.resize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],a,h)}initialize(s,a,h){l.assert(a[0]>0&&a[1]>0,"Size has to be > 0."),this._shadowType=s,this._shadowMapSize=a,this._blurredShadowMapSize=h!==void 0?h:this._shadowMapSize;const b=this._context.gl,m=this._context.gl2facade;let M=b.RGBA;if(this._context.isWebGL2){const F=this._context.gl;switch(this._shadowType){case i.ShadowMappingType.HardLinear:case i.ShadowMappingType.HardExponential:M=F.RED;break;case i.ShadowMappingType.SoftLinear:M=F.RG;break;case i.ShadowMappingType.SoftExponential:M=F.RGBA;break;default:l.assert(!1,"Unexpected value for shadowType")}}const[S,w]=n.Wizard.queryInternalTextureFormat(this._context,M,n.Wizard.Precision.float);this._shadowType!==i.ShadowMappingType.HardLinear&&w!==b.FLOAT&&(l.log(l.LogLevel.Warning,"floating point textures are not supported, falling back to HardLinear"),this._shadowType=i.ShadowMappingType.HardLinear);let N=b.LINEAR;return w!==b.FLOAT||this._context.supportsTextureFloatLinear||(N=b.NEAREST),w!==m.HALF_FLOAT||this._context.supportsTextureHalfFloatLinear||(N=b.NEAREST),this._shadowMapTexture=new r.Texture2D(this._context),this._shadowMapTexture.initialize(this._shadowMapSize[0],this._shadowMapSize[1],S,M,b.FLOAT),this._shadowMapTexture.wrap(b.CLAMP_TO_EDGE,b.CLAMP_TO_EDGE),this._shadowMapTexture.filter(N,N),this._shadowMapRenderbuffer=new o.Renderbuffer(this._context),this._shadowMapRenderbuffer.initialize(this._shadowMapSize[0],this._shadowMapSize[1],b.DEPTH_COMPONENT16),this._shadowMapFBO=new g.Framebuffer(this._context),this._shadowMapFBO.initialize([[m.COLOR_ATTACHMENT0,this._shadowMapTexture],[b.DEPTH_ATTACHMENT,this._shadowMapRenderbuffer]]),this._shadowMapFBO.clearColor([1,1,1,1]),this._shadowMapFBO.clearDepth(1),this.hasBlur&&(this._gaussFilter=new v.GaussFilter(this._context),this._gaussFilter.kernelSize=this._gaussFilterKernelSize,this._gaussFilter.standardDeviation=this._gaussFilterKernelSize/6,this._gaussFilter.initialize(),this._intermediateBlurTexture=new r.Texture2D(this._context,"IntermediateBlurTexture"),this._intermediateBlurTexture.initialize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],S,M,b.FLOAT),this._intermediateBlurTexture.wrap(b.CLAMP_TO_EDGE,b.CLAMP_TO_EDGE),this._intermediateBlurTexture.filter(N,N),this._intermediateBlurFBO=new g.Framebuffer(this._context,"IntermediateBlurFramebuffer"),this._intermediateBlurFBO.initialize([[m.COLOR_ATTACHMENT0,this._intermediateBlurTexture]]),this._intermediateBlurFBO.clearColor([1,1,1,1]),this._intermediateBlurFBO.clearDepth(1),this._blurTexture=new r.Texture2D(this._context,"BlurTexture"),this._blurTexture.initialize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],S,M,b.FLOAT),this._blurTexture.wrap(b.CLAMP_TO_EDGE,b.CLAMP_TO_EDGE),this._blurTexture.filter(N,N),this._blurFBO=new g.Framebuffer(this._context,"BlurFramebuffer"),this._blurFBO.initialize([[m.COLOR_ATTACHMENT0,this._blurTexture]]),this._blurFBO.clearColor([1,1,1,1]),this._blurFBO.clearDepth(1)),!0}uninitialize(){this._shadowMapFBO.uninitialize(),this._shadowMapRenderbuffer.uninitialize(),this._shadowMapTexture.uninitialize(),this.hasBlur&&(this._intermediateBlurFBO.uninitialize(),this._intermediateBlurTexture.uninitialize(),this._blurFBO.uninitialize(),this._blurTexture.uninitialize(),this._gaussFilter.uninitialize())}frame(s){const a=this._context.gl;a.viewport(0,0,this._shadowMapSize[0],this._shadowMapSize[1]),a.enable(a.DEPTH_TEST),a.depthFunc(a.LEQUAL),this._shadowMapFBO.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT,!0,!1),s(),a.disable(a.DEPTH_TEST),a.depthFunc(a.LESS),this.hasBlur&&(a.viewport(0,0,this._intermediateBlurFBO.width,this._intermediateBlurFBO.height),this._intermediateBlurFBO.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT,!0,!1),this._gaussFilter.filter(this._shadowMapTexture,v.GaussFilter.Direction.Horizontal),a.viewport(0,0,this._blurFBO.width,this._blurFBO.height),this._blurFBO.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT,!0,!1),this._gaussFilter.filter(this._intermediateBlurTexture,v.GaussFilter.Direction.Vertical))}}d([p.Initializable.assert_initialized()],i.prototype,"resize",null),d([p.Initializable.assert_initialized()],i.prototype,"resizeBlurTexture",null),d([p.Initializable.initialize()],i.prototype,"initialize",null),d([p.Initializable.uninitialize()],i.prototype,"uninitialize",null),d([p.Initializable.assert_initialized()],i.prototype,"frame",null),c.ShadowPass=i,function(u){(function(s){s[s.HardLinear=0]="HardLinear",s[s.SoftLinear=1]="SoftLinear",s[s.HardExponential=2]="HardExponential",s[s.SoftExponential=3]="SoftExponential"})(u.ShadowMappingType||(u.ShadowMappingType={}))}(i=c.ShadowPass||(c.ShadowPass={}))},6902:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FontFace=void 0;const d=_(9696),l=_(6942),g=_(1284),v=_(6869),p=_(7115),o=_(6885);class r{constructor(i,u){this._ascent=0,this._descent=0,this._lineGap=0,this._glyphTextureExtent=[0,0],this._glyphTexturePadding=[0,0,0,0],this._glyphs=new Map,this._context=i;const s=i.gl;u=u!==void 0&&u!==""?u:this.constructor.name,this._glyphTexture=new l.Texture2D(i,`${u}GlyphAtlas`);const a=g.Wizard.queryInternalTextureFormat(i,s.RGBA,g.Wizard.Precision.byte);this._glyphTexture.initialize(1,1,a[0],s.RGBA,a[1]),this._glyphTexture.filter(s.LINEAR,s.LINEAR)}static fromFile(i,u,s=!1,a){return v.fetchAsync(i,"text").then(h=>{const b=new r(u,a);return p.FontFaceLoader.process(b,h,i,void 0,s).then(m=>m).catch(m=>Promise.reject(`processing font face data failed: ${m}`))})}static fromFiles(i,u,s,a=!1,h){return v.fetchAsync(i,"text").then(b=>{const m=new r(s,h);return p.FontFaceLoader.process(m,b,i,u,a).then(M=>M).catch(M=>Promise.reject(`processing font face data failed: ${M}`))})}hasGlyph(i){return!!this._glyphs.get(i)}glyph(i){const u=this._glyphs.get(i);if(u)return u;const s=new o.Glyph;return s.index=i,s}addGlyph(i){d.assert(!this._glyphs.get(i.index),"expected glyph to not already exist"),this._glyphs.set(i.index,i)}arrayOfGlyphIndices(){return Array.from(this._glyphs.keys())}depictable(i){return this.glyph(i).depictable()}kerning(i,u){const s=this._glyphs.get(i);return s?s.kerning(u):0}setKerning(i,u,s){const a=this._glyphs.get(i);a&&this.hasGlyph(u)?a.setKerning(u,s):d.assert(!1,`expected glyph or glyph of subsequent index to exist,                 given ${i} and ${u} respectively`)}set size(i){d.assert(i>0,`expected size to be greater than 0.0, given ${i}`),this._size=i}get size(){return this._size}set base(i){d.assert(i>0,`expected base to be greater than 0.0, given ${i}`),this._base=i}get base(){return this._base}set ascent(i){d.assert(i>0,`expected ascent to be greater than 0.0, given ${i}`),this._ascent=i}get ascent(){return this._ascent}set descent(i){this._descent=i}get descent(){return this._descent}set lineGap(i){this._lineGap=i}get lineGap(){return this._lineGap}set lineHeight(i){d.assert(this.size>0,"expected size to be greater than zero to derive line gap from line height"),this._lineGap=i-this.size}get lineHeight(){return this.size+this.lineGap}set lineSpace(i){this._lineGap=this.size*(i-1)}get lineSpace(){return this.lineHeight===0?this.lineHeight:this.size/this.lineHeight}set glyphTextureExtent(i){d.assert(i[0]>0,`expected extent.x to be greater than 0.0, given ${i[0]}`),d.assert(i[1]>0,`expected extent.y to be greater than 0.0, given ${i[1]}`),this._glyphTextureExtent=i}get glyphTextureExtent(){return this._glyphTextureExtent}set glyphTexturePadding(i){d.assert(i[0]>=0,`expected padding[0] to be greater than 0.0, given ${i[0]}`),d.assert(i[1]>=0,`expected padding[1] to be greater than 0.0, given ${i[1]}`),d.assert(i[2]>=0,`expected padding[2] to be greater than 0.0, given ${i[2]}`),d.assert(i[3]>=0,`expected padding[3] to be greater than 0.0, given ${i[3]}`),this._glyphTexturePadding=i}get glyphTexturePadding(){return this._glyphTexturePadding}set glyphTexture(i){this._glyphTexture=i}get glyphTexture(){return this._glyphTexture}}c.FontFace=r},7115:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FontFaceLoader=void 0;const d=_(9696),l=_(6885);class g{static processInfo(p,o){const r=new Map;if(!this.readKeyValuePairs(p,["size","padding"],r))return!1;o.size=parseFloat(r.get("size"));const n=r.get("padding").split(",");if(n.length!==4)return d.log(d.LogLevel.Warning,`expected 4 values for padding, given ${n} (${n.length})`),!1;const i=[parseFloat(n[0]),parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3])];return o.glyphTexturePadding=i,!0}static processCommon(p,o){const r=new Map;return!!this.readKeyValuePairs(p,["lineHeight","base","scaleW","scaleH"],r)&&(o.base=parseFloat(r.get("base")),r.has("ascent")&&(o.ascent=parseFloat(r.get("ascent"))),r.has("descent")&&(o.descent=parseFloat(r.get("descent"))),o.lineHeight=parseFloat(r.get("lineHeight")),o.glyphTextureExtent=[parseFloat(r.get("scaleW")),parseFloat(r.get("scaleH"))],!0)}static processPage(p,o,r){const n=new Map;if(!this.readKeyValuePairs(p,["file"],n))return;const i=d.dirname(r);let u=n.get("file");return u=u.replace(/['"]+/g,""),o.glyphTexture.fetch(`${i}/${u}`,!0,!0).catch(()=>Promise.reject(`page '${u}' referenced in font file '${r}' was not found`))}static processPages(p,o){d.logIf(o.size!==1,d.LogLevel.Warning,"glyph atlas supports a single page only (impl. for multiple pages pending)"),d.assert(o.has(0),"page with page ID 0 expected for glyph atlas (impl. for multiple pages pending)");const r=o.get(0);if(r)return p.glyphTexture.fetch(`${r}`,!0,!0).catch(()=>Promise.reject(`fetching page '0' from '${r}' failed`))}static processChar(p,o){const r=new Map;if(!this.readKeyValuePairs(p,["id","x","y","width","height","xoffset","yoffset","xadvance"],r))return!1;const n=parseInt(r.get("id"),10);d.logIf(n<=0,d.LogLevel.Warning,`expected glyph index to be greater than 0, given ${n}`);const i=new l.Glyph;i.index=n;const u=[1/o.glyphTextureExtent[0],1/o.glyphTextureExtent[1]],s=[parseFloat(r.get("width")),parseFloat(r.get("height"))];return i.subTextureOrigin=[parseFloat(r.get("x"))*u[0],1-(parseFloat(r.get("y"))+s[1])*u[1]],i.extent=s,i.subTextureExtent[0]=s[0]*u[0],i.subTextureExtent[1]=s[1]*u[1],i.bearingFromFontBaseAndOffset(o.base,parseFloat(r.get("xoffset")),parseFloat(r.get("yoffset"))),i.advance=parseFloat(r.get("xadvance")),o.addGlyph(i),!0}static processKerning(p,o){const r=new Map;if(!this.readKeyValuePairs(p,["first","second","amount"],r))return!1;const n=parseInt(r.get("first"),10);if(n<=0)return d.log(d.LogLevel.Warning,`expected kerning's first to be greater than 0, given ${n}`),!1;const i=parseInt(r.get("second"),10);if(i<=0)return d.log(d.LogLevel.Warning,`expected kerning's second to be greater than 0, given ${i}`),!1;const u=parseFloat(r.get("amount"));return o.setKerning(n,i,u),!0}static readKeyValuePairs(p,o,r){let n,i;for(const s of p){const a=s.split("=");n=a[0],i=a[1],r.set(n,i)}let u=!0;return o.forEach(s=>u=u&&r.has(s)),u||d.log(d.LogLevel.Warning,`Not all required keys are provided! Mandatory keys: ${o}`),u}static findAscentAndDescentIfNoneProvided(p,o){if(p.ascent>0&&p.descent<0)return;p.ascent>0&&(p.descent=p.ascent-o),p.descent<0&&(p.ascent=p.descent-o);let r=Number.MIN_VALUE;for(const n of p.arrayOfGlyphIndices())p.glyph(n).extent[1]!==0&&(r=Math.max(p.glyph(n).bearing[1],r));p.ascent=r,p.descent=p.ascent-o,d.log(d.LogLevel.Debug,`ascent not specified, derived ${p.ascent} from maximum y-offset`)}static process(p,o,r,n,i=!1){const u=o.split(`
`),s=new Array;let a=!0;if(!i&&n){const h=this.processPages(p,n);h!==void 0&&s.push(h)}for(const h of u){let b=h.split(" ");const m=b[0];switch(b=b.slice(1),m){case"info":a=this.processInfo(b,p);break;case"common":a=this.processCommon(b,p);break;case"page":if(i||n)break;const M=this.processPage(b,p,r);M!==void 0&&s.push(M);break;case"char":a=this.processChar(b,p);break;case"kerning":this.processKerning(b,p)}if(a===!1)break}return g.findAscentAndDescentIfNoneProvided(p,p.size),p.size<=0&&d.log(d.LogLevel.Warning,`expected fontFace.size to be greater than 0, given ${p.size}`),Promise.all(s).then(()=>p)}}c.FontFaceLoader=g},6885:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Glyph=void 0;const d=_(4934);c.Glyph=class{constructor(l=0,g=0){this._bearing=[0,0],this._extent=[0,0],this._kernings=new Map,this._subTextureOrigin=[0,0],this._subTextureExtent=[0,0],this._index=l,this._advance=g}depictable(){return this._subTextureExtent[0]>0&&this._subTextureExtent[1]>0}kerning(l){const g=this._kernings.get(l);return g!==void 0?g:0}setKerning(l,g){this._kernings.set(l,g)}set index(l){this._index=l}get index(){return this._index}set subTextureOrigin(l){this._subTextureOrigin=d.clampf2(l,"texture origin")}get subTextureOrigin(){return this._subTextureOrigin}set subTextureExtent(l){this._subTextureExtent=d.clampf2(l,"texture extent")}get subTextureExtent(){return this._subTextureExtent}set bearing(l){this._bearing=l}get bearing(){return this._bearing}bearingFromFontBaseAndOffset(l,g,v){this._bearing[0]=g,this._bearing[1]=l-v}set extent(l){this._extent=l}get extent(){return this._extent}set advance(l){this._advance=l}get advance(){return this._advance}}},7326:(x,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GlyphVertices=void 0;class _{constructor(l){const g=Math.max(0,l);this._texCoords=new Float32Array(g*_.FLOATS_PER_TEXCOORD),this._origins=new Float32Array(g*_.FLOATS_PER_ORIGIN),this._tangents=new Float32Array(g*_.FLOATS_PER_TANGENT),this._ups=new Float32Array(g*_.FLOATS_PER_UP)}static concat(l){let g=0;l.forEach(o=>g+=o?o.length:0);const v=new _(g);let p=0;for(let o=0;o<l.length;++o){const r=l[o];r!==void 0&&r.length!==0&&(v._texCoords.set(r._texCoords,p*_.FLOATS_PER_TEXCOORD),v._origins.set(r._origins,p*_.FLOATS_PER_ORIGIN),v._tangents.set(r._tangents,p*_.FLOATS_PER_TANGENT),v._ups.set(r._ups,p*_.FLOATS_PER_UP),p+=r.length)}return v}shrink(l){const g=Math.max(0,l);if(this.length===g)return;const v=(p,o,r)=>new Float32Array(p.buffer.slice(0,o*p.BYTES_PER_ELEMENT*r),0,o*r);v(this._texCoords,g,_.FLOATS_PER_TEXCOORD),v(this._origins,g,_.FLOATS_PER_ORIGIN),v(this._ups,g,_.FLOATS_PER_TANGENT),v(this._tangents,g,_.FLOATS_PER_UP)}uvLowerLeft(l){const g=l*_.FLOATS_PER_TEXCOORD+0;return this._texCoords.subarray(g,g+2)}uvUpperRight(l){const g=l*_.FLOATS_PER_TEXCOORD+2;return this._texCoords.subarray(g,g+2)}origin(l){const g=l*_.FLOATS_PER_ORIGIN;return this._origins.subarray(g,g+_.FLOATS_PER_ORIGIN)}tangent(l){const g=l*_.FLOATS_PER_TANGENT;return this._tangents.subarray(g,g+_.FLOATS_PER_TANGENT)}up(l){const g=l*_.FLOATS_PER_UP;return this._ups.subarray(g,g+_.FLOATS_PER_UP)}get length(){return this._origins.length/_.FLOATS_PER_ORIGIN}get origins(){return this._origins}get tangents(){return this._tangents}get ups(){return this._ups}get texCoords(){return this._texCoords}}c.GlyphVertices=_,_.FLOATS_PER_TEXCOORD=4,_.FLOATS_PER_ORIGIN=3,_.FLOATS_PER_TANGENT=3,_.FLOATS_PER_UP=3},2709:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Typesetter=c.Text=c.Projected3DLabel=c.Position3DLabel=c.Position2DLabel=c.LabelRenderPass=c.LabelGeometry=c.Label=c.GlyphVertices=c.FontFace=void 0;var d=_(6902);Object.defineProperty(c,"FontFace",{enumerable:!0,get:function(){return d.FontFace}});var l=_(7326);Object.defineProperty(c,"GlyphVertices",{enumerable:!0,get:function(){return l.GlyphVertices}});var g=_(8733);Object.defineProperty(c,"Label",{enumerable:!0,get:function(){return g.Label}});var v=_(8852);Object.defineProperty(c,"LabelGeometry",{enumerable:!0,get:function(){return v.LabelGeometry}});var p=_(8597);Object.defineProperty(c,"LabelRenderPass",{enumerable:!0,get:function(){return p.LabelRenderPass}});var o=_(8254);Object.defineProperty(c,"Position2DLabel",{enumerable:!0,get:function(){return o.Position2DLabel}});var r=_(8115);Object.defineProperty(c,"Position3DLabel",{enumerable:!0,get:function(){return r.Position3DLabel}});var n=_(1648);Object.defineProperty(c,"Projected3DLabel",{enumerable:!0,get:function(){return n.Projected3DLabel}});var i=_(819);Object.defineProperty(c,"Text",{enumerable:!0,get:function(){return i.Text}});var u=_(3210);Object.defineProperty(c,"Typesetter",{enumerable:!0,get:function(){return u.Typesetter}})},8733:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Label=void 0;const d=_(3659),l=_(4597),g=_(7677),v=_(7326),p=_(819);class o{constructor(n,i,u){this._alignment=o.Alignment.Left,this._lineAnchor=o.LineAnchor.Baseline,this._lineWidth=NaN,this._fontSizeUnit=o.Unit.World,this._color=new g.Color(o.DEFAULT_COLOR),this._altered=Object.assign(new l.ChangeLookup,{any:!1,color:!1,resources:!1,text:!1,typesetting:!1,static:!1,dynamic:!1}),this._wrap=!1,this._elide=o.Elide.None,this._ellipsis=o.DEFAULT_ELLIPSIS,this._text=n,this._type=i,this._staticTransform=d.mat4.create(),this._dynamicTransform=d.mat4.create(),this._extent=[0,0],u&&(this._fontFace=u)}static devicePixelRatio(){return window===void 0||typeof window.devicePixelRatio!="number"?1:window.devicePixelRatio}vertices(){return new v.GlyphVertices(this.length+this.ellipsis.length)}charAt(n){return this._text.charAt(n)}charCodeAt(n){return this._text.charCodeAt(n)}lineFeedAt(n){return this.charAt(n)===this.lineFeed}kerningBefore(n){return n<1||n>this.length?NaN:this._fontFace.kerning(this.charCodeAt(n-1),this.charCodeAt(n))}kerningAfter(n){return n<0||n>this.length-1?NaN:this._fontFace.kerning(this.charCodeAt(n),this.charCodeAt(n+1))}advance(n){return n<0||n>this.length?NaN:this._fontFace.glyph(this.charCodeAt(n)).advance}toString(){return this._text instanceof p.Text?this._text.text:this._text}reset(){this._altered.reset()}set text(n){this._altered.alter("text"),this._text=n}get text(){return this._text}get type(){return this._type}get length(){return this._text.length}get lineFeed(){return this._text instanceof p.Text?this._text.lineFeed:p.Text.DEFAULT_LINE_FEED}set wrap(n){this._wrap=n}get wrap(){return this._wrap}set elide(n){this._elide=n}get elide(){return this._elide}set ellipsis(n){this._ellipsis!==n&&(this._ellipsis=n,this._elide!==o.Elide.None&&this._altered.alter("typesetting"))}get ellipsis(){return this._ellipsis}set lineWidth(n){this._lineWidth!==n&&(this._lineWidth=n,this._altered.alter("typesetting"))}get lineWidth(){return this._lineWidth*this._fontFace.size/this.fontSize}set alignment(n){this._alignment!==n&&(this._alignment=n,this._altered.alter("typesetting"))}get alignment(){return this._alignment}set lineAnchor(n){this._lineAnchor!==n&&(this._lineAnchor=n,this._altered.alter("typesetting"))}get lineAnchor(){return this._lineAnchor}set fontSize(n){this._fontSize!==n&&(this._fontSize=n,this._altered.alter("typesetting"))}get fontSize(){return this._fontSize}set fontSizeUnit(n){this._fontSizeUnit!==n&&(this._fontSizeUnit=n,this._altered.alter("typesetting"))}get fontSizeUnit(){return this._fontSizeUnit}set fontFace(n){this._fontFace!==n&&(this._fontFace=n,this._altered.alter("typesetting"),this._altered.alter("resources"))}get fontFace(){return this._fontFace}set color(n){this._color.equals(n)||(this._color=n,this._altered.alter("color"))}get color(){return this._color}set backgroundColor(n){this._backgroundColor.equals(n)||(this._backgroundColor=n,this._altered.alter("color"))}get backgroundColor(){return this._backgroundColor}set staticTransform(n){d.mat4.equals(this._staticTransform,n)||(this._staticTransform=n,this._altered.alter("static"))}get staticTransform(){const n=this.fontSize/this._fontFace.size,i=d.mat4.create();return d.mat4.scale(i,this._staticTransform,d.vec3.fromValues(n,n,n)),i}set dynamicTransform(n){this._altered.alter("dynamic"),this._dynamicTransform=n}get dynamicTransform(){return this._dynamicTransform}set extent(n){this._extent=n}get extent(){return this._extent}get altered(){return this._altered.any||this._text.altered||this._color.altered}get valid(){return this._fontFace!==void 0&&this._fontFace.glyphTexture.valid&&this._text.length>0}}c.Label=o,o.DEFAULT_COLOR=[.1098,.4588,.7373,1],o.DEFAULT_ELLIPSIS="...",function(r){(function(n){n.Static="static",n.Dynamic="dynamic"})(r.Type||(r.Type={})),function(n){n.None="none",n.Left="left",n.Middle="middle",n.Right="right"}(r.Elide||(r.Elide={})),function(n){n.Left="left",n.Center="center",n.Right="right"}(r.Alignment||(r.Alignment={})),function(n){n.Top="top",n.Ascent="ascent",n.Center="center",n.Baseline="baseline",n.Descent="descent",n.Bottom="bottom"}(r.LineAnchor||(r.LineAnchor={})),function(n){n.World="world",n.Pixel="pixel",n.Mixed="mixed"}(r.Unit||(r.Unit={}))}(o=c.Label||(c.Label={}))},8852:function(x,c,_){var d=this&&this.__decorate||function(r,n,i,u){var s,a=arguments.length,h=a<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,i):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,n,i,u);else for(var b=r.length-1;b>=0;b--)(s=r[b])&&(h=(a<3?s(h):a>3?s(n,i,h):s(n,i))||h);return a>3&&h&&Object.defineProperty(n,i,h),h};Object.defineProperty(c,"__esModule",{value:!0}),c.LabelGeometry=void 0;const l=_(9696),g=_(6404),v=_(4894),p=_(1030);class o extends v.Geometry{constructor(n,i){super(n,i),this._numberOfGlyphs=0,l.assert(n.isWebGL2||n.supportsInstancedArrays,"expected extension 'ANGLE_instanced_arrays' to be supported"),i=i!==void 0&&i!==""?i:this.constructor.name,this._vertices=new g.Buffer(n,`${i}VBO`),this._buffers.push(this._vertices),this._texCoords=new g.Buffer(n,`${i}TexCoordVBO`),this._buffers.push(this._texCoords),this._origins=new g.Buffer(n,`${i}OriginVBO`),this._buffers.push(this._origins),this._tangents=new g.Buffer(n,`${i}TangentVBO`),this._buffers.push(this._tangents),this._ups=new g.Buffer(n,`${i}UpVBO`),this._buffers.push(this._ups)}bindBuffers(){const n=this.context.gl,i=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,n.FLOAT,!1,8,0,!0,!1),i.vertexAttribDivisor(this._vertexLocation,0),this._texCoords.attribEnable(this._texCoordLocation,4,n.FLOAT,!1,16,0,!0,!1),i.vertexAttribDivisor(this._texCoordLocation,1),this._origins.attribEnable(this._originLocation,3,n.FLOAT,!1,12,0,!0,!1),i.vertexAttribDivisor(this._originLocation,1),this._tangents.attribEnable(this._tangentLocation,3,n.FLOAT,!1,12,0,!0,!1),i.vertexAttribDivisor(this._tangentLocation,1),this._ups.attribEnable(this._upLocation,3,n.FLOAT,!1,12,0,!0,!1),i.vertexAttribDivisor(this._upLocation,1)}unbindBuffers(){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._texCoords.attribDisable(this._texCoordLocation,!1,!1),this._origins.attribDisable(this._originLocation,!1,!1),this._tangents.attribDisable(this._tangentLocation,!1,!1),this._ups.attribDisable(this._upLocation,!1,!1)}initialize(n=0,i=1,u=2,s=3,a=4){this._vertexLocation=n,this._texCoordLocation=i,this._originLocation=u,this._tangentLocation=s,this._upLocation=a;const h=this.context.gl,b=super.initialize([h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER,h.ARRAY_BUFFER]);return this._vertices.data(o.VERTICES,h.STATIC_DRAW),b}update(n,i,u,s){this._numberOfGlyphs=n.length/3;const a=this.context.gl;this._texCoords.data(s,a.STATIC_DRAW),this._origins.data(n,a.STATIC_DRAW),this._tangents.data(i,a.STATIC_DRAW),this._ups.data(u,a.STATIC_DRAW)}draw(n=0,i=0){const u=this.context.gl,s=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,u.FLOAT,!1,8,0,!0,!1),this._texCoords.attribEnable(this._texCoordLocation,4,u.FLOAT,!1,16,16*n,!0,!1),this._origins.attribEnable(this._originLocation,3,u.FLOAT,!1,12,12*n,!0,!1),this._tangents.attribEnable(this._tangentLocation,3,u.FLOAT,!1,12,12*n,!0,!1),this._ups.attribEnable(this._upLocation,3,u.FLOAT,!1,12,12*n,!0,!1),s.drawArraysInstanced(u.TRIANGLE_STRIP,0,4,i)}get numGlyphs(){return this._numberOfGlyphs}get valid(){const n=this._vertices&&this._vertices.valid,i=this._texCoords&&this._texCoords.valid,u=this._origins&&this._origins.valid,s=this._tangents&&this._tangents.valid,a=this._ups&&this._ups.valid;return this.initialized&&n&&i&&u&&s&&a}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}get originLocation(){return this._originLocation}get tangentLocation(){return this._tangentLocation}get upLocation(){return this._upLocation}}o.VERTICES=new Float32Array([0,0,0,1,1,0,1,1]),d([p.Initializable.assert_initialized()],o.prototype,"draw",null),c.LabelGeometry=o},8597:function(x,c,_){var d=this&&this.__decorate||function(M,S,w,N){var F,k=arguments.length,X=k<3?S:N===null?N=Object.getOwnPropertyDescriptor(S,w):N;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")X=Reflect.decorate(M,S,w,N);else for(var $=M.length-1;$>=0;$--)(F=M[$])&&(X=(k<3?F(X):k>3?F(S,w,X):F(S,w))||X);return k>3&&X&&Object.defineProperty(S,w,X),X};Object.defineProperty(c,"__esModule",{value:!0}),c.LabelRenderPass=void 0;const l=_(3659),g=_(9696),v=_(4597),p=_(1030),o=_(4895),r=_(5263),n=_(6942),i=_(7326),u=_(8733),s=_(8852),a=_(8254),h=_(8115),b=_(1648);class m extends p.Initializable{constructor(S){super(),this._altered=Object.assign(new v.ChangeLookup,{any:!1,camera:!1,geometry:!1,labels:!1,aaStepScale:!1,aaSampling:!1}),this._ndcOffset=[0,0],this._depthMask=!1,this._aaSampling=m.Sampling.Smooth1,this._labels=new Array,this._ranges=new Array,this._verticesPerLabel=new Array,this._context=S,this._depthFunc=S.gl.LESS,this._program=new o.Program(S,"LabelRenderProgram"),this._geometry=new s.LabelGeometry(this._context,"LabelGeometry"),this._aaStepScale=m.DEFAULT_AA_STEP_SCALE}prepare(){const S=this._camera.viewport;for(let N=0;N<this._labels.length;++N){const F=this._labels[N];let k;const X=this._altered.labels&&this._verticesPerLabel[N]===void 0;F instanceof a.Position2DLabel?(F.frameSize=S,k=F.typeset(X)):F instanceof b.Projected3DLabel?(F.camera=this._camera,k=F.typeset(X)):F instanceof h.Position3DLabel&&(k=F.typeset(X)),k===void 0?k=this._verticesPerLabel[N]:this._verticesPerLabel[N]=k;const $=N>0?this._ranges[N-1][1]:0,V=$+(k===void 0?0:k.length);this._ranges[N]=[$,V]}const w=i.GlyphVertices.concat(this._verticesPerLabel);this._geometry.update(w.origins,w.tangents,w.ups,w.texCoords)}draw(){const S=this._context.gl,w=[0,0];let N,F;const k=l.mat4.create();for(let X=0;X<this._labels.length;++X){const $=this._labels[X];if(w[1]=this._ranges[X][1],w[0]===w[1]||X<this._labels.length-1&&!$.valid)continue;const V=X<this._labels.length-1?this._labels[X+1]:void 0,Y=V&&$.type===u.Label.Type.Static&&V.type===u.Label.Type.Static,Z=V&&$.color.equals(V.color),J=V&&$.fontFace===V.fontFace,ee=V&&$.fontSizeUnit===V.fontSizeUnit;if(V&&(this._ranges[X+1][0]===this._ranges[X+1][1]||Y&&Z&&J&&ee))continue;const K=$.type===u.Label.Type.Dynamic;switch(S.uniform1i(this._uDynamic,K),K&&S.uniformMatrix4fv(this._uTransform,!1,$.dynamicTransform),N!==void 0&&N.equals($.color)||(S.uniform4fv(this._uColor,$.color.rgbaF32),N=$.color),F!==$.fontFace&&($.fontFace.glyphTexture.bind(S.TEXTURE0),F=$.fontFace),$.fontSizeUnit){case u.Label.Unit.Pixel:S.uniformMatrix4fv(this._uViewProjection,!1,k);break;case u.Label.Unit.World:case u.Label.Unit.Mixed:default:S.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection)}this._geometry.draw(w[0],w[1]-w[0]),w[0]=w[1]}}initialize(){const S=this._context.gl;this._geometry.initialize(),this._context.enable(["OES_standard_derivatives"]);const w=new r.Shader(this._context,S.VERTEX_SHADER,"glyph.vert");w.initialize(_(1176));const N=new r.Shader(this._context,S.FRAGMENT_SHADER,"glyph.frag");return N.initialize(_(9761)),this._program.initialize([w,N],!1),this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_texCoord",this._geometry.texCoordLocation),this._program.attribute("a_origin",this._geometry.originLocation),this._program.attribute("a_tangent",this._geometry.tangentLocation),this._program.attribute("a_up",this._geometry.upLocation),this._program.link(),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColor=this._program.uniform("u_color"),this._uAAStepScale=this._program.uniform("u_aaStepScale"),this._uAASampling=this._program.uniform("u_aaSampling"),this._uTransform=this._program.uniform("u_transform"),this._uDynamic=this._program.uniform("u_dynamic"),this._program.bind(),S.uniform1i(this._program.uniform("u_glyphs"),0),S.uniform1f(this._uAAStepScale,this._aaStepScale),S.uniform1i(this._uAASampling,this._aaSampling),this._program.unbind(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColor=void 0,this._uAAStepScale=void 0,this._uAASampling=void 0,this._uTransform=void 0,this._uDynamic=void 0}update(S=!1){const w=this._context.gl;this._program.bind(),(S||this._altered.camera||this._camera.altered)&&w.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),(S||this._altered.aaStepScale)&&w.uniform1f(this._uAAStepScale,this._aaStepScale),(S||this._altered.aaSampling)&&w.uniform1i(this._uAASampling,this._aaSampling);let N=S||this._altered.labels||this._altered.camera||this._camera.altered,F=0;for(;N===!1&&F<this._labels.length;)N=this._labels[F].altered,++F;N&&this.prepare(),this._altered.reset()}frame(){if(this._geometry.numGlyphs===0||this._labels.length===0)return;g.assert(this._target&&this._target.valid,"valid target expected");const S=this._context.gl,w=this._target.size;S.viewport(0,0,w[0],w[1]),S.enable(S.DEPTH_TEST),S.depthFunc(this._depthFunc),this._depthMask===!1&&S.depthMask(this._depthMask),S.enable(S.BLEND),S.blendFuncSeparate(S.SRC_ALPHA,S.ONE_MINUS_SRC_ALPHA,S.ONE,S.ONE_MINUS_SRC_ALPHA),this._program.bind(),S.uniform2fv(this._uNdcOffset,this._ndcOffset),S.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._target.bind(),this._geometry.bind(),this.draw(),S.bindTexture(S.TEXTURE_2D,n.Texture2D.DEFAULT_TEXTURE),this._depthMask===!1&&S.depthMask(!0),S.depthFunc(S.LESS),S.disable(S.DEPTH_TEST),S.disable(S.BLEND)}unbind(){this._geometry.valid&&this._geometry.unbind(),this._program.valid&&this._program.unbind()}set target(S){this.assertInitialized(),this._target=S}set ndcOffset(S){this.assertInitialized(),this._ndcOffset=S}set camera(S){this.assertInitialized(),this._camera!==S&&(this._camera=S,this._altered.alter("camera"))}set depthMask(S){this._depthMask=S}get depthMask(){return this._depthMask}set depthFunc(S){this._depthFunc=S}get depthFunc(){return this._depthFunc}set labels(S){this._labels=S,this._ranges.length=this._labels.length,this._verticesPerLabel.length=this._labels.length,this._verticesPerLabel.fill(void 0),this._altered.alter("labels")}get labels(){return this._labels}set aaStepScale(S){this._aaStepScale!==S&&(this._aaStepScale=S,this._altered.alter("aaStepScale"))}get aaStepScale(){return this._aaStepScale}set aaSampling(S){this._aaSampling!==S&&(this._aaSampling=S,this._altered.alter("aaSampling"))}get aaSampling(){return this._aaSampling}get geometry(){return this._geometry}get program(){return this._program}}m.DEFAULT_AA_STEP_SCALE=.6666,d([p.Initializable.initialize()],m.prototype,"initialize",null),d([p.Initializable.uninitialize()],m.prototype,"uninitialize",null),d([p.Initializable.assert_initialized()],m.prototype,"update",null),d([p.Initializable.assert_initialized()],m.prototype,"frame",null),d([p.Initializable.assert_initialized()],m.prototype,"unbind",null),c.LabelRenderPass=m,function(M){(function(S){S[S.None=0]="None",S[S.Smooth1=1]="Smooth1",S[S.Horizontal3=2]="Horizontal3",S[S.Vertical3=3]="Vertical3",S[S.Grid3x3=4]="Grid3x3",S[S.Grid4x4=5]="Grid4x4"})(M.Sampling||(M.Sampling={}))}(m=c.LabelRenderPass||(c.LabelRenderPass={}))},8254:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Position2DLabel=void 0;const d=_(3659),l=_(9696),g=_(2111),v=_(7326),p=_(8733),o=_(3210);class r extends p.Label{constructor(i,u,s){super(i,u,s),this._position=d.vec2.fromValues(0,0),this._direction=d.vec2.fromValues(1,0),this._frameSize=d.vec2.create(),this._fontSize=r.DEFAULT_FONTSIZE_PX,this._fontSizeUnit=p.Label.Unit.Pixel}typeset(i=!1){const u=i||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!u&&!this._altered.dynamic&&!i)return;if(!this.valid)return new v.GlyphVertices(0);const s=d.vec4.create(),a=d.mat4.create();d.mat4.translate(a,g.m4(),d.vec3.fromValues(-1,-1,0)),d.mat4.scale(a,a,d.vec3.fromValues(2/this._frameSize[0],2/this._frameSize[1],1));const h=d.vec2.sub(g.v2(),d.vec2.fromValues(this._frameSize[0],this._frameSize[1]),d.vec2.fromValues(s[3]+s[1],s[2]+s[0])),b=d.vec3.fromValues(.5*h[0],.5*h[1],0);d.vec3.add(b,b,d.vec3.fromValues(s[3],s[2],0)),d.mat4.translate(a,a,b),d.mat4.translate(a,a,d.vec3.fromValues(this._position[0],this._position[1],0));const m=d.vec2.fromValues(1,0);let M=d.vec2.angle(m,this._direction);switch(m[0]*this._direction[1]-m[1]*this._direction[0]<0&&(M=-M),d.mat4.rotateZ(a,a,M),this._type){case p.Label.Type.Static:this.staticTransform=d.mat4.clone(a),this.dynamicTransform=g.m4();break;case p.Label.Type.Dynamic:this.staticTransform=g.m4(),this.dynamicTransform=d.mat4.clone(a)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!u)return;const S=this.vertices();return o.Typesetter.typeset(this,S),S}set frameSize(i){d.vec2.equals(this._frameSize,i)||(d.vec2.max(this._frameSize,i,[1,1]),this._altered.alter(this._type))}get frameSize(){return this._frameSize}set position(i){d.vec2.equals(this._position,i)||(this._position=d.vec2.clone(i),this._altered.alter(this._type))}get position(){return this._position}set direction(i){d.vec2.normalize(this._direction,i),this._altered.alter(this._type)}get direction(){return this._direction}set fontSizeUnit(i){l.logIf(i!==p.Label.Unit.Pixel,l.LogLevel.Warning,`font size unit other than 'px' are not supported in position-2d-label, given ${i}`)}get fontSizeUnit(){return this._fontSizeUnit}}c.Position2DLabel=r,r.DEFAULT_FONTSIZE_PX=20},8115:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Position3DLabel=void 0;const d=_(3659),l=_(9696),g=_(2111),v=_(7326),p=_(8733),o=_(3210);class r extends p.Label{constructor(i,u,s){super(i,u,s),this._position=d.vec3.fromValues(0,0,0),this._direction=d.vec3.fromValues(1,0,0),this._up=d.vec3.fromValues(0,1,0),this._fontSize=r.DEFAULT_FONTSIZE_WORLD,this._fontSizeUnit=p.Label.Unit.World}typeset(i=!1){const u=i||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!u&&!this._altered.dynamic&&!i)return;if(!this.valid)return new v.GlyphVertices(0);const s=d.mat4.create();d.mat4.translate(s,g.m4(),this._position);const a=d.vec3.cross(g.v3(),this._direction,this._up),h=d.mat4.fromValues(this._direction[0],this._direction[1],this._direction[2],0,this._up[0],this._up[1],this._up[2],0,a[0],a[1],a[2],0,0,0,0,1);switch(d.mat4.mul(s,s,h),this._type){case p.Label.Type.Static:this.staticTransform=d.mat4.clone(s),this.dynamicTransform=g.m4();break;case p.Label.Type.Dynamic:this.staticTransform=g.m4(),this.dynamicTransform=d.mat4.clone(s)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!u)return;const b=this.vertices();return o.Typesetter.typeset(this,b),b}set position(i){this._position=d.vec3.clone(i),this._altered.alter(this._type)}get position(){return this._position}set direction(i){d.vec3.normalize(this._direction,i),this._altered.alter(this._type)}get direction(){return this._direction}set up(i){this._up=d.vec3.normalize(this._up,i),this._altered.alter(this._type)}get up(){return this._up}set fontSizeUnit(i){l.logIf(i!==p.Label.Unit.World,l.LogLevel.Warning,`font size unit other than 'world' are not supported in position-3d-label, given ${i}`)}get fontSizeUnit(){return this._fontSizeUnit}}c.Position3DLabel=r,r.DEFAULT_FONTSIZE_WORLD=.05},1648:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Projected3DLabel=void 0;const d=_(3659),l=_(9696),g=_(2111),v=_(7326),p=_(8733),o=_(3210);class r extends p.Label{constructor(i,u,s){super(i,u,s),this._position=d.vec3.fromValues(0,0,0),this._direction=d.vec2.fromValues(1,0),this._fontSize=r.DEFAULT_FONTSIZE_PX,this._fontSizeUnit=p.Label.Unit.Mixed}typeset(i=!1){const u=i||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!u&&!this._altered.dynamic&&!i)return;if(!this.valid||this._camera===void 0)return new v.GlyphVertices(0);const s=d.vec4.create(),a=d.mat4.create();d.mat4.translate(a,a,d.vec3.fromValues(-1,-1,0)),d.mat4.scale(a,a,d.vec3.fromValues(2/this._camera.viewport[0],2/this._camera.viewport[1],1)),d.mat4.scale(a,a,d.vec3.fromValues(1,1,1));const h=d.vec2.create();d.vec2.sub(h,d.vec2.fromValues(this._camera.viewport[0]/1,this._camera.viewport[1]/1),d.vec2.fromValues(s[3]+s[1],s[2]+s[0]));const b=d.vec3.fromValues(.5*h[0],.5*h[1],0);d.vec3.add(b,b,d.vec3.fromValues(s[3],s[2],0)),d.mat4.translate(a,a,b);const m=d.vec4.fromValues(this._position[0],this._position[1],this._position[2],1);d.vec4.transformMat4(m,m,this._camera.viewProjection);const M=d.mat4.create(),S=m[3];d.mat4.translate(M,M,d.vec3.fromValues(m[0]/S,m[1]/S,m[2]/S)),d.mat4.mul(a,M,a);const w=d.vec2.fromValues(1,0);let N=d.vec2.angle(w,this._direction);switch(w[0]*this._direction[1]-w[1]*this._direction[0]<0&&(N=-N),d.mat4.rotateZ(a,a,N),this._camera.viewProjectionInverse?d.mat4.mul(a,this._camera.viewProjectionInverse,a):l.log(l.LogLevel.Warning,"camera.viewProjectionInverse is null"),this._type){case p.Label.Type.Static:this.staticTransform=d.mat4.clone(a),this.dynamicTransform=g.m4();break;case p.Label.Type.Dynamic:this.staticTransform=g.m4(),this.dynamicTransform=d.mat4.clone(a)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!u)return;const F=this.vertices();return o.Typesetter.typeset(this,F),F}set camera(i){this._camera=i,this._altered.alter(this._type)}get camera(){return this._camera}set position(i){this._position=d.vec3.clone(i),this._altered.alter(this._type)}get position(){return this._position}set direction(i){d.vec2.normalize(this._direction,i),this._altered.alter(this._type)}get direction(){return this._direction}set fontSizeUnit(i){l.logIf(i!==p.Label.Unit.Mixed,l.LogLevel.Warning,`font size unit other than 'px' are not supported in projected-3d-label, given ${i}`)}get fontSizeUnit(){return this._fontSizeUnit}}c.Projected3DLabel=r,r.DEFAULT_FONTSIZE_PX=20},819:(x,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Text=void 0;class _{constructor(l,g){this._lineFeed=_.DEFAULT_LINE_FEED,this._altered=!1,this._text=l||"",this._lineFeed=g!==void 0?g:this._lineFeed}get length(){return this._text.length}charAt(l){return this._text.charAt(l)}charCodeAt(l){return this._text.charCodeAt(l)}set text(l){this._text!==l&&(this._altered=!0,this._text=l)}get text(){return this._text}set lineFeed(l){this._lineFeed!==l&&(this._altered=!0,this._lineFeed=l)}get lineFeed(){return this._lineFeed}set altered(l){this._altered=l}get altered(){return this._altered}}c.Text=_,_.DEFAULT_LINE_FEED=`
`},3210:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Typesetter=void 0;const d=_(3659),l=_(9696),g=_(2111),v=_(8733);class p{static writeVertex(r,n,i,u,s){if(u===void 0||i.depictable()===!1)return;const a=r.glyphTexturePadding,h=u.origin(s);d.vec3.set(h,n[0],n[1],0),h[0]+=i.bearing[0]-a[3],h[1]+=i.bearing[1]-i.extent[1],d.vec3.set(u.tangent(s),i.extent[0],0,0),d.vec3.set(u.up(s),0,i.extent[1],0);const b=u.uvLowerLeft(s);d.vec2.copy(b,i.subTextureOrigin);const m=u.uvUpperRight(s);d.vec2.add(m,i.subTextureOrigin,i.subTextureExtent)}static lineAnchorOffset(r){let n=0;const i=r.fontFace.glyphTexturePadding,u=r.fontFace;switch(r.lineAnchor){case v.Label.LineAnchor.Ascent:n=u.ascent-i[0];break;case v.Label.LineAnchor.Descent:n=u.descent*(1+i[0]/u.ascent);break;case v.Label.LineAnchor.Center:n=u.ascent-i[0]-.5*u.size;break;case v.Label.LineAnchor.Top:n=u.ascent-i[0]+.5*u.lineGap;break;case v.Label.LineAnchor.Bottom:n=u.ascent-i[0]+.5*u.lineGap-u.lineHeight;break;case v.Label.LineAnchor.Baseline:default:n=-i[0]}return n}static advances(r,n){l.assert(r.fontFace!==void 0,"expected a font face for label in order to resolve advances"),n===void 0&&(n=r.text.text);const i=new Float32Array(n.length);for(let u=0;u<n.length;++u){const s=n.charCodeAt(u);i[u]=r.fontFace.glyph(s).advance}return i}static kernings(r,n){if(l.assert(r.fontFace!==void 0,"expected a font face for label in order to resolve kernings"),n===void 0){const s=new Float32Array(r.length);for(let a=0;a<r.length;++a){const h=r.kerningAfter(a);s[a]=isNaN(h)?0:h}return s}const i=new Float32Array(n.length);for(let s=0;s<n.length;++s){const a=(u=s)<0||u>n.length-1?NaN:r.fontFace.kerning(n.charCodeAt(u),n.charCodeAt(u+1));i[s]=isNaN(a)?0:a}var u;return i}static fragments(r){const n=new Array;let i,u=0;for(let s=0;s<r.length;++s){if(i=p.DELIMITERS.indexOf(r.charAt(s))>-1,!i)continue;u<s&&n.push([u,s,p.FragmentType.Word]);const a=r.lineFeedAt(s)?p.FragmentType.LineFeed:p.FragmentType.Delimiter;n.push([s,s+1,a]),u=s+1}return i||n.push([u,r.length,p.FragmentType.Word]),n}static fragmentWidths(r,n,i){const u=new Float32Array(r.length);for(let s=0;s<r.length;++s){const a=r[s];u[s]=n.subarray(a[0],a[1]).reduce((h,b,m)=>h+b+(m<a[1]?i[m+a[0]]:0),0)}return u}static elideThresholds(r,n){switch(r.elide){case v.Label.Elide.Right:return[r.lineWidth-n,0];case v.Label.Elide.Middle:const i=r.lineWidth/2-n/2;return[i,i];case v.Label.Elide.Left:return[0,r.lineWidth-n];default:return[0,0]}}static elideFragments(r,n,i,u,s,a){const h=new Array,b=new Array;let m=0,M=0;for(let S=a?n.length-1:0;a?S>-1:S<n.length;a?--S:++S){const w=n[S];if(w[2]!==p.FragmentType.LineFeed){if(!(m+i[S]<r)){if(w[2]===p.FragmentType.Delimiter||m+u[a?w[1]-1:w[0]]>r)break;for(let N=a?w[1]-1:w[0];a?N>=w[0]:N<w[1];a?--N:++N){if(!(m+M+u[N]+s[N]<r)){h.push([a?N+1:w[0],a?w[1]:N,w[2]]),b.push(M);break}M+=u[N]+s[N]}break}m+=i[S],h.push(w),b.push(i[S])}}return[h,b,m+M]}static transformVertices(r,n,i,u){if(n!==void 0&&!d.mat4.equals(r,d.mat4.create()))for(let s=i;s<u;++s){const a=n.origin(s),h=g.v3();d.vec3.transformMat4(h,a,r);const b=g.v3();d.vec3.transformMat4(b,d.vec3.add(b,a,n.tangent(s)),r);const m=g.v3();d.vec3.transformMat4(m,d.vec3.add(m,a,n.up(s)),r),d.vec3.copy(n.origin(s),h),d.vec3.sub(n.tangent(s),b,h),d.vec3.sub(n.up(s),m,h)}}static updateRectangleMinMax(r,n){l.assert(r.length===6&&n.length===6,"expected the rectangles to have 6 values!");let i=0;for(;i<3;i++)r[i]=Math.min(r[i],n[i]);for(;i<6;i++)r[i]=Math.max(r[i],n[i])}static minMax(r,n,i){const u=Math.min(r,...i),s=Math.max(n,...i);return d.vec2.fromValues(u,s)}static getMinMaxVertices(r,n,i){let u=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,b=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY;for(let M=n;M<i;++M){const S=p.minMax(u,s,[r.origin(M)[0],r.origin(M)[0]+r.up(M)[0],r.origin(M)[0]+r.tangent(M)[0]]);u=S[0],s=S[1];const w=p.minMax(a,h,[r.origin(M)[1],r.origin(M)[1]+r.up(M)[1],r.origin(M)[1]+r.tangent(M)[1]]);a=w[0],h=w[1];const N=p.minMax(b,m,[r.origin(M)[2],r.origin(M)[2]+r.up(M)[2],r.origin(M)[2]+r.tangent(M)[2]]);b=N[0],m=N[1]}return[u,a,b,s,h,m]}static transformAlignment(r,n,i,u,s){if(i===void 0||n===v.Label.Alignment.Left)return;let a=-r;n===v.Label.Alignment.Center&&(a*=.5);for(let h=u;h<s;++h)i.origin(h)[0]+=a}static transform(r,n,i){const u=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const S of i)p.transformAlignment(S[2],r.alignment,n,S[0],S[1]),p.updateRectangleMinMax(u,p.getMinMaxVertices(n,S[0],S[1])),p.transformVertices(r.staticTransform,n,S[0],S[1]);const s=u[3]-u[0],a=u[4]-u[1],h=d.vec4.transformMat4(d.vec4.create(),d.vec4.fromValues(0,0,0,1),r.staticTransform),b=d.vec4.transformMat4(d.vec4.create(),d.vec4.fromValues(s,0,0,1),r.staticTransform),m=d.vec4.transformMat4(d.vec4.create(),d.vec4.fromValues(0,a,0,1),r.staticTransform),M=d.vec2.fromValues(d.vec4.distance(b,h),d.vec4.distance(m,h));r.extent=[M[0],M[1]]}static typeset(r,n){if(r.length===0)return 0;l.assert(r.fontFace!==void 0,"expected a font face for label before typesetting");const i=r.fontFace,u=k=>k<r.length?i.glyph(r.charCodeAt(k)):i.glyph(r.ellipsis.charCodeAt(k-r.length)),s=p.advances(r),a=p.kernings(r),h=p.fragments(r),b=p.fragmentWidths(h,s,a),m=d.vec2.fromValues(0,-p.lineAnchorOffset(r)),M=new Array;let S=0;const w=r.elide!==v.Label.Elide.None,N=(k,X,$=NaN,V=s,Y=a,Z=0)=>{let J=S;for(let ee=0;ee<k.length;++ee){const K=k[ee];if(K[0]>=K[1])continue;const re=!w&&K[2]===p.FragmentType.LineFeed;let ue=!1;if(!w&&!re&&r.wrap){const ie=K[2]!==p.FragmentType.Delimiter||u(K[0]).depictable(),de=K[2]===p.FragmentType.Word&&ee<k.length-1&&k[ee+1][2]===p.FragmentType.Delimiter&&u(k[ee+1][0]).depictable();ue=m[0]+(ie?X[ee]:0)+(de?X[ee+1]:0)>r.lineWidth}if(!re&&!ue||(M.push([J,S,m[0]]),J=S,m[0]=0,m[1]-=i.lineHeight,!re))for(let ie=K[0];ie<K[1];++ie)u(ie).depictable()&&(p.writeVertex(i,m,u(ie),n,S),++S),m[0]+=V[ie-Z]+Y[ie-Z]}J<S&&M.push([J,S,m[0]])},F=b.reduce((k,X)=>k+X,0);if(w&&F>r.lineWidth){const k=[[r.length,r.length+r.ellipsis.length,p.FragmentType.Word]],X=p.advances(r,r.ellipsis),$=p.kernings(r,r.ellipsis),V=p.fragmentWidths([[0,r.ellipsis.length,p.FragmentType.Word]],X,$),Y=V[0];if(r.lineWidth<Y)return 0;const Z=p.elideThresholds(r,Y),[J,ee,K]=p.elideFragments(Z[0],h,b,s,a,!1);r.elide===v.Label.Elide.Middle&&(Z[1]+=Z[0]-K);const[re,ue]=p.elideFragments(Z[1],h,b,s,a,!0);N(J,new Float32Array(ee)),N(k,V,NaN,X,$,r.length),N(re.reverse(),new Float32Array(ue.reverse())),l.assert(M.length<4,`expected at most 3-line-yield from advance, given ${M}`),M[0][1]=M[M.length-1][1],M[0][2]=m[0],M.length=1}else N(h,b,r.lineWidth);return p.transform(r,n,M),n.shrink(S),S}}c.Typesetter=p,p.DELIMITERS=`
 ,.-/()[]<>`,function(o){(function(r){r[r.Word=0]="Word",r[r.Delimiter=1]="Delimiter",r[r.LineFeed=2]="LineFeed"})(o.FragmentType||(o.FragmentType={}))}(p=c.Typesetter||(c.Typesetter={}))},6942:function(x,c,_){var d=this&&this.__decorate||function(r,n,i,u){var s,a=arguments.length,h=a<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,i):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,n,i,u);else for(var b=r.length-1;b>=0;b--)(s=r[b])&&(h=(a<3?s(h):a>3?s(n,i,h):s(n,i))||h);return a>3&&h&&Object.defineProperty(n,i,h),h};Object.defineProperty(c,"__esModule",{value:!0}),c.Texture2D=void 0;const l=_(9696),g=_(423),v=_(1030),p=_(2281);class o extends p.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._internalFormat=0,this._format=0,this._type=0,this._mipmap=!1,this._anisotropy=void 0}create(n,i,u,s,a){l.assert(n>0&&i>0,"texture requires valid width and height of greater than zero");const h=this._context.gl,b=this._context.gl2facade;if(this._object=h.createTexture(),this._width=n,this._height=i,this._internalFormat=u,this._format=s,this._type=a,h.bindTexture(h.TEXTURE_2D,this._object),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),o.MAX_ANISOTROPY===void 0)if(this._context.supportsTextureFilterAnisotropic){const m=this._context.textureFilterAnisotropic;o.MAX_ANISOTROPY=h.getParameter(m.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else o.MAX_ANISOTROPY=0;return b.texImage2D(h.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type),h.bindTexture(h.TEXTURE_2D,o.DEFAULT_TEXTURE),this._valid=h.isTexture(this._object),this.reallocate(),this._object}delete(){l.assert(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0}reallocate(){const n=this.context.gl,i=this._context.gl2facade;let u=this._width*this._height*g.byteSizeOfFormat(this.context,this._internalFormat);this._type===i.HALF_FLOAT&&this._internalFormat!==n.RGBA16F?u*=2:this._type===n.FLOAT&&this._internalFormat!==n.RGBA16F&&(u*=4),this.context.allocationRegister.reallocate(this._identifier,u)}bind(n){const i=this.context.gl;n&&i.activeTexture(n),i.bindTexture(i.TEXTURE_2D,this._object)}unbind(n){const i=this.context.gl;n&&i.activeTexture(n),i.bindTexture(i.TEXTURE_2D,o.DEFAULT_TEXTURE)}fetch(n,i=!1,u=!1){const s=this.context.gl;return new Promise((a,h)=>{const b=new Image;b.onerror=()=>{l.log(l.LogLevel.Error,`loading image from '${b.src}' failed`),h()},b.onload=()=>{this.resize(b.width,b.height),u||s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!0),this.data(b),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),a()},i&&(b.crossOrigin="anonymous"),b.src=n})}data(n,i=!0,u=!0){const s=this.context.gl,a=this._context.gl2facade;i&&this.bind(),a.texImage2D(s.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type,n),this._anisotropy!==void 0&&this._anisotropy>0?this.maxAnisotropy(this._anisotropy,!1,!1):this._mipmap&&this.generateMipMap(!1,!1),u&&this.unbind(),this.reallocate()}filter(n,i,u=!0,s=!0){const a=this.context.gl;u&&this.bind(),l.logIf(n===a.LINEAR_MIPMAP_LINEAR||n===a.LINEAR_MIPMAP_NEAREST,l.LogLevel.Debug,"magnification does not utilize a MipMap (refer to LINEAR and NEAREST only)"),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,n),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,i),this._mipmap=i===a.LINEAR_MIPMAP_LINEAR||i===a.LINEAR_MIPMAP_NEAREST,this._mipmap&&a.generateMipmap(a.TEXTURE_2D),s&&this.unbind()}wrap(n,i,u=!0,s=!0){const a=this.context.gl;u&&this.bind(),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,n),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,i),s&&this.unbind()}reformat(n,i,u,s=!0,a=!0){(n!==this._internalFormat||i!==void 0&&i!==this._format||u!==void 0&&u!==this._type)&&(l.assert(n!==void 0,"valid internal format expected"),this._internalFormat=n,i&&(this._format=i),u&&(this._type=u),this.data(void 0,s,a))}resize(n,i,u=!0,s=!0){n===this._width&&i===this._height||(this._width=n,this._height=i,this.data(void 0,u,s))}generateMipMap(n=!0,i=!0){const u=this.context.gl;n&&this.bind(),u.generateMipmap(u.TEXTURE_2D),i&&this.unbind(),this._mipmap=!0}maxAnisotropy(n,i=!0,u=!0){if(this._context.supportsTextureFilterAnisotropic===!1)return void l.log(l.LogLevel.Debug,"setting anisotropy not supported (EXT_texture_filter_anisotropic missing)");const s=this.context.gl,a=this._context.textureFilterAnisotropic;return this._anisotropy=n===void 0?void 0:Math.max(0,Math.min(o.MAX_ANISOTROPY,n)),l.logIf(n!==this._anisotropy,l.LogLevel.Debug,`value clamped to max supported anisotropy of ${o.MAX_ANISOTROPY}, given ${n}`),i&&this.bind(),s.texParameterf(s.TEXTURE_2D,a.TEXTURE_MAX_ANISOTROPY_EXT,this._anisotropy===void 0?0:this._anisotropy),this.generateMipMap(!1,u),this._anisotropy}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get size(){return this.assertInitialized(),[this._width,this._height]}}o.DEFAULT_TEXTURE=void 0,o.MAX_ANISOTROPY=void 0,d([v.Initializable.assert_initialized()],o.prototype,"bind",null),d([v.Initializable.assert_initialized()],o.prototype,"unbind",null),d([v.Initializable.assert_initialized()],o.prototype,"fetch",null),d([v.Initializable.assert_initialized()],o.prototype,"data",null),d([v.Initializable.assert_initialized()],o.prototype,"filter",null),d([v.Initializable.assert_initialized()],o.prototype,"wrap",null),d([v.Initializable.assert_initialized()],o.prototype,"reformat",null),d([v.Initializable.assert_initialized()],o.prototype,"resize",null),c.Texture2D=o},4850:function(x,c,_){var d=this&&this.__decorate||function(r,n,i,u){var s,a=arguments.length,h=a<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,i):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,n,i,u);else for(var b=r.length-1;b>=0;b--)(s=r[b])&&(h=(a<3?s(h):a>3?s(n,i,h):s(n,i))||h);return a>3&&h&&Object.defineProperty(n,i,h),h};Object.defineProperty(c,"__esModule",{value:!0}),c.Texture2DArray=void 0;const l=_(9696),g=_(423),v=_(1030),p=_(2281);class o extends p.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._depth=0,this._internalFormat=0,this._format=0,this._type=0}create(n,i,u,s,a,h){l.assert(this._context.supportsTexImage3D,"expected texImage3D to be supported"),l.assert(n>0&&i>0&&u>0,"texture requires valid width, height, and depth of greater than zero");const b=this._context.gl,m=this._context.gl2facade;return this._object=b.createTexture(),this._width=n,this._height=i,this._depth=u,this._internalFormat=s,this._format=a,this._type=h,b.bindTexture(b.TEXTURE_2D_ARRAY,this._object),b.texParameteri(b.TEXTURE_2D_ARRAY,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D_ARRAY,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D_ARRAY,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D_ARRAY,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D_ARRAY,b.TEXTURE_WRAP_R,b.CLAMP_TO_EDGE),m.texImage3D(b.TEXTURE_2D_ARRAY,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type),b.bindTexture(b.TEXTURE_2D_ARRAY,o.DEFAULT_TEXTURE),this._valid=b.isTexture(this._object),this.reallocate(),this._object}delete(){l.assert(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0,this._depth=0}reallocate(){const n=this.context.gl,i=this._context.gl2facade;let u=this._width*this._height*this._depth*g.byteSizeOfFormat(this.context,this._internalFormat);this._type===i.HALF_FLOAT&&this._internalFormat!==n.RGBA16F?u*=2:this._type===n.FLOAT&&this._internalFormat!==n.RGBA16F&&(u*=4),this.context.allocationRegister.reallocate(this._identifier,u)}bind(n){const i=this.context.gl;n&&i.activeTexture(n),i.bindTexture(i.TEXTURE_2D_ARRAY,this._object)}unbind(n){const i=this.context.gl;n&&i.activeTexture(n),i.bindTexture(i.TEXTURE_2D_ARRAY,o.DEFAULT_TEXTURE)}fetch(n,i,u=!1){return new Promise((s,a)=>{const h=new Image;h.onerror=()=>{l.log(l.LogLevel.Error,`loading image from '${h.src}' failed`),a()},h.onload=()=>{this.resize(h.width,h.height/i,i),this.data(h),s()},u&&(h.crossOrigin="anonymous"),h.src=n})}data(n,i=!0,u=!0){const s=this.context.gl,a=this._context.gl2facade;i&&this.bind(),a.texImage3D(s.TEXTURE_2D_ARRAY,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type,n),u&&this.unbind(),this.reallocate()}filter(n,i,u=!0,s=!0){const a=this.context.gl;u&&this.bind(),a.texParameteri(a.TEXTURE_2D_ARRAY,a.TEXTURE_MAG_FILTER,n),a.texParameteri(a.TEXTURE_2D_ARRAY,a.TEXTURE_MIN_FILTER,i),s&&this.unbind()}wrap(n,i,u,s=!0,a=!0){const h=this.context.gl;s&&this.bind(),h.texParameteri(h.TEXTURE_2D_ARRAY,h.TEXTURE_WRAP_S,n),h.texParameteri(h.TEXTURE_2D_ARRAY,h.TEXTURE_WRAP_T,i),h.texParameteri(h.TEXTURE_2D_ARRAY,h.TEXTURE_WRAP_R,u),a&&this.unbind()}reformat(n,i,u,s=!0,a=!0){(n!==this._internalFormat||i!==void 0&&i!==this._format||u!==void 0&&u!==this._type)&&(l.assert(n!==void 0,"valid internal format expected"),this._internalFormat=n,i&&(this._format=i),u&&(this._type=u),this.data(void 0,s,a))}resize(n,i,u,s=!0,a=!0){n===this._width&&i===this._height&&u===this._depth||(this._width=n,this._height=i,this._depth=u,this.data(void 0,s,a))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get depth(){return this.assertInitialized(),this._depth}get size(){return this.assertInitialized(),[this._width,this._height,this._depth]}}o.DEFAULT_TEXTURE=void 0,d([v.Initializable.assert_initialized()],o.prototype,"bind",null),d([v.Initializable.assert_initialized()],o.prototype,"unbind",null),d([v.Initializable.assert_initialized()],o.prototype,"fetch",null),d([v.Initializable.assert_initialized()],o.prototype,"data",null),d([v.Initializable.assert_initialized()],o.prototype,"filter",null),d([v.Initializable.assert_initialized()],o.prototype,"wrap",null),d([v.Initializable.assert_initialized()],o.prototype,"reformat",null),d([v.Initializable.assert_initialized()],o.prototype,"resize",null),c.Texture2DArray=o},7344:function(x,c,_){var d=this&&this.__decorate||function(r,n,i,u){var s,a=arguments.length,h=a<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,i):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,n,i,u);else for(var b=r.length-1;b>=0;b--)(s=r[b])&&(h=(a<3?s(h):a>3?s(n,i,h):s(n,i))||h);return a>3&&h&&Object.defineProperty(n,i,h),h};Object.defineProperty(c,"__esModule",{value:!0}),c.Texture3D=void 0;const l=_(9696),g=_(423),v=_(1030),p=_(2281);class o extends p.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._depth=0,this._internalFormat=0,this._format=0,this._type=0}create(n,i,u,s,a,h){l.assert(this._context.supportsTexImage3D,"expected texImage3D to be supported"),l.assert(n>0&&i>0&&u>0,"texture requires valid width, height, and depth of greater than zero");const b=this._context.gl,m=this._context.gl2facade;return this._object=b.createTexture(),this._width=n,this._height=i,this._depth=u,this._internalFormat=s,this._format=a,this._type=h,b.bindTexture(b.TEXTURE_3D,this._object),b.texParameteri(b.TEXTURE_3D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_3D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_3D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_3D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_3D,b.TEXTURE_WRAP_R,b.CLAMP_TO_EDGE),m.texImage3D(b.TEXTURE_3D,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type),b.bindTexture(b.TEXTURE_3D,o.DEFAULT_TEXTURE),this._valid=b.isTexture(this._object),this.reallocate(),this._object}delete(){l.assert(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0,this._depth=0}reallocate(){const n=this.context.gl,i=this._context.gl2facade;let u=this._width*this._height*this._depth*g.byteSizeOfFormat(this.context,this._internalFormat);this._type===i.HALF_FLOAT&&this._internalFormat!==n.RGBA16F?u*=2:this._type===n.FLOAT&&this._internalFormat!==n.RGBA16F&&(u*=4),this.context.allocationRegister.reallocate(this._identifier,u)}bind(n){const i=this.context.gl;n&&i.activeTexture(n),i.bindTexture(i.TEXTURE_3D,this._object)}unbind(n){const i=this.context.gl;n&&i.activeTexture(n),i.bindTexture(i.TEXTURE_3D,o.DEFAULT_TEXTURE)}load(n,i,u=!1,s=!1){return new Promise((a,h)=>{const b=new Image;b.onerror=()=>h(),b.onload=()=>{const m=document.createElement("canvas"),M=m.getContext("2d");let S,w,N,F;if(l.assert(M!==void 0,"expected auxiliary 2D context for temporary slicing"),s===!1){l.assert(b.height%i==0&&b.height/i>=1,"expected height to be a multitude of number of slices"),S=b.width,w=Math.floor(b.height/i),N=i,m.width=S,m.height=w,F=new Uint8Array(S*w*N);const k=S*w;for(let X=0;X<i;++X){M.drawImage(b,0,w*X,S,w,0,0,S,w);const $=M.getImageData(0,0,S,w).data;for(let V=0;V<k;++V)F[k*X+V]=$[4*V]}}else{l.assert(b.width%i==0&&b.width/i>=1,"expected width to be a multitude of number of slices"),S=Math.floor(b.width/i),w=b.height,N=i,m.width=S,m.height=w,F=new Uint8Array(S*w*N);const k=S*w;for(let X=0;X<i;++X){M.drawImage(b,S*X,0,S,w,0,0,S,w);const $=M.getImageData(0,0,S,w).data;for(let V=0;V<k;++V)F[k*X+V]=$[4*V]}}this.resize(S,w,N),this.data(F),a()},u&&(b.crossOrigin="anonymous"),b.src=n})}loadFromSingleImages(n,i,u=!1,s=!1){return new Promise((a,h)=>{const b=document.createElement("canvas"),m=b.getContext("2d"),M=[];let S,w;for(let N=0;N<n.length;N++){const F=new Image;F.onerror=()=>h();const k=new Promise((X,$)=>{try{F.onload=()=>{const V=F.width,Y=F.height;s===!1?(S===void 0?(S=V*n.length,b.width=S):l.assert(V*n.length===S,"The single images do not have the same width"),w===void 0?(w=Y,b.height=w):l.assert(Y===w,"The single images do not have the same height"),m.drawImage(F,V*N,0)):(S===void 0?(S=V,b.width=S):l.assert(V===S,"The single images do not have the same width"),w===void 0?(w=Y*n.length,b.height=w):l.assert(Y*n.length===w,"The single images do not have the same height"),m.drawImage(F,0,Y*N)),X()}}catch(V){$(V)}});M.push(k),u&&(F.crossOrigin="anonymous"),F.src=n[N]}Promise.all(M).then(()=>{const N=b.toDataURL("image/png",1);return this.load(N,i,u,s).then(()=>{a()})})})}data(n,i=!0,u=!0){const s=this.context.gl,a=this._context.gl2facade;i&&this.bind(),a.texImage3D(s.TEXTURE_3D,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type,n),u&&this.unbind(),this.reallocate()}filter(n,i,u=!0,s=!0){const a=this.context.gl;u&&this.bind(),a.texParameteri(a.TEXTURE_3D,a.TEXTURE_MAG_FILTER,n),a.texParameteri(a.TEXTURE_3D,a.TEXTURE_MIN_FILTER,i),s&&this.unbind()}wrap(n,i,u,s=!0,a=!0){const h=this.context.gl;s&&this.bind(),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_S,n),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_T,i),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_R,u),a&&this.unbind()}reformat(n,i,u,s=!0,a=!0){(n!==this._internalFormat||i!==void 0&&i!==this._format||u!==void 0&&u!==this._type)&&(l.assert(n!==void 0,"valid internal format expected"),this._internalFormat=n,i&&(this._format=i),u&&(this._type=u),this.data(void 0,s,a))}resize(n,i,u,s=!0,a=!0){n===this._width&&i===this._height&&u===this._depth||(this._width=n,this._height=i,this._depth=u,this.data(void 0,s,a))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get depth(){return this.assertInitialized(),this._depth}get size(){return this.assertInitialized(),[this._width,this._height,this._depth]}}o.DEFAULT_TEXTURE=void 0,d([v.Initializable.assert_initialized()],o.prototype,"bind",null),d([v.Initializable.assert_initialized()],o.prototype,"unbind",null),d([v.Initializable.assert_initialized()],o.prototype,"load",null),d([v.Initializable.assert_initialized()],o.prototype,"loadFromSingleImages",null),d([v.Initializable.assert_initialized()],o.prototype,"data",null),d([v.Initializable.assert_initialized()],o.prototype,"filter",null),d([v.Initializable.assert_initialized()],o.prototype,"wrap",null),d([v.Initializable.assert_initialized()],o.prototype,"reformat",null),d([v.Initializable.assert_initialized()],o.prototype,"resize",null),c.Texture3D=o},945:function(x,c,_){var d=this&&this.__decorate||function(r,n,i,u){var s,a=arguments.length,h=a<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,i):u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(r,n,i,u);else for(var b=r.length-1;b>=0;b--)(s=r[b])&&(h=(a<3?s(h):a>3?s(n,i,h):s(n,i))||h);return a>3&&h&&Object.defineProperty(n,i,h),h};Object.defineProperty(c,"__esModule",{value:!0}),c.TextureCube=void 0;const l=_(9696),g=_(423),v=_(1030),p=_(2281);class o extends p.AbstractObject{constructor(){super(...arguments),this._size=0,this._internalFormat=0,this._format=0,this._type=0,this._bytes=[0,0,0,0,0,0]}faceID(n){const i=this._context.gl;switch(n){case i.TEXTURE_CUBE_MAP_POSITIVE_X:return 0;case i.TEXTURE_CUBE_MAP_NEGATIVE_X:return 1;case i.TEXTURE_CUBE_MAP_POSITIVE_Y:return 2;case i.TEXTURE_CUBE_MAP_NEGATIVE_Y:return 3;case i.TEXTURE_CUBE_MAP_POSITIVE_Z:return 4;case i.TEXTURE_CUBE_MAP_NEGATIVE_Z:return 5;default:return l.assert(!1,`expected texture cube map identifier (${i.TEXTURE_CUBE_MAP_POSITIVE_X}, ${i.TEXTURE_CUBE_MAP_NEGATIVE_X}, ${i.TEXTURE_CUBE_MAP_POSITIVE_Y}, ${i.TEXTURE_CUBE_MAP_NEGATIVE_Y}, ${i.TEXTURE_CUBE_MAP_POSITIVE_Z}, or${i.TEXTURE_CUBE_MAP_NEGATIVE_Z}), given ${n}`),-1}}create(n,i,u,s){l.assert(n>0,"texture cube requires valid size (width/height) of greater than zero");const a=this._context.gl,h=this._context.gl2facade;return this._object=a.createTexture(),this._size=n,this._internalFormat=i,this._format=u,this._type=s,a.bindTexture(a.TEXTURE_CUBE_MAP,this._object),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),h.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),h.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),h.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),h.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),h.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),h.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),a.bindTexture(a.TEXTURE_CUBE_MAP,o.DEFAULT_TEXTURE),this._valid=a.isTexture(this._object),this.context.allocationRegister.reallocate(this._identifier,0),this._object}delete(){l.assert(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._size=0}cropImage(n,i,u,s,a){const h=document.createElement("canvas");h.width=s,h.height=a;const b=h.getContext("2d");return b?(b.drawImage(n,i,u,s,a,0,0,s,a),b.getImageData(0,0,s,a)):(console.log(l.LogLevel.Warning,"2D context creation failed when cropping image."),new ImageData(0,0))}extractMipLevelFromAtlas(n,i){const u=this.context.gl,s=n.height/2*Math.pow(.5,i),a=[0,0],h=[n.width,n.height];for(let F=0;F<i;++F)h[0]/=2,h[1]/=2,a[0]+=h[0],a[1]+=h[1];u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,!0);const b=this.cropImage(n,a[0],a[1],s,s);this.data([u.TEXTURE_CUBE_MAP_NEGATIVE_X,b],i);const m=this.cropImage(n,a[0]+s,a[1],s,s);this.data([u.TEXTURE_CUBE_MAP_POSITIVE_Z,m],i);const M=this.cropImage(n,a[0]+2*s,a[1],s,s);this.data([u.TEXTURE_CUBE_MAP_POSITIVE_X,M],i);const S=this.cropImage(n,a[0]+3*s,a[1],s,s);this.data([u.TEXTURE_CUBE_MAP_NEGATIVE_Z,S],i);const w=this.cropImage(n,a[0],a[1]+s,s,s);this.data([u.TEXTURE_CUBE_MAP_POSITIVE_Y,w],i);const N=this.cropImage(n,a[0]+s,a[1]+s,s,s);this.data([u.TEXTURE_CUBE_MAP_NEGATIVE_Y,N],i),u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,!1)}bind(n){const i=this.context.gl;n&&i.activeTexture(n),i.bindTexture(i.TEXTURE_CUBE_MAP,this._object)}unbind(n){const i=this.context.gl;n&&i.activeTexture(n),i.bindTexture(i.TEXTURE_CUBE_MAP,o.DEFAULT_TEXTURE)}fetch(n,i=!1,u=0){const s=this.context.gl;return new Promise((a,h)=>{const b=new Array;n.positiveX&&b.push([s.TEXTURE_CUBE_MAP_POSITIVE_X,n.positiveX]),n.negativeX&&b.push([s.TEXTURE_CUBE_MAP_NEGATIVE_X,n.negativeX]),n.positiveY&&b.push([s.TEXTURE_CUBE_MAP_POSITIVE_Y,n.positiveY]),n.negativeY&&b.push([s.TEXTURE_CUBE_MAP_NEGATIVE_Y,n.negativeY]),n.positiveZ&&b.push([s.TEXTURE_CUBE_MAP_POSITIVE_Z,n.positiveZ]),n.negativeZ&&b.push([s.TEXTURE_CUBE_MAP_NEGATIVE_Z,n.negativeZ]);let m=b.length;for(const M of b){const S=new Image;S.crossOrigin="anonymous",S.onerror=()=>h(),S.onload=()=>{const w=this.calculateMipLevelSize(u);S.width===S.height?S.width===w?(s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!0),this.data([M[0],S],u),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),m-=1,m===0&&a()):l.log(l.LogLevel.Warning,`image ignored, width and height expected to match this texture's size ${w}, given ${S.width}`):l.log(l.LogLevel.Warning,"image ignored, width and height expected to be equal (square image)")},i&&(S.crossOrigin="anonymous"),S.src=M[1]}})}fetchMipmapAtlas(n,i=!1){return new Promise((u,s)=>{const a=new Image;a.onerror=()=>s(),a.onload=()=>{if(a.width!==2*a.height)return void l.log(l.LogLevel.Warning,"Mipmap atlas expected to have dimensions of 2x1.");const h=a.height/2,b=Math.log2(h);for(let m=0;m<b;++m)this.extractMipLevelFromAtlas(a,m);u()},i&&(a.crossOrigin="anonymous"),a.src=n})}calculateMipLevelSize(n){return this._size*Math.pow(.5,n)}data(n,i=0,u=!0,s=!0){const a=this.context.gl,h=this.context.gl2facade,b=this.calculateMipLevelSize(i);let m=b*b*g.byteSizeOfFormat(this.context,this._internalFormat);if(this._type===this.context.gl2facade.HALF_FLOAT&&this._internalFormat!==this.context.gl.RGBA16F?m*=2:this._type===this.context.gl.FLOAT&&this._internalFormat!==this.context.gl.RGBA16F&&(m*=4),u&&this.bind(),n instanceof Array&&n.length===2){h.texImage2D(n[0],i,this._internalFormat,b,b,0,this._format,this._type,n[1]);const M=this.faceID(n[0]);this.context.allocationRegister.deallocate(this._identifier,this._bytes[M]),this.context.allocationRegister.allocate(this._identifier,m),this._bytes[M]=m}else{const M=n;M.positiveX!==void 0&&(h.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,i,this._internalFormat,b,b,0,this._format,this._type,M.positiveX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[0]),this.context.allocationRegister.allocate(this._identifier,m),this._bytes[0]=m),M.negativeX!==void 0&&(h.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,i,this._internalFormat,b,b,0,this._format,this._type,M.negativeX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[1]),this.context.allocationRegister.allocate(this._identifier,m),this._bytes[1]=m),M.positiveY!==void 0&&(h.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,i,this._internalFormat,b,b,0,this._format,this._type,M.positiveY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[2]),this.context.allocationRegister.allocate(this._identifier,m),this._bytes[2]=m),M.negativeY!==void 0&&(h.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,i,this._internalFormat,b,b,0,this._format,this._type,M.negativeY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[3]),this.context.allocationRegister.allocate(this._identifier,m),this._bytes[3]=m),M.positiveZ!==void 0&&(h.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,i,this._internalFormat,b,b,0,this._format,this._type,M.positiveZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[4]),this.context.allocationRegister.allocate(this._identifier,m),this._bytes[4]=m),M.negativeZ!==void 0&&(h.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,i,this._internalFormat,b,b,0,this._format,this._type,M.negativeZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[5]),this.context.allocationRegister.allocate(this._identifier,m),this._bytes[5]=m)}s&&this.unbind()}filter(n,i,u=!0,s=!0){const a=this.context.gl;u&&this.bind(),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,n),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,i),s&&this.unbind()}wrap(n,i,u=!0,s=!0){const a=this.context.gl;u&&this.bind(),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,n),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,i),s&&this.unbind()}levels(n,i,u=!0,s=!0){const a=this.context.gl;u&&this.bind(),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_BASE_LEVEL,n),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAX_LEVEL,i),s&&this.unbind()}reformat(n,i,u,s=!0,a=!0){(n!==this._internalFormat||i!==void 0&&i!==this._format||u!==void 0&&u!==this._type)&&(l.assert(n!==void 0,"valid internal format expected"),this._internalFormat=n,i&&(this._format=i),u&&(this._type=u),this.data({clearOnUndefined:!0},0,s,a))}resize(n,i=!0,u=!0){n!==this._size&&(this._size=n,this.data({clearOnUndefined:!0},0,i,u))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get size(){return this.assertInitialized(),this._size}}o.DEFAULT_TEXTURE=void 0,d([v.Initializable.assert_initialized()],o.prototype,"bind",null),d([v.Initializable.assert_initialized()],o.prototype,"unbind",null),d([v.Initializable.assert_initialized()],o.prototype,"fetch",null),d([v.Initializable.assert_initialized()],o.prototype,"fetchMipmapAtlas",null),d([v.Initializable.assert_initialized()],o.prototype,"data",null),d([v.Initializable.assert_initialized()],o.prototype,"filter",null),d([v.Initializable.assert_initialized()],o.prototype,"wrap",null),d([v.Initializable.assert_initialized()],o.prototype,"levels",null),d([v.Initializable.assert_initialized()],o.prototype,"reformat",null),d([v.Initializable.assert_initialized()],o.prototype,"resize",null),c.TextureCube=o},339:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TileCameraGenerator=void 0;const d=_(3659),l=_(2111),g=_(9696);class v{constructor(){this._tileSize=[0,0],this._padding=d.vec4.fromValues(0,0,0,0),this._tile=-1,this._algorithm=v.Algorithm.ScanLine,this._offset=[0,0]}static hilbertIndices(o,r,n,i,u,s,a,h,b,m,M){if(m>0)return M=this.hilbertIndices(o,r,n,i,u,h/2,b/2,s/2,a/2,m-1,M),M=this.hilbertIndices(o,r,n,i+s/2,u+a/2,s/2,a/2,h/2,b/2,m-1,M),M=this.hilbertIndices(o,r,n,i+s/2+h/2,u+a/2+b/2,s/2,a/2,h/2,b/2,m-1,M),this.hilbertIndices(o,r,n,i+s/2+h,u+a/2+b,-h/2,-b/2,-s/2,-a/2,m-1,M);if(u+=(a+b-1)/2,(i+=(s+h-1)/2)<r&&u<n){const S=2*M;o[S+0]=i,o[S+1]=u,++M}return M}static generateHilbertIndices(o,r,n){g.assert(o.length===2*r*n,`expected interleaved indices-array of length ${2*r*n}, given ${o.length}`);const i=Math.max(r,n),u=Math.ceil(Math.log2(i)),s=g.upperPowerOfTwo(i);this.hilbertIndices(o,r,n,0,0,s,0,0,s,u,0)}static generateScanLineIndices(o,r,n){g.assert(o.length===2*r*n,`expected interleaved indices-array of length ${2*r*n}, given ${o.length}`);for(let i=0;i<n;++i)for(let u=0;u<r;++u){const s=2*(u+i*r);o[s+0]=u,o[s+1]=i}}static generateZCurveIndices(o,r,n){g.assert(o.length===2*r*n,`expected interleaved indices-array of length ${2*r*n}, given ${o.length}`);const i=Math.max(r,n),u=2*Math.floor(Math.log2(i));let s=0;for(let a=0;a<r*n;++s){let h=0,b=0;for(let m=0;m<u;++m)h+=(s>>2*m&1)<<m,b+=(s>>2*m+1&1)<<m;if(h<r&&b<n){const m=2*a;o[m+0]=h,o[m+1]=b,++a}}}invalidate(o){o&&(this._indices=new Uint16Array(0)),this._valid=!1}ensureValidIterationIndices(){if(!(this._indices.length>0))switch(this._indices=new Uint16Array(2*this.numTiles),this._algorithm){case v.Algorithm.ScanLine:v.generateScanLineIndices(this._indices,this.numXTiles,this.numYTiles);break;case v.Algorithm.HilbertCurve:v.generateHilbertIndices(this._indices,this.numXTiles,this.numYTiles);break;case v.Algorithm.ZCurve:v.generateZCurveIndices(this._indices,this.numXTiles,this.numYTiles);break;default:v.generateScanLineIndices(this._indices,this.numXTiles,this.numYTiles)}}tableIndices(){this.ensureValidIterationIndices();const o=2*this.tile;return[this._indices[o+0],this._indices[o+1]]}getPaddedTileSize(){return[this.padding[1]+this.padding[3]+this.tileSize[0],this.padding[0]+this.padding[2]+this.tileSize[1]]}nextTile(){return!(this.tile>=this.numTiles-1||(this.tile<0&&(this.tile=-1),++this.tile,this.update(),0))}hasNextTile(){return this.tile<=this.numTiles-1&&this.tile>=0}reset(){this.tile=-1,this._offset[0]=0,this._offset[1]=0}sourceCameraChanged(){g.assert(this._sourceCamera!==void 0,"expected the unput/source camera to be defined"),this._camera=Object.create(this._sourceCamera)}update(){if(this._valid)return this._offset;if(this.numTiles<=this.tile||0>this.tile)return g.log(g.LogLevel.Warning,`index ${this.tile} is out of bounds ${this.numTiles}, returning first tile`),this._offset;g.assert(this._sourceViewport!==void 0&&this._sourceCamera!==void 0,"expected source camera and source viewport to be defined before updating"),this._valid=!0;const o=this.tableIndices(),r=this.sourceViewport,n=this.getPaddedTileSize(),i=[0,0];i[0]=o[0]*this.tileSize[0]+n[0]/2,i[1]=o[1]*this.tileSize[1]+n[1]/2;const u=[0,0];u[0]=o[0]*this.tileSize[0],u[1]=o[1]*this.tileSize[1];const s=[2*i[0]/r[0]-1,2*i[1]/r[1]-1],a=d.vec3.fromValues(r[0]/n[0],r[1]/n[1],1),h=d.vec3.fromValues(-s[0],-s[1],0),b=d.mat4.scale(l.m4(),d.mat4.identity(l.m4()),a),m=d.mat4.translate(l.m4(),b,h);return this._camera.postViewProjection=m,this._offset=u,u}get valid(){return this._camera!==void 0&&this._sourceCamera!==void 0&&this._valid}get numXTiles(){return g.assert(this._sourceViewport!==void 0,"expected the source viewport to be defined"),Math.ceil(this.sourceViewport[0]/this.tileSize[0])}get numYTiles(){return g.assert(this._sourceViewport!==void 0,"expected the source viewport to be defined"),Math.ceil(this.sourceViewport[1]/this.tileSize[1])}get numTiles(){return this.numXTiles*this.numYTiles}get offset(){return this._offset}get camera(){return this._camera}get viewport(){return[this.offset[0],this.offset[1],this.tileSize[0],this.tileSize[1]]}get sourceCamera(){return this._sourceCamera}set sourceCamera(o){o!==void 0?(this._sourceCamera=o,this._camera=Object.create(o),this.invalidate(!1)):this._sourceCamera=this._camera=void 0}get tile(){return this._tile}set tile(o){this._tile!==o&&(this._tile=o,this.invalidate(!1))}get sourceViewport(){return this._sourceViewport}set sourceViewport(o){this._sourceViewport!==void 0&&o!==void 0&&this._sourceViewport[0]===o[0]&&this._sourceViewport[1]===o[1]||(this._sourceViewport=o,this.invalidate(!0))}get tileSize(){return this._tileSize}set tileSize(o){this._tileSize[0]===o[0]&&this._tileSize[1]===o[1]||(this._tileSize=o,this.invalidate(!0))}get padding(){return this._padding}set padding(o){d.vec4.equals(this._padding,o)||(this._padding=d.vec4.clone(o),this.invalidate(!1))}get algorithm(){return this._algorithm}set algorithm(o){this._algorithm!==o&&(this._algorithm=o,this.invalidate(!0))}}c.TileCameraGenerator=v,function(p){(function(o){o.ScanLine="scanline",o.HilbertCurve="hilbertcurve",o.ZCurve="zcurve"})(p.Algorithm||(p.Algorithm={}))}(v=c.TileCameraGenerator||(c.TileCameraGenerator={}))},4052:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TouchEventProvider=void 0;const d=_(7318),l=_(9696);class g{constructor(p,o){l.assert(p!==void 0,`expected valid canvas element on initialization, given ${p}`),this._element=p,this._timeframe=o}preventDefaultOnEvent(p,o){l.bitInBitfield(this._preventDefaultMask,p)&&o.preventDefault()}preventDefault(...p){for(const o of p)l.bitInBitfield(this._preventDefaultMask,o)||(this._preventDefaultMask|=o)}allowDefault(...p){for(const o of p)l.bitInBitfield(this._preventDefaultMask,o)&&(this._preventDefaultMask&=~o)}observable(p){switch(p){case g.Type.Start:return this.start$;case g.Type.End:return this.end$;case g.Type.Move:return this.move$;case g.Type.Cancel:return this.cancel$}return l.assert(!1,"Encountered unknown touch event."),new d.Observable}get start$(){return this._startSubject===void 0&&(this._startSubject=new d.ReplaySubject(void 0,this._timeframe),this._startListener=p=>{this.preventDefaultOnEvent(g.Type.Start,p),this._startSubject.next(p)},this._element.addEventListener("touchstart",this._startListener)),this._startSubject.asObservable()}get end$(){return this._endSubject===void 0&&(this._endSubject=new d.ReplaySubject(void 0,this._timeframe),this._endListener=p=>{this.preventDefaultOnEvent(g.Type.End,p),this._endSubject.next(p)},this._element.addEventListener("touchend",this._endListener)),this._endSubject.asObservable()}get move$(){return this._moveSubject===void 0&&(this._moveSubject=new d.ReplaySubject(void 0,this._timeframe),this._moveListener=p=>{this.preventDefaultOnEvent(g.Type.Move,p),this._moveSubject.next(p)},this._element.addEventListener("touchmove",this._moveListener)),this._moveSubject.asObservable()}get cancel$(){return this._cancelSubject===void 0&&(this._cancelSubject=new d.ReplaySubject(void 0,this._timeframe),this._cancelListener=p=>{this.preventDefaultOnEvent(g.Type.Cancel,p),this._cancelSubject.next(p)},this._element.addEventListener("touchcancel",this._cancelListener)),this._cancelSubject.asObservable()}}c.TouchEventProvider=g,function(v){(function(p){p[p.Start=1]="Start",p[p.End=2]="End",p[p.Move=4]="Move",p[p.Cancel=8]="Cancel"})(v.Type||(v.Type={}))}(g=c.TouchEventProvider||(c.TouchEventProvider={}))},2763:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TrackballModifier=void 0;const d=_(3659),l=_(2111),g=_(6491);class v extends g.CameraModifier{constructor(){super(...arguments),this._rotation=d.mat4.create(),this._sensitivity=v.DEFAULT_SENSITIVITY}initiate(o){this._initialPoint=o}process(o){this._currentPoint=o;const r=d.vec2.subtract(l.v2(),this._initialPoint,this._currentPoint);d.vec2.scale(r,r,window.devicePixelRatio*this._sensitivity),d.vec2.copy(this._initialPoint,this._currentPoint);const n=d.vec3.sub(l.v3(),this._reference.eye,this._reference.center);d.vec3.normalize(n,n);const i=d.vec3.normalize(l.v3(),this._reference.up),u=d.vec3.cross(l.v3(),n,i);d.vec3.scale(i,i,r[1]),d.vec3.scale(u,u,r[0]);const s=d.vec3.cross(l.v3(),d.vec3.add(l.v3(),i,u),n);d.vec3.normalize(s,s);const a=d.quat.setAxisAngle(d.quat.create(),s,d.vec2.len(r));d.mat4.multiply(this._rotation,this._rotation,d.mat4.fromQuat(l.m4(),a)),this.update()}update(){if(this._camera===void 0)return;const o=d.mat4.fromTranslation(l.m4(),this._reference.center);d.mat4.multiply(o,o,this._rotation),d.mat4.translate(o,o,d.vec3.negate(l.v3(),this._reference.center));const r=d.vec3.transformMat4(l.v3(),[0,1,0],this._rotation),n=d.vec3.transformMat4(l.v3(),this._reference.eye,o);this._camera.up=r,this._camera.eye=n}set sensitivity(o){this._sensitivity=o}get sensitivity(){return this._sensitivity}}c.TrackballModifier=v,v.DEFAULT_SENSITIVITY=.002},4934:(x,c,_)=>{const d=_(3659),l=_(2111),g=_(9696);var v;(function(p){function o(i){return g.assert(i.length===2,`expected length of buffer to be 2, given ${i.length}`),[i[0],i[1]]}function r(i){return g.assert(i.length===3,`expected length of buffer to be 3, given ${i.length}`),[i[0],i[1],i[2]]}function n(i){return g.assert(i.length===4,`expected length of buffer to be 4, given ${i.length}`),[i[0],i[1],i[2],i[3]]}p.tuple2=o,p.tuple3=r,p.tuple4=n,p.clampf=function(i,u){const s=l.clamp(i,0,1);return g.logIf(u!==void 0&&i<0||i>1,g.LogLevel.Info,`${u} clamped to [${s}], given [${i}]`),s},p.clampf2=function(i,u){const s=d.vec2.fromValues(i[0],i[1]);return(i[0]<0||i[0]>1||i[1]<0||i[1]>1)&&(l.clamp2(s,s,d.vec2.fromValues(0,0),d.vec2.fromValues(1,1)),g.logIf(u!==void 0,g.LogLevel.Info,`${u} clamped to [${s}], given [${i}]`)),o(s)},p.clampf3=function(i,u){const s=d.vec3.fromValues(i[0],i[1],i[2]);return(i[0]<0||i[0]>1||i[1]<0||i[1]>1||i[2]<0||i[2]>1)&&(l.clamp3(s,s,d.vec3.fromValues(0,0,0),d.vec3.fromValues(1,1,1)),g.logIf(u!==void 0,g.LogLevel.Info,`${u} clamped to [${s}], given [${i}]`)),r(s)},p.clampf4=function(i,u){const s=d.vec4.fromValues(i[0],i[1],i[2],i[3]);return(i[0]<0||i[0]>1||i[1]<0||i[1]>1||i[2]<0||i[2]>1||i[3]<0||i[3]>1)&&(l.clamp4(s,s,d.vec4.fromValues(0,0,0,0),d.vec4.fromValues(1,1,1,1)),g.logIf(u!==void 0,g.LogLevel.Info,`${u} clamped to [${s}], given [${i}]`)),n(s)},p.duplicate2=function(i){return[i[0],i[1]]},p.duplicate3=function(i){return[i[0],i[1],i[2]]},p.duplicate4=function(i){return[i[0],i[1],i[2],i[3]]},p.equals2=function(i,u){return i[0]===u[0]&&i[1]===u[1]},p.equals3=function(i,u){return i[0]===u[0]&&i[1]===u[1]&&i[2]===u[2]},p.equals4=function(i,u){return i[0]===u[0]&&i[1]===u[1]&&i[2]===u[2]&&i[3]===u[3]}})(v||(v={})),x.exports=v},2783:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TurntableModifier=void 0;const d=_(3659),l=_(2111),g=_(6491);class v extends g.CameraModifier{constructor(){super(...arguments),this._rotation=l.m4(),this._maxAzimuth=.5*+Math.PI-1e-4,this._minAzimuth=.5*-Math.PI+1e-4,this._xAxisScreenSpace=l.v3(),this._sensitivity=v.DEFAULT_SENSITIVITY}initiate(o){Object.assign(this._reference,this._camera),this._initialPoint=o;const r=d.vec3.sub(l.v3(),this._reference.eye,this._reference.center);d.vec3.normalize(r,r),this._xAxisScreenSpace=d.vec3.cross(l.v3(),[0,1,0],r),this._azimuth=Math.acos(d.vec3.dot(r,[0,1,0])),this._azimuth=.5*Math.PI-this._azimuth}process(o){this._currentPoint=o;const r=d.vec2.subtract(l.v2(),this._initialPoint,this._currentPoint);d.vec2.scale(r,r,window.devicePixelRatio*this._sensitivity),this._minAzimuth&&(r[1]=Math.min(this._azimuth-this._minAzimuth,r[1])),this._maxAzimuth&&(r[1]=Math.max(this._azimuth-this._maxAzimuth,r[1])),d.mat4.rotateY(this._rotation,l.m4(),r[0]),d.mat4.rotate(this._rotation,this._rotation,r[1],this._xAxisScreenSpace),this.update()}update(){if(this._camera===void 0)return;const o=d.mat4.fromTranslation(l.m4(),this._reference.center);d.mat4.multiply(o,o,this._rotation),d.mat4.translate(o,o,d.vec3.negate(l.v3(),this._reference.center));const r=d.vec3.transformMat4(l.v3(),[0,1,0],this._rotation),n=d.vec3.transformMat4(l.v3(),this._reference.eye,o);this._camera.up=r,this._camera.eye=n}set sensitivity(o){this._sensitivity=o}get sensitivity(){return this._sensitivity}}c.TurntableModifier=v,v.DEFAULT_SENSITIVITY=.002},1732:function(x,c,_){var d=this&&this.__decorate||function(p,o,r,n){var i,u=arguments.length,s=u<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,r):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(p,o,r,n);else for(var a=p.length-1;a>=0;a--)(i=p[a])&&(s=(u<3?i(s):u>3?i(o,r,s):i(o,r))||s);return u>3&&s&&Object.defineProperty(o,r,s),s};Object.defineProperty(c,"__esModule",{value:!0}),c.UnifiedBuffer=void 0;const l=_(6404),g=_(1030);class v extends g.Initializable{constructor(o,r,n,i=0,u){super(),this._updates=new Array,this._cpuBuffer=new ArrayBuffer(r),this._gpuBuffer=new l.Buffer(o,u),this._usage=n,this._mergeThreshold=i}static updatesNeedMerge(o,r,n){return r.begin-o.end<n||n===-1}mergeUpdatesLeft(o){let r=0;const n=this._updates[o];for(let i=o-1;i>=0;i--){const u=this._updates[i];if(!v.updatesNeedMerge(u,n,this._mergeThreshold))break;n.begin=Math.min(n.begin,u.begin),n.end=Math.max(n.end,u.end),r++}return this._updates.splice(o-r,r),r+1}mergeUpdatesRight(o){let r=0;const n=this._updates[o];for(let i=o+1;i<this._updates.length;i++){const u=this._updates[i];if(!v.updatesNeedMerge(n,u,this._mergeThreshold))break;n.begin=Math.min(n.begin,u.begin),n.end=Math.max(n.end,u.end),r++}return this._updates.splice(o+1,r),r+1}addUpdate(o){const r=this._updates.findIndex(n=>o.begin<n.begin);r===-1?(this._updates.push(o),this.mergeUpdatesLeft(this._updates.length-1)):(this._updates.splice(r,0,o),this.mergeUpdatesRight(r),this.mergeUpdatesLeft(r))}initialize(o){return this._gpuBuffer.initialize(o)}uninitialize(){this._gpuBuffer.uninitialize()}bind(){this._gpuBuffer.bind()}unbind(){this._gpuBuffer.unbind()}attribEnable(o,r,n,i=!1,u=0,s=0,a=!0,h=!0){this._gpuBuffer.attribEnable(o,r,n,i,u,s,a,h)}attribDisable(o,r=!0,n=!0){this._gpuBuffer.attribDisable(o,r,n)}mergeSubDataRanges(){let o=0;for(;o<this._updates.length;)o+=this.mergeUpdatesRight(o)}subData(o,r){let n;n=r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer).subarray(r.byteOffset,r.byteOffset+r.byteLength),new Uint8Array(this._cpuBuffer).set(n,o),this.addUpdate({begin:o,end:o+n.byteLength})}update(o=!1,r=!1){if(o&&this._gpuBuffer.bind(),this._gpuBuffer.bytes!==this._cpuBuffer.byteLength)this._gpuBuffer.data(this._cpuBuffer,this._usage);else{const n=new Uint8Array(this._cpuBuffer);for(const i of this._updates){const u=n.subarray(i.begin,i.end);this._gpuBuffer.subData(i.begin,u)}}r&&this._gpuBuffer.unbind(),this._updates.length=0}get size(){return this._cpuBuffer.byteLength}set size(o){const r=this._cpuBuffer;this._cpuBuffer=new ArrayBuffer(o);const n=new Uint8Array(r).slice(0,o);new Uint8Array(this._cpuBuffer).set(n)}get target(){return this.assertInitialized(),this._gpuBuffer.target}get usage(){return this._usage}set usage(o){this._usage=o}get mergeThreshold(){return this._mergeThreshold}set mergeThreshold(o){this._mergeThreshold=o}}d([g.Initializable.initialize()],v.prototype,"initialize",null),d([g.Initializable.uninitialize()],v.prototype,"uninitialize",null),d([g.Initializable.assert_initialized()],v.prototype,"bind",null),d([g.Initializable.assert_initialized()],v.prototype,"unbind",null),d([g.Initializable.assert_initialized()],v.prototype,"attribEnable",null),d([g.Initializable.assert_initialized()],v.prototype,"attribDisable",null),d([g.Initializable.assert_initialized()],v.prototype,"update",null),c.UnifiedBuffer=v},1271:(x,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.version=c.commit=c.branch=void 0,c.branch="master",c.commit="06087080e1bd757761ae46df4e64dbcead16d6a8",c.version="v0.7.5"},5590:function(x,c,_){var d=this&&this.__decorate||function(o,r,n,i){var u,s=arguments.length,a=s<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(o,r,n,i);else for(var h=o.length-1;h>=0;h--)(u=o[h])&&(a=(s<3?u(a):s>3?u(r,n,a):u(r,n))||a);return s>3&&a&&Object.defineProperty(r,n,a),a};Object.defineProperty(c,"__esModule",{value:!0}),c.VertexArray=void 0;const l=_(9696),g=_(1030),v=_(2281);class p extends v.AbstractObject{constructor(){super(...arguments),this._buffersBound=!1}create(r,n){if(this.context.isWebGL2||this.context.supportsVertexArrayObject){const i=this.context.gl2facade;this._object=i.createVertexArray(),this._valid=this._object!==void 0,this._bind=()=>{i.bindVertexArray(this.object),this._buffersBound||(r(),this._buffersBound=!0)},this._unbind=()=>i.bindVertexArray(p.DEFAULT_VERTEX_ARRAY)}else this._bind=()=>r(),this._unbind=()=>n(),this._valid=!0;return this._object}delete(){this.context.isWebGL2||this.context.supportsVertexArrayObject?(l.assert(this._object!==void 0,"expected WebGLVertexArrayObject object"),this._context.gl2facade.deleteVertexArray(this._object),this._object=void 0,this._valid=!1,this._buffersBound=!1):this._valid=!1}bind(){this._bind()}unbind(){this._unbind()}invalidate(){this._buffersBound=!1}}p.DEFAULT_VERTEX_ARRAY=void 0,d([g.Initializable.assert_initialized()],p.prototype,"bind",null),d([g.Initializable.assert_initialized()],p.prototype,"unbind",null),c.VertexArray=p},4333:x=>{var c;(function(_){_.EventBlocker=class{constructor(d,l){if(this._blockListenerByEvent=new Map,this._element=d,l!==void 0)for(const g of l)this.block(g)}block(d){this._blockListenerByEvent.has(d)||(this._blockListenerByEvent.set(d,l=>(l.preventDefault(),l.stopPropagation(),!1)),this._element.addEventListener(d,this._blockListenerByEvent.get(d)))}unblock(d){this._blockListenerByEvent.has(d)&&(this._element.removeEventListener(d,this._blockListenerByEvent.get(d)),this._blockListenerByEvent.delete(d))}}})(c||(c={})),x.exports=c},104:(x,c,_)=>{const d=_(9696);var l;(function(g){class v{static queryAndCacheAPI(){if(v._exit!==void 0)return;const o=window.document,r=[o.exitFullScreen,o.msExitFullscreen,o.mozCancelFullScreen,o.webkitExitFullscreen,void 0];let n=0;for(;n<r.length&&r[n]===void 0;++n);switch(n){case 0:v._exit=()=>o.exitFullScreen(),v._request=i=>i.requestFullscreen(),v._element=()=>o.fullscreenElement,v._event="fullscreenchange";break;case 1:v._exit=()=>o.msExitFullscreen(),v._request=i=>i.msRequestFullscreen(),v._element=()=>o.msFullscreenElement,v._event="msfullscreenchange";break;case 2:v._exit=()=>o.mozCancelFullScreen(),v._request=i=>i.mozRequestFullScreen(),v._element=()=>o.mozFullScreenElement,v._event="mozfullscreenchange";break;case 3:v._exit=()=>o.webkitExitFullscreen(),v._request=i=>i.webkitRequestFullscreen(),v._element=()=>o.webkitFullscreenElement,v._event="webkitfullscreenchange";break;default:d.assert(!1,"none of the following fullscreen apis was found: native, ms, moz, or webkit")}}static active(){return v._element()!==void 0&&v._element()!==null}static toggle(o,r){if(o===void 0)return;v.queryAndCacheAPI();const n=v.active();if(!n){const i=getComputedStyle(o);v._size[0]=i.width,v._size[1]=i.height}r&&r(),n?(v._callback=void 0,window.removeEventListener(v._event,v.removeEventListener),o.style.width=v._size[0],o.style.height=v._size[1]):(v._callback=r,window.addEventListener(v._event,v.addEventListener)),n?v._exit():v._request(o)}}v._size=["0","0"],v.addEventListener=()=>{window.removeEventListener(v._event,v.addEventListener),window.addEventListener(v._event,v.removeEventListener)},v.removeEventListener=()=>{v._callback&&(v._callback(),v._callback=void 0),window.removeEventListener(v._event,v.removeEventListener)},g.Fullscreen=v})(l||(l={})),x.exports=l},3613:function(x,c,_){var d=this&&this.__createBinding||(Object.create?function(be,Se,we,je){je===void 0&&(je=we),Object.defineProperty(be,je,{enumerable:!0,get:function(){return Se[we]}})}:function(be,Se,we,je){je===void 0&&(je=we),be[je]=Se[we]}),l=this&&this.__setModuleDefault||(Object.create?function(be,Se){Object.defineProperty(be,"default",{enumerable:!0,value:Se})}:function(be,Se){be.default=Se}),g=this&&this.__exportStar||function(be,Se){for(var we in be)we==="default"||Object.prototype.hasOwnProperty.call(Se,we)||d(Se,be,we)},v=this&&this.__importStar||function(be){if(be&&be.__esModule)return be;var Se={};if(be!=null)for(var we in be)we!=="default"&&Object.prototype.hasOwnProperty.call(be,we)&&d(Se,be,we);return l(Se,be),Se};Object.defineProperty(c,"__esModule",{value:!0}),c.KernelF32=c.RandomSquareKernel=c.AntiAliasingKernel=c.AbstractKernel=c.NdcFillingTriangle=c.NdcFillingRectangle=c.CanvasRecorder=c.WheelZoomModifier=c.PinchZoomModifier=c.TurntableModifier=c.TrackballModifier=c.PointerLock=c.PanModifier=c.FirstPersonModifier=c.Navigation=c.CameraModifier=c.TileCameraGenerator=c.Camera=c.Wizard=c.VertexArray=c.UnifiedBuffer=c.TextureCube=c.Texture2DArray=c.Texture3D=c.Texture2D=c.Shader=c.LoadingStatus=c.Renderer=c.Renderbuffer=c.Program=c.Geometry=c.Framebuffer=c.DefaultFramebuffer=c.ColorScale=c.Color=c.Buffer=c.EventHandler=c.PointerEventProvider=c.TouchEventProvider=c.MouseEventProvider=c.ChangeLookup=c.ExtensionsHash=c.ContextMasquerade=c.Initializable=c.Controller=c.Canvas=c.Context=c.version=c.commit=c.branch=void 0,c.tuples=c.gl_matrix_extensions=c.quat=c.mat4=c.mat3=c.mat2d=c.mat2=c.vec4=c.vec3=c.vec2=c.auxiliaries=c.FrameCapture=c.EyeGazeData=c.EyeGazeEventProvider=c.EyeGazeDataStreams=c.EyeGazeDataStream=c.ShadowPass=c.GaussFilter=c.ReadbackPass=c.EnvironmentTextureType=c.EnvironmentRenderingPass=c.DebugPass=c.BlitPass=c.AccumulatePass=c.KernelUI8=c.KernelUI32=c.KernelI8=c.KernelI32=void 0;var p=_(1271);Object.defineProperty(c,"branch",{enumerable:!0,get:function(){return p.branch}}),Object.defineProperty(c,"commit",{enumerable:!0,get:function(){return p.commit}}),Object.defineProperty(c,"version",{enumerable:!0,get:function(){return p.version}});var o=_(4518);Object.defineProperty(c,"Context",{enumerable:!0,get:function(){return o.Context}});var r=_(7063);Object.defineProperty(c,"Canvas",{enumerable:!0,get:function(){return r.Canvas}});var n=_(3863);Object.defineProperty(c,"Controller",{enumerable:!0,get:function(){return n.Controller}});var i=_(1030);Object.defineProperty(c,"Initializable",{enumerable:!0,get:function(){return i.Initializable}});var u=_(1985);Object.defineProperty(c,"ContextMasquerade",{enumerable:!0,get:function(){return u.ContextMasquerade}});var s=_(9568);Object.defineProperty(c,"ExtensionsHash",{enumerable:!0,get:function(){return s.ExtensionsHash}});var a=_(4597);Object.defineProperty(c,"ChangeLookup",{enumerable:!0,get:function(){return a.ChangeLookup}});var h=_(4841);Object.defineProperty(c,"MouseEventProvider",{enumerable:!0,get:function(){return h.MouseEventProvider}});var b=_(4052);Object.defineProperty(c,"TouchEventProvider",{enumerable:!0,get:function(){return b.TouchEventProvider}});var m=_(8319);Object.defineProperty(c,"PointerEventProvider",{enumerable:!0,get:function(){return m.PointerEventProvider}});var M=_(7595);Object.defineProperty(c,"EventHandler",{enumerable:!0,get:function(){return M.EventHandler}});var S=_(6404);Object.defineProperty(c,"Buffer",{enumerable:!0,get:function(){return S.Buffer}});var w=_(7677);Object.defineProperty(c,"Color",{enumerable:!0,get:function(){return w.Color}});var N=_(5252);Object.defineProperty(c,"ColorScale",{enumerable:!0,get:function(){return N.ColorScale}});var F=_(6786);Object.defineProperty(c,"DefaultFramebuffer",{enumerable:!0,get:function(){return F.DefaultFramebuffer}});var k=_(9564);Object.defineProperty(c,"Framebuffer",{enumerable:!0,get:function(){return k.Framebuffer}});var X=_(4894);Object.defineProperty(c,"Geometry",{enumerable:!0,get:function(){return X.Geometry}});var $=_(4895);Object.defineProperty(c,"Program",{enumerable:!0,get:function(){return $.Program}});var V=_(7540);Object.defineProperty(c,"Renderbuffer",{enumerable:!0,get:function(){return V.Renderbuffer}});var Y=_(3205);Object.defineProperty(c,"Renderer",{enumerable:!0,get:function(){return Y.Renderer}}),Object.defineProperty(c,"LoadingStatus",{enumerable:!0,get:function(){return Y.LoadingStatus}});var Z=_(5263);Object.defineProperty(c,"Shader",{enumerable:!0,get:function(){return Z.Shader}});var J=_(6942);Object.defineProperty(c,"Texture2D",{enumerable:!0,get:function(){return J.Texture2D}});var ee=_(7344);Object.defineProperty(c,"Texture3D",{enumerable:!0,get:function(){return ee.Texture3D}});var K=_(4850);Object.defineProperty(c,"Texture2DArray",{enumerable:!0,get:function(){return K.Texture2DArray}});var re=_(945);Object.defineProperty(c,"TextureCube",{enumerable:!0,get:function(){return re.TextureCube}});var ue=_(1732);Object.defineProperty(c,"UnifiedBuffer",{enumerable:!0,get:function(){return ue.UnifiedBuffer}});var ie=_(5590);Object.defineProperty(c,"VertexArray",{enumerable:!0,get:function(){return ie.VertexArray}});var de=_(1284);Object.defineProperty(c,"Wizard",{enumerable:!0,get:function(){return de.Wizard}});var Te=_(4082);Object.defineProperty(c,"Camera",{enumerable:!0,get:function(){return Te.Camera}});var pe=_(339);Object.defineProperty(c,"TileCameraGenerator",{enumerable:!0,get:function(){return pe.TileCameraGenerator}});var Oe=_(6491);Object.defineProperty(c,"CameraModifier",{enumerable:!0,get:function(){return Oe.CameraModifier}});var Q=_(8652);Object.defineProperty(c,"Navigation",{enumerable:!0,get:function(){return Q.Navigation}});var Re=_(9870);Object.defineProperty(c,"FirstPersonModifier",{enumerable:!0,get:function(){return Re.FirstPersonModifier}});var Ae=_(8287);Object.defineProperty(c,"PanModifier",{enumerable:!0,get:function(){return Ae.PanModifier}});var He=_(9258);Object.defineProperty(c,"PointerLock",{enumerable:!0,get:function(){return He.PointerLock}});var Ie=_(2763);Object.defineProperty(c,"TrackballModifier",{enumerable:!0,get:function(){return Ie.TrackballModifier}});var Le=_(2783);Object.defineProperty(c,"TurntableModifier",{enumerable:!0,get:function(){return Le.TurntableModifier}});var Pe=_(8357);Object.defineProperty(c,"PinchZoomModifier",{enumerable:!0,get:function(){return Pe.PinchZoomModifier}});var De=_(9817);Object.defineProperty(c,"WheelZoomModifier",{enumerable:!0,get:function(){return De.WheelZoomModifier}});var rt=_(6233);Object.defineProperty(c,"CanvasRecorder",{enumerable:!0,get:function(){return rt.CanvasRecorder}});var Ge=_(7429);Object.defineProperty(c,"NdcFillingRectangle",{enumerable:!0,get:function(){return Ge.NdcFillingRectangle}});var $e=_(7570);Object.defineProperty(c,"NdcFillingTriangle",{enumerable:!0,get:function(){return $e.NdcFillingTriangle}});var qe=_(4563);Object.defineProperty(c,"AbstractKernel",{enumerable:!0,get:function(){return qe.AbstractKernel}});var ke=_(3411);Object.defineProperty(c,"AntiAliasingKernel",{enumerable:!0,get:function(){return ke.AntiAliasingKernel}});var it=_(5785);Object.defineProperty(c,"RandomSquareKernel",{enumerable:!0,get:function(){return it.RandomSquareKernel}});var Ye=_(4563);Object.defineProperty(c,"KernelF32",{enumerable:!0,get:function(){return Ye.KernelF32}}),Object.defineProperty(c,"KernelI32",{enumerable:!0,get:function(){return Ye.KernelI32}}),Object.defineProperty(c,"KernelI8",{enumerable:!0,get:function(){return Ye.KernelI8}}),Object.defineProperty(c,"KernelUI32",{enumerable:!0,get:function(){return Ye.KernelUI32}}),Object.defineProperty(c,"KernelUI8",{enumerable:!0,get:function(){return Ye.KernelUI8}});var mt=_(3666);Object.defineProperty(c,"AccumulatePass",{enumerable:!0,get:function(){return mt.AccumulatePass}});var Lt=_(4073);Object.defineProperty(c,"BlitPass",{enumerable:!0,get:function(){return Lt.BlitPass}});var Pt=_(26);Object.defineProperty(c,"DebugPass",{enumerable:!0,get:function(){return Pt.DebugPass}});var vt=_(172);Object.defineProperty(c,"EnvironmentRenderingPass",{enumerable:!0,get:function(){return vt.EnvironmentRenderingPass}}),Object.defineProperty(c,"EnvironmentTextureType",{enumerable:!0,get:function(){return vt.EnvironmentTextureType}});var Ot=_(9314);Object.defineProperty(c,"ReadbackPass",{enumerable:!0,get:function(){return Ot.ReadbackPass}});var It=_(5714);Object.defineProperty(c,"GaussFilter",{enumerable:!0,get:function(){return It.GaussFilter}});var Ft=_(6210);Object.defineProperty(c,"ShadowPass",{enumerable:!0,get:function(){return Ft.ShadowPass}});var gt=_(378);Object.defineProperty(c,"EyeGazeDataStream",{enumerable:!0,get:function(){return gt.EyeGazeDataStream}}),Object.defineProperty(c,"EyeGazeDataStreams",{enumerable:!0,get:function(){return gt.EyeGazeDataStreams}});var zt=_(5838);Object.defineProperty(c,"EyeGazeEventProvider",{enumerable:!0,get:function(){return zt.EyeGazeEventProvider}});var Nt=_(2497);Object.defineProperty(c,"EyeGazeData",{enumerable:!0,get:function(){return Nt.EyeGazeData}});var bt=_(9544);Object.defineProperty(c,"FrameCapture",{enumerable:!0,get:function(){return bt.FrameCapture}}),g(_(2194),c),g(_(9922),c),g(_(2709),c);const Ct=v(_(9696));c.auxiliaries=Ct;var nt=_(3659);Object.defineProperty(c,"vec2",{enumerable:!0,get:function(){return nt.vec2}}),Object.defineProperty(c,"vec3",{enumerable:!0,get:function(){return nt.vec3}}),Object.defineProperty(c,"vec4",{enumerable:!0,get:function(){return nt.vec4}});var Ze=_(3659);Object.defineProperty(c,"mat2",{enumerable:!0,get:function(){return Ze.mat2}}),Object.defineProperty(c,"mat2d",{enumerable:!0,get:function(){return Ze.mat2d}}),Object.defineProperty(c,"mat3",{enumerable:!0,get:function(){return Ze.mat3}}),Object.defineProperty(c,"mat4",{enumerable:!0,get:function(){return Ze.mat4}});var Bt=_(3659);Object.defineProperty(c,"quat",{enumerable:!0,get:function(){return Bt.quat}});const Dt=v(_(2111));c.gl_matrix_extensions=Dt;const Gt=v(_(4934));c.tuples=Gt},9515:function(x,c,_){var d=this&&this.__createBinding||(Object.create?function(s,a,h,b){b===void 0&&(b=h),Object.defineProperty(s,b,{enumerable:!0,get:function(){return a[h]}})}:function(s,a,h,b){b===void 0&&(b=h),s[b]=a[h]}),l=this&&this.__setModuleDefault||(Object.create?function(s,a){Object.defineProperty(s,"default",{enumerable:!0,value:a})}:function(s,a){s.default=a}),g=this&&this.__exportStar||function(s,a){for(var h in s)h==="default"||Object.prototype.hasOwnProperty.call(a,h)||d(a,s,h)},v=this&&this.__importStar||function(s){if(s&&s.__esModule)return s;var a={};if(s!=null)for(var h in s)h!=="default"&&Object.prototype.hasOwnProperty.call(s,h)&&d(a,s,h);return l(a,s),a};Object.defineProperty(c,"__esModule",{value:!0}),c.viewer=c.ray_math=c.fetch=c.properties=void 0,g(_(3613),c),g(_(3733),c);const p=v(_(3607));c.properties=p;const o=v(_(6869));c.fetch=o;const r=v(_(3942));c.ray_math=r,g(_(7491),c);const n=v(_(4333)),i=v(_(104));var u;(u=c.viewer||(c.viewer={})).EventBlocker=n.EventBlocker,u.Fullscreen=i.Fullscreen},9817:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WheelZoomModifier=void 0;const d=_(3659),l=_(2111),g=_(6491);class v extends g.CameraModifier{constructor(){super(...arguments),this._sensitivity=v.DEFAULT_SENSITIVITY,this._translation=l.v3()}process(o){Object.assign(this._reference,this._camera);const r=o*this._sensitivity,n=d.vec3.sub(l.v3(),this._reference.center,this._reference.eye);d.vec3.normalize(n,n),this._translation=d.vec3.scale(l.v3(),n,r),this.update()}update(){if(this._camera===void 0)return;const o=d.mat4.fromTranslation(l.m4(),this._translation),r=d.vec3.transformMat4(l.v3(),this._reference.eye,o);this._camera.eye=r}}c.WheelZoomModifier=v,v.DEFAULT_SENSITIVITY=.2},1284:(x,c,_)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Wizard=void 0;const d=_(9696);class l{static queryPrecisionSupport(v,p){const o=v.gl,r=v.gl2facade,n=v.isWebGL1&&v.supportsTextureFloat||v.isWebGL2&&v.supportsColorBufferFloat,i=v.isWebGL1&&v.supportsTextureHalfFloat||v.isWebGL2&&v.supportsColorBufferFloat;let u=p;return p in l.Precision||(d.log(d.LogLevel.Warning,`unknown precision '${u}' changed to '${l.Precision.auto}'`),p=l.Precision.auto),p===l.Precision.auto&&(u=n?l.Precision.float:i?l.Precision.half:l.Precision.byte),u===l.Precision.half&&i?(v.isWebGL2?v.colorBufferFloat:v.textureHalfFloat,[u,r.HALF_FLOAT,1]):u!==l.Precision.float&&u!==l.Precision.half||!n?[u,o.UNSIGNED_BYTE,2]:(v.isWebGL2?v.colorBufferFloat:v.textureFloat,[u,o.FLOAT,0])}static queryInternalTextureFormat(v,p,o=l.Precision.auto){const[r,n,i]=this.queryPrecisionSupport(v,o),u=v.gl;if(v.isWebGL1)return d.assert([u.RGB,u.RGBA].includes(p),"target must be gl.RGB or gl.RGBA in WebGL 1"),[p,n,r];switch(p){case u.RGBA:return[[u.RGBA32F,u.RGBA16F,u.RGBA8][i],n,r];case u.RGB:return[[u.RGB32F,u.RGB16F,u.RGB8][i],n,r];case u.RG:return[[u.RG32F,u.RG16F,u.RG8][i],n,r];case u.RED:return[[u.R32F,u.R16F,u.R8][i],n,r];default:d.assert(!1,"internal format querying is not yet supported for formats other than RGBA, RGB")}return[u.NONE,u.NONE,r]}}c.Wizard=l,function(g){(function(v){v.float="float",v.half="half",v.byte="byte",v.auto="auto"})(g.Precision||(g.Precision={}))}(l=c.Wizard||(c.Wizard={}))},4760:(x,c,_)=>{var d=_(8770),l=_(569);function g(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}c.parse=S,c.resolve=function(w,N){return S(w,!1,!0).resolve(N)},c.resolveObject=function(w,N){return w?S(w,!1,!0).resolveObject(N):N},c.format=function(w){return l.isString(w)&&(w=S(w)),w instanceof g?w.format():g.prototype.format.call(w)},c.Url=g;var v=/^([a-z0-9.+-]+:)/i,p=/:[0-9]*$/,o=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,r=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),n=["'"].concat(r),i=["%","/","?",";","#"].concat(n),u=["/","?","#"],s=/^[+a-z0-9A-Z_-]{0,63}$/,a=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,h={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},M=_(8966);function S(w,N,F){if(w&&l.isObject(w)&&w instanceof g)return w;var k=new g;return k.parse(w,N,F),k}g.prototype.parse=function(w,N,F){if(!l.isString(w))throw new TypeError("Parameter 'url' must be a string, not "+typeof w);var k=w.indexOf("?"),X=k!==-1&&k<w.indexOf("#")?"?":"#",$=w.split(X);$[0]=$[0].replace(/\\/g,"/");var V=w=$.join(X);if(V=V.trim(),!F&&w.split("#").length===1){var Y=o.exec(V);if(Y)return this.path=V,this.href=V,this.pathname=Y[1],Y[2]?(this.search=Y[2],this.query=N?M.parse(this.search.substr(1)):this.search.substr(1)):N&&(this.search="",this.query={}),this}var Z=v.exec(V);if(Z){var J=(Z=Z[0]).toLowerCase();this.protocol=J,V=V.substr(Z.length)}if(F||Z||V.match(/^\/\/[^@\/]+@[^@\/]+/)){var ee=V.substr(0,2)==="//";!ee||Z&&b[Z]||(V=V.substr(2),this.slashes=!0)}if(!b[Z]&&(ee||Z&&!m[Z])){for(var K,re,ue=-1,ie=0;ie<u.length;ie++)(de=V.indexOf(u[ie]))!==-1&&(ue===-1||de<ue)&&(ue=de);for((re=ue===-1?V.lastIndexOf("@"):V.lastIndexOf("@",ue))!==-1&&(K=V.slice(0,re),V=V.slice(re+1),this.auth=decodeURIComponent(K)),ue=-1,ie=0;ie<i.length;ie++){var de;(de=V.indexOf(i[ie]))!==-1&&(ue===-1||de<ue)&&(ue=de)}ue===-1&&(ue=V.length),this.host=V.slice(0,ue),V=V.slice(ue),this.parseHost(),this.hostname=this.hostname||"";var Te=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!Te)for(var pe=this.hostname.split(/\./),Oe=(ie=0,pe.length);ie<Oe;ie++){var Q=pe[ie];if(Q&&!Q.match(s)){for(var Re="",Ae=0,He=Q.length;Ae<He;Ae++)Q.charCodeAt(Ae)>127?Re+="x":Re+=Q[Ae];if(!Re.match(s)){var Ie=pe.slice(0,ie),Le=pe.slice(ie+1),Pe=Q.match(a);Pe&&(Ie.push(Pe[1]),Le.unshift(Pe[2])),Le.length&&(V="/"+Le.join(".")+V),this.hostname=Ie.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),Te||(this.hostname=d.toASCII(this.hostname));var De=this.port?":"+this.port:"",rt=this.hostname||"";this.host=rt+De,this.href+=this.host,Te&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),V[0]!=="/"&&(V="/"+V))}if(!h[J])for(ie=0,Oe=n.length;ie<Oe;ie++){var Ge=n[ie];if(V.indexOf(Ge)!==-1){var $e=encodeURIComponent(Ge);$e===Ge&&($e=escape(Ge)),V=V.split(Ge).join($e)}}var qe=V.indexOf("#");qe!==-1&&(this.hash=V.substr(qe),V=V.slice(0,qe));var ke=V.indexOf("?");if(ke!==-1?(this.search=V.substr(ke),this.query=V.substr(ke+1),N&&(this.query=M.parse(this.query)),V=V.slice(0,ke)):N&&(this.search="",this.query={}),V&&(this.pathname=V),m[J]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){De=this.pathname||"";var it=this.search||"";this.path=De+it}return this.href=this.format(),this},g.prototype.format=function(){var w=this.auth||"";w&&(w=(w=encodeURIComponent(w)).replace(/%3A/i,":"),w+="@");var N=this.protocol||"",F=this.pathname||"",k=this.hash||"",X=!1,$="";this.host?X=w+this.host:this.hostname&&(X=w+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(X+=":"+this.port)),this.query&&l.isObject(this.query)&&Object.keys(this.query).length&&($=M.stringify(this.query));var V=this.search||$&&"?"+$||"";return N&&N.substr(-1)!==":"&&(N+=":"),this.slashes||(!N||m[N])&&X!==!1?(X="//"+(X||""),F&&F.charAt(0)!=="/"&&(F="/"+F)):X||(X=""),k&&k.charAt(0)!=="#"&&(k="#"+k),V&&V.charAt(0)!=="?"&&(V="?"+V),N+X+(F=F.replace(/[?#]/g,function(Y){return encodeURIComponent(Y)}))+(V=V.replace("#","%23"))+k},g.prototype.resolve=function(w){return this.resolveObject(S(w,!1,!0)).format()},g.prototype.resolveObject=function(w){if(l.isString(w)){var N=new g;N.parse(w,!1,!0),w=N}for(var F=new g,k=Object.keys(this),X=0;X<k.length;X++){var $=k[X];F[$]=this[$]}if(F.hash=w.hash,w.href==="")return F.href=F.format(),F;if(w.slashes&&!w.protocol){for(var V=Object.keys(w),Y=0;Y<V.length;Y++){var Z=V[Y];Z!=="protocol"&&(F[Z]=w[Z])}return m[F.protocol]&&F.hostname&&!F.pathname&&(F.path=F.pathname="/"),F.href=F.format(),F}if(w.protocol&&w.protocol!==F.protocol){if(!m[w.protocol]){for(var J=Object.keys(w),ee=0;ee<J.length;ee++){var K=J[ee];F[K]=w[K]}return F.href=F.format(),F}if(F.protocol=w.protocol,w.host||b[w.protocol])F.pathname=w.pathname;else{for(var re=(w.pathname||"").split("/");re.length&&!(w.host=re.shift()););w.host||(w.host=""),w.hostname||(w.hostname=""),re[0]!==""&&re.unshift(""),re.length<2&&re.unshift(""),F.pathname=re.join("/")}if(F.search=w.search,F.query=w.query,F.host=w.host||"",F.auth=w.auth,F.hostname=w.hostname||w.host,F.port=w.port,F.pathname||F.search){var ue=F.pathname||"",ie=F.search||"";F.path=ue+ie}return F.slashes=F.slashes||w.slashes,F.href=F.format(),F}var de=F.pathname&&F.pathname.charAt(0)==="/",Te=w.host||w.pathname&&w.pathname.charAt(0)==="/",pe=Te||de||F.host&&w.pathname,Oe=pe,Q=F.pathname&&F.pathname.split("/")||[],Re=(re=w.pathname&&w.pathname.split("/")||[],F.protocol&&!m[F.protocol]);if(Re&&(F.hostname="",F.port=null,F.host&&(Q[0]===""?Q[0]=F.host:Q.unshift(F.host)),F.host="",w.protocol&&(w.hostname=null,w.port=null,w.host&&(re[0]===""?re[0]=w.host:re.unshift(w.host)),w.host=null),pe=pe&&(re[0]===""||Q[0]==="")),Te)F.host=w.host||w.host===""?w.host:F.host,F.hostname=w.hostname||w.hostname===""?w.hostname:F.hostname,F.search=w.search,F.query=w.query,Q=re;else if(re.length)Q||(Q=[]),Q.pop(),Q=Q.concat(re),F.search=w.search,F.query=w.query;else if(!l.isNullOrUndefined(w.search))return Re&&(F.hostname=F.host=Q.shift(),(Pe=!!(F.host&&F.host.indexOf("@")>0)&&F.host.split("@"))&&(F.auth=Pe.shift(),F.host=F.hostname=Pe.shift())),F.search=w.search,F.query=w.query,l.isNull(F.pathname)&&l.isNull(F.search)||(F.path=(F.pathname?F.pathname:"")+(F.search?F.search:"")),F.href=F.format(),F;if(!Q.length)return F.pathname=null,F.search?F.path="/"+F.search:F.path=null,F.href=F.format(),F;for(var Ae=Q.slice(-1)[0],He=(F.host||w.host||Q.length>1)&&(Ae==="."||Ae==="..")||Ae==="",Ie=0,Le=Q.length;Le>=0;Le--)(Ae=Q[Le])==="."?Q.splice(Le,1):Ae===".."?(Q.splice(Le,1),Ie++):Ie&&(Q.splice(Le,1),Ie--);if(!pe&&!Oe)for(;Ie--;Ie)Q.unshift("..");!pe||Q[0]===""||Q[0]&&Q[0].charAt(0)==="/"||Q.unshift(""),He&&Q.join("/").substr(-1)!=="/"&&Q.push("");var Pe,De=Q[0]===""||Q[0]&&Q[0].charAt(0)==="/";return Re&&(F.hostname=F.host=De?"":Q.length?Q.shift():"",(Pe=!!(F.host&&F.host.indexOf("@")>0)&&F.host.split("@"))&&(F.auth=Pe.shift(),F.host=F.hostname=Pe.shift())),(pe=pe||F.host&&Q.length)&&!De&&Q.unshift(""),Q.length?F.pathname=Q.join("/"):(F.pathname=null,F.path=null),l.isNull(F.pathname)&&l.isNull(F.search)||(F.path=(F.pathname?F.pathname:"")+(F.search?F.search:"")),F.auth=w.auth||F.auth,F.slashes=F.slashes||w.slashes,F.href=F.format(),F},g.prototype.parseHost=function(){var w=this.host,N=p.exec(w);N&&((N=N[0])!==":"&&(this.port=N.substr(1)),w=w.substr(0,w.length-N.length)),w&&(this.hostname=w)}},569:x=>{x.exports={isString:function(c){return typeof c=="string"},isObject:function(c){return typeof c=="object"&&c!==null},isNull:function(c){return c===null},isNullOrUndefined:function(c){return c==null}}},9587:x=>{x.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
    #extension GL_OES_standard_derivatives : enable\r
#else \r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
uniform int u_frameNumber;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec3 color = vec3(28.0 / 255.0, 117.0 / 255.0, 188.0 / 255.0);\r
    color += (vec3(0.0, v_uv) - 0.5) * 0.125;\r
\r
    vec2 awidth = fwidth(v_uv) * (sin(float(u_frameNumber) * 0.1) * 7.0 + 8.0);\r
    vec2 cstep = abs(step(awidth, v_uv) - step(awidth, 1.0 - v_uv));\r
    if(!any(bvec2(cstep))) {\r
        discard;\r
    }\r
    fragColor = vec4(color, 1.0); \r
}\r
`},354:x=>{x.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
void ndcOffset(inout vec4 vertex, in vec2 offset) {\r
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else \r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
uniform vec2 u_ndcOffset;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex.xy * 0.5 + 0.5;\r
\r
    vec4 vertex = vec4(a_vertex, 0.0, 1.0);\r
    ndcOffset(vertex, u_ndcOffset);\r
\r
    gl_Position = vertex;\r
}\r
`},6277:x=>{x.exports=`precision highp float;\r
\r
// Adapted from https://github.com/KhronosGroup/glTF-WebGL-PBR\r
// References:\r
// [1] Real Shading in Unreal Engine 4\r
//     http://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\r
// [2] Physically Based Shading at Disney\r
//     http://blog.selfshadow.com/publications/s2012-shading-course/burley/s2012_pbs_disney_brdf_notes_v3.pdf\r
// [3] README.md - Environment Maps\r
//     https://github.com/KhronosGroup/glTF-WebGL-PBR/#environment-maps\r
// [4] "An Inexpensive BRDF Model for Physically based Rendering" by Christophe Schlick\r
//     https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
const int HAS_NORMALS           = 1;\r
const int HAS_TANGENTS          = 1 << 1;\r
const int HAS_UV                = 1 << 2;\r
const int HAS_COLORS            = 1 << 3;\r
const int USE_IBL               = 1 << 4;\r
const int HAS_BASECOLORMAP      = 1 << 5;\r
const int HAS_NORMALMAP         = 1 << 6;\r
const int HAS_EMISSIVEMAP       = 1 << 7;\r
const int HAS_METALROUGHNESSMAP = 1 << 8;\r
const int HAS_OCCLUSIONMAP      = 1 << 9;\r
const int USE_TEX_LOD           = 1 << 10;\r
\r
const vec3 u_LightDirection = vec3(0.2, 1.0, 0.2);\r
const vec3 u_LightColor = vec3(1, 1, 1);\r
\r
const float M_PI = 3.141592653589793;\r
const float c_MinRoughness = 0.04;\r
\r
uniform sampler2D u_baseColor;\r
uniform sampler2D u_metallicRoughness;\r
uniform sampler2D u_normal;\r
uniform sampler2D u_emissive;\r
uniform sampler2D u_occlusion;\r
\r
uniform samplerCube u_specularEnvironment;\r
uniform sampler2D u_brdfLUT;\r
\r
uniform int u_baseColorTexCoord;\r
uniform int u_normalTexCoord;\r
uniform int u_metallicRoughnessTexCoord;\r
uniform int u_occlusionTexCoord;\r
uniform int u_emissiveTexCoord;\r
\r
uniform vec4 u_baseColorFactor;\r
uniform float u_metallicFactor;\r
uniform float u_roughnessFactor;\r
uniform vec3 u_emissiveFactor;\r
uniform float u_normalScale;\r
uniform int u_blendMode;\r
uniform float u_blendCutoff;\r
\r
uniform mediump int u_geometryFlags;\r
uniform mediump int u_pbrFlags;\r
uniform vec3 u_eye;\r
\r
varying vec2 v_uv[3];\r
varying vec4 v_color;\r
varying vec3 v_position;\r
\r
varying mat3 v_TBN;\r
varying vec3 v_normal;\r
\r
// Encapsulate the various inputs used by the various functions in the shading equation\r
// We store values in this struct to simplify the integration of alternative implementations\r
// of the shading terms, outlined in the Readme.MD Appendix.\r
struct PBRInfo\r
{\r
    float NdotL;                  // cos angle between normal and light direction\r
    float NdotV;                  // cos angle between normal and view direction\r
    float NdotH;                  // cos angle between normal and half vector\r
    float LdotH;                  // cos angle between light direction and half vector\r
    float VdotH;                  // cos angle between view direction and half vector\r
    float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\r
    float metalness;              // metallic value at the surface\r
    vec3 reflectance0;            // full reflectance color (normal incidence angle)\r
    vec3 reflectance90;           // reflectance color at grazing angle\r
    float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\r
    vec3 diffuseColor;            // color contribution from diffuse lighting\r
    vec3 specularColor;           // color contribution from specular lighting\r
};\r
\r
bool checkGeometryFlag(int flag) {\r
    return (u_geometryFlags & flag) == flag;\r
}\r
\r
bool checkFlag(int flag) {\r
    return (u_pbrFlags & flag) == flag;\r
}\r
\r
vec4 SRGBtoLINEAR(vec4 srgbIn)\r
{\r
    #ifdef MANUAL_SRGB\r
    #ifdef SRGB_FAST_APPROXIMATION\r
    vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\r
    #else //SRGB_FAST_APPROXIMATION\r
    vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\r
    vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\r
    #endif //SRGB_FAST_APPROXIMATION\r
    return vec4(linOut,srgbIn.w);;\r
    #else //MANUAL_SRGB\r
    return srgbIn;\r
    #endif //MANUAL_SRGB\r
}\r
\r
// Find the normal for this fragment, pulling either from a predefined normal map\r
// or from the interpolated mesh normal and tangent attributes.\r
vec3 getNormal()\r
{\r
    // Retrieve the tangent space matrix\r
    mat3 tbn;\r
    if (!checkGeometryFlag(HAS_TANGENTS)) {\r
        vec3 pos_dx = dFdx(v_position);\r
        vec3 pos_dy = dFdy(v_position);\r
        vec3 tex_dx = dFdx(vec3(v_uv[0], 0.0));\r
        vec3 tex_dy = dFdy(vec3(v_uv[0], 0.0));\r
        vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\r
\r
        vec3 ng;\r
        if (checkGeometryFlag(HAS_NORMALS))\r
            ng = normalize(v_normal);\r
        else\r
            ng = cross(pos_dx, pos_dy);\r
\r
            t = normalize(t - ng * dot(ng, t));\r
            vec3 b = normalize(cross(ng, t));\r
            tbn = mat3(t, b, ng);\r
        }\r
    else { // HAS_TANGENTS\r
        tbn = v_TBN;\r
    }\r
\r
    vec3 n;\r
    if (checkFlag(HAS_NORMALMAP)) {\r
        n = texture(u_normal, v_uv[u_normalTexCoord]).rgb;\r
        n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_normalScale, u_normalScale, 1.0)));\r
    } else {\r
        // The tbn matrix is linearly interpolated, so we need to re-normalize\r
        n = normalize(tbn[2].xyz);\r
    }\r
\r
    // reverse backface normals\r
    n *= (2.0 * float(gl_FrontFacing) - 1.0);\r
\r
    return n;\r
}\r
\r
// Basic Lambertian diffuse\r
// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\r
// See also [1], Equation 1\r
vec3 diffuse(PBRInfo pbrInputs)\r
{\r
    return pbrInputs.diffuseColor / M_PI;\r
}\r
\r
 // The following equation models the Fresnel reflectance term of the spec equation (aka F())\r
// Implementation of fresnel from [4], Equation 15\r
vec3 specularReflection(PBRInfo pbrInputs)\r
{\r
    return pbrInputs.reflectance0 + (pbrInputs.reflectance90 - pbrInputs.reflectance0) * pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\r
}\r
\r
 // This calculates the specular geometric attenuation (aka G()),\r
// where rougher material will reflect less light back to the viewer.\r
// This implementation is based on [1] Equation 4, and we adopt their modifications to\r
// alphaRoughness as input as originally proposed in [2].\r
float geometricOcclusion(PBRInfo pbrInputs)\r
{\r
    float NdotL = pbrInputs.NdotL;\r
    float NdotV = pbrInputs.NdotV;\r
    float r = pbrInputs.alphaRoughness;\r
\r
    float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\r
    float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\r
    return attenuationL * attenuationV;\r
}\r
\r
 // The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\r
// Implementation from "Average Irregularity Representation of a Roughened Surface for Ray Reflection" by T. S. Trowbridge, and K. P. Reitz\r
// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\r
float microfacetDistribution(PBRInfo pbrInputs)\r
{\r
    float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\r
    float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\r
    return roughnessSq / (M_PI * f * f);\r
}\r
\r
vec3 getIBLContribution(vec3 n, vec3 v, PBRInfo pbrInfo)\r
{\r
    float NdotV = clamp(dot(n, v), 0.0, 1.0);\r
\r
    // TODO: pass uniform for mip count\r
    const float MIP_COUNT = 8.0;\r
    float lod = clamp(pbrInfo.perceptualRoughness * MIP_COUNT, 0.0, MIP_COUNT);\r
    vec3 reflection = normalize(reflect(-v, n));\r
\r
    vec2 brdfSamplePoint = vec2(NdotV, pbrInfo.perceptualRoughness);\r
    vec2 brdf = texture(u_brdfLUT, brdfSamplePoint).rg;\r
\r
    // vec4 diffuseSample = textureCube(u_DiffuseEnvSampler, n);\r
    vec4 specularSample = textureLod(u_specularEnvironment, reflection, lod);\r
\r
    // vec3 diffuseLight = SRGBtoLINEAR(diffuseSample).rgb;\r
    vec3 specularLight = SRGBtoLINEAR(specularSample).rgb;\r
\r
    // vec3 diffuse = diffuseLight * pbrInfo.diffuseColor;\r
    vec3 specular = specularLight * (pbrInfo.specularColor * brdf.x + brdf.y);\r
\r
    return specular;\r
    // return diffuse + specular;\r
}\r
\r
void main(void)\r
{\r
    float perceptualRoughness = u_roughnessFactor;\r
    float metallic = u_metallicFactor;\r
    if (checkFlag(HAS_METALROUGHNESSMAP)) {\r
        // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\r
        // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\r
        vec4 mrSample = texture(u_metallicRoughness, v_uv[u_metallicRoughnessTexCoord]);\r
        perceptualRoughness = mrSample.g * perceptualRoughness;\r
        metallic = mrSample.b * metallic;\r
    }\r
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\r
    metallic = clamp(metallic, 0.0, 1.0);\r
    // Roughness is authored as perceptual roughness; as is convention,\r
    // convert to material roughness by squaring the perceptual roughness [2].\r
    float alphaRoughness = perceptualRoughness * perceptualRoughness;\r
\r
     // The albedo may be defined from a base texture or a flat color\r
    vec4 baseColor;\r
    if (checkFlag(HAS_BASECOLORMAP)) {\r
        baseColor = SRGBtoLINEAR(texture(u_baseColor, v_uv[u_baseColorTexCoord])) * u_baseColorFactor;\r
    } else {\r
        baseColor = u_baseColorFactor;\r
    }\r
\r
    // spec: COLOR_0 ... acts as an additional linear multiplier to baseColor\r
    // TODO!: distinguish vec3/vec4 colors...\r
    baseColor *= vec4(v_color.rgb, 1.0);\r
\r
    vec3 f0 = vec3(0.04);\r
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\r
    diffuseColor *= 1.0 - metallic;\r
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\r
\r
    // Compute reflectance.\r
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\r
\r
    // For typical incident reflectance range (between 4% to 100%) set the grazing reflectance to 100% for typical fresnel effect.\r
    // For very low reflectance range on highly diffuse objects (below 4%), incrementally reduce grazing reflecance to 0%.\r
    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\r
    vec3 specularEnvironmentR0 = specularColor.rgb;\r
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\r
\r
    vec3 n = getNormal();                         // normal at surface point\r
    vec3 v = normalize(u_eye - v_position);        // Vector from surface point to camera\r
    vec3 l = normalize(u_LightDirection);          // Vector from surface point to light\r
    vec3 h = normalize(l+v);                       // Half vector between both l and v\r
    vec3 reflection = -normalize(reflect(v, n));\r
\r
    float NdotL = clamp(dot(n, l), 0.001, 1.0);\r
    float NdotV = abs(dot(n, v)) + 0.001;\r
    float NdotH = clamp(dot(n, h), 0.0, 1.0);\r
    float LdotH = clamp(dot(l, h), 0.0, 1.0);\r
    float VdotH = clamp(dot(v, h), 0.0, 1.0);\r
\r
    PBRInfo pbrInputs = PBRInfo(\r
        NdotL,\r
        NdotV,\r
        NdotH,\r
        LdotH,\r
        VdotH,\r
        perceptualRoughness,\r
        metallic,\r
        specularEnvironmentR0,\r
        specularEnvironmentR90,\r
        alphaRoughness,\r
        diffuseColor,\r
        specularColor\r
    );\r
\r
     // Calculate the shading terms for the microfacet specular shading model\r
    vec3 F = specularReflection(pbrInputs);\r
    float G = geometricOcclusion(pbrInputs);\r
    float D = microfacetDistribution(pbrInputs);\r
\r
     // Calculation of analytical lighting contribution\r
    vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\r
    vec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\r
    // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\r
    vec3 color = NdotL * u_LightColor * (diffuseContrib + specContrib);\r
\r
    vec3 environmentLight = getIBLContribution(n, v, pbrInputs);\r
    color += environmentLight;\r
\r
    if (checkFlag(HAS_EMISSIVEMAP)) {\r
        vec3 emissive = SRGBtoLINEAR(texture(u_emissive, v_uv[u_emissiveTexCoord])).rgb * u_emissiveFactor;\r
        color += emissive;\r
    }\r
\r
    // NOTE: the spec mandates to ignore any alpha value in 'OPAQUE' mode\r
    float alpha = 1.0;\r
    if (u_blendMode == 1) {\r
        if (baseColor.a < u_blendCutoff) {\r
            discard;\r
        }\r
    }\r
    else if (u_blendMode == 2) {\r
        alpha = baseColor.a;\r
    }\r
\r
    fragColor = vec4(pow(color, vec3(1.0/2.2)), alpha);\r
}\r
`},6263:x=>{x.exports=`precision highp float;\r
\r
// Adapted from https://github.com/KhronosGroup/glTF-WebGL-PBR\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
const int HAS_NORMALS           = 1;\r
const int HAS_TANGENTS          = 1 << 1;\r
const int HAS_UV                = 1 << 2;\r
const int HAS_COLORS            = 1 << 3;\r
\r
#if __VERSION__ == 100\r
    attribute vec4 a_position;\r
    attribute vec4 a_normal;\r
    attribute vec4 a_tangent;\r
    attribute vec2 a_texcoord_0;\r
    attribute vec2 a_texcoord_1;\r
    attribute vec2 a_texcoord_2;\r
    attribute vec4 a_joints;\r
    attribute vec4 a_weights;\r
    attribute vec4 a_color;\r
#else\r
    layout (location = 0) in vec4 a_position;\r
    layout (location = 1) in vec3 a_normal;\r
    layout (location = 2) in vec4 a_tangent;\r
    layout (location = 3) in vec2 a_texcoord_0;\r
    layout (location = 4) in vec2 a_texcoord_1;\r
    layout (location = 5) in vec2 a_texcoord_2;\r
    layout (location = 6) in vec4 a_joints;\r
    layout (location = 7) in vec4 a_weights;\r
    layout (location = 8) in vec4 a_color;\r
#endif\r
\r
uniform mat4 u_model;\r
uniform mat4 u_viewProjection;\r
uniform mat3 u_normalMatrix;\r
\r
uniform mediump int u_geometryFlags;\r
\r
varying vec2 v_uv[3];\r
varying vec4 v_color;\r
varying vec3 v_position;\r
\r
varying mat3 v_TBN;\r
varying vec3 v_normal;\r
\r
bool checkFlag(int flag) {\r
    return (u_geometryFlags & flag) == flag;\r
}\r
\r
void main(void)\r
{\r
    vec4 pos = u_model * a_position;\r
    v_position = vec3(pos.xyz) / pos.w;\r
\r
    if (checkFlag(HAS_NORMALS)) {\r
        if (checkFlag(HAS_TANGENTS)) {\r
            vec3 normalW = normalize(vec3(u_normalMatrix * a_normal));\r
            vec3 tangentW = normalize(vec3(u_model * vec4(a_tangent.xyz, 0.0)));\r
            vec3 bitangentW = cross(normalW, tangentW) * a_tangent.w;\r
            v_TBN = mat3(tangentW, bitangentW, normalW);\r
        } else { // HAS_TANGENTS != 1\r
            v_normal = normalize(vec3(u_model * vec4(a_normal.xyz, 0.0)));\r
        }\r
    }\r
\r
    if (checkFlag(HAS_UV)) {\r
        v_uv[0] = a_texcoord_0;\r
        v_uv[1] = a_texcoord_1;\r
        v_uv[2] = a_texcoord_2;\r
    } else {\r
        v_uv[0] = vec2(0., 0.);\r
        v_uv[1] = vec2(0., 0.);\r
        v_uv[2] = vec2(0., 0.);\r
    }\r
\r
    if (checkFlag(HAS_COLORS)) {\r
        v_color = a_color;\r
    } else {\r
        v_color = vec4(1.0);\r
    }\r
\r
    gl_Position = u_viewProjection * u_model * a_position;\r
}\r
`},3170:x=>{x.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform float u_weight;\r
uniform sampler2D u_accumulationTexture;\r
uniform sampler2D u_currentFrameTexture;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec4 accumulationColor = texture(u_accumulationTexture, v_uv);\r
    vec4 currentFrameColor = texture(u_currentFrameTexture, v_uv);\r
    fragColor = mix(accumulationColor, currentFrameColor, u_weight);\r
}\r
`},3717:x=>{x.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform sampler2D u_source;\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    fragColor = texture(u_source, v_uv);\r
}\r
`},985:x=>{x.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
uniform vec4 u_srcBounds; // normalized\r
uniform vec4 u_dstBounds; // normalized\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec2 uv = a_vertex * 0.5 + 0.5;\r
\r
    v_uv = mix(u_srcBounds.xy, u_srcBounds.zw, uv);\r
    gl_Position = vec4(a_vertex.xy, 0.0, 1.0);\r
}\r
`},8356:x=>{x.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
const float one255ths = 1.0 / 255.0;\r
\r
vec3 float24x1_to_uint8x3(const in float f) {\r
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\r
    return floor(uint8x3 * 256.0) * one255ths;\r
}\r
\r
vec4 float24x1_to_uint8x4(const in float f) {\r
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\r
    return floor(uint8x4 * 256.0) * one255ths;\r
}\r
\r
const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\r
float uint8x3_to_float24x1(const in vec3 v) {\r
    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\r
}\r
\r
const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\r
float uint8x4_to_float32x1(const in vec4 v) {\r
    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\r
}\r
\r
\r
float linearizeDepth(float zInNDC, float near, float far) {\r
    float zLinear = 2.0 * near;\r
    zLinear /= far + near - zInNDC * (far - near);\r
    return zLinear;\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform sampler2D u_source;\r
\r
uniform int u_mode; /* Debug mode. */\r
uniform vec2 u_linearize; /* [ zNear, zFar ] */\r
\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    vec4 source = texture(u_source, v_uv);\r
\r
    /* u_mode == 0                 None */\r
\r
    if(u_mode == 1) {           /* Depth */\r
        source.rgb = vec3(source[0]);\r
\r
    } else if (u_mode == 2) {   /* DepthLinear */\r
        float zLinear = linearizeDepth(source[0], u_linearize[0], u_linearize[1]);\r
        source.rgb = vec3(zLinear);\r
\r
    } else if(u_mode == 3) {    /* DepthPacked */\r
        source.rgb = float24x1_to_uint8x3(source[0]);\r
\r
    } else if (u_mode == 4) {   /* DepthLinearPacked */\r
        float zLinear = linearizeDepth(source[0], u_linearize[0], u_linearize[1]);\r
        source.rgb = float24x1_to_uint8x3(zLinear);\r
    }\r
\r
    fragColor = source;\r
}\r
`},4965:x=>{x.exports=`precision highp float;\r
precision highp int;\r
\r
/**\r
  To be replaced via Shader.replace();\r
 */\r
#define PROJECTION_TYPE\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform int u_mode;\r
uniform bool u_skipLod;\r
\r
#if defined(CUBE_MAP)\r
    uniform samplerCube u_cubemap;\r
#elif defined(EQUI_MAP)\r
    uniform sampler2D u_equirectmap;\r
#elif defined(SPHERE_MAP)\r
    uniform sampler2D u_spheremap;\r
#elif defined(POLAR_MAP)\r
    uniform sampler2D u_polarmap[2];\r
#endif\r
\r
varying vec2 v_uv;\r
varying vec4 v_ray;\r
\r
\r
const float PI = 3.141592653589793;\r
const float OneOver2PI = 0.1591549430918953357688837633725;\r
const float OneOverPI  = 0.3183098861837906715377675267450;\r
\r
\r
void main(void)\r
{\r
    vec2 uv = v_uv;\r
    vec3 ray = normalize(v_ray.xyz);\r
\r
    #if defined(CUBE_MAP)\r
        #if __VERSION__ == 100\r
            fragColor = u_skipLod ? textureCubeLod(u_cubemap, vec3(ray), 0.0) : textureCube(u_cubemap, vec3(ray));\r
        #else\r
            fragColor = u_skipLod ? textureLod(u_cubemap, vec3(ray), 0.0) : texture(u_cubemap, vec3(ray));\r
        #endif\r
    #endif\r
\r
    #if defined(EQUI_MAP)\r
        float v = acos(-ray.y) * OneOverPI;\r
        float m = atan(-ray.x, ray.z);\r
        uv = vec2(m * OneOver2PI + 0.5, v);\r
\r
        fragColor = texture(u_equirectmap, uv);\r
    #endif\r
\r
    #if defined(SPHERE_MAP)\r
        ray = -ray.xzy;\r
        ray.y *= -1.0;\r
        ray.z += +1.0;\r
        uv = 0.5 + 0.5 * ray.xy / length(ray);\r
\r
        fragColor = texture(u_spheremap, uv);\r
    #endif\r
\r
    #if defined(POLAR_MAP)\r
        ray.xz /= abs(ray.y) + 1.0;\r
        ray.xz = ray.xz * 0.5 + 0.5;\r
        ray.x *= -1.0;\r
\r
        fragColor = mix(texture(u_polarmap[1], ray.xz),\r
                        texture(u_polarmap[0], vec2(1.0, -1.0) * ray.xz),\r
                        step(0.0, ray.y));\r
    #endif\r
}\r
`},8170:x=>{x.exports=`precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    in vec2 a_vertex;\r
#endif\r
\r
\r
uniform mat4 u_viewProjectionInverse;\r
\r
\r
varying vec2 v_uv;\r
varying vec4 v_ray;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex * 0.5 + 0.5;\r
    v_ray = u_viewProjectionInverse * vec4(a_vertex, 1.0, 1.0);\r
\r
    gl_Position = vec4(a_vertex.xy, 1.0 - 1e-6, 1.0);\r
}\r
`},4472:x=>{x.exports=`\r
precision lowp float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
  #define fragColor gl_FragColor\r
#else\r
  layout(location = 0) out vec4 fragColor;\r
#endif\r
\r
\r
uniform float u_weights[32];\r
uniform vec2 u_delta;\r
\r
uniform sampler2D u_texture;\r
\r
varying vec2 v_texCoords;\r
\r
\r
void main()\r
{\r
    vec4 result = u_weights[0] * texture(u_texture, v_texCoords);\r
    for (int i = 1; i <= $KERNEL_HALF_SIZE; i++)\r
    {\r
        result += u_weights[i] * texture(u_texture, v_texCoords + float(i) * u_delta);\r
        result += u_weights[i] * texture(u_texture, v_texCoords - float(i) * u_delta);\r
    }\r
\r
    fragColor = result;\r
}\r
`},1622:x=>{x.exports=`\r
precision lowp float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
#if __VERSION__ == 100\r
  attribute vec2 a_vertex;\r
#else\r
  layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
\r
varying vec2 v_texCoords;\r
\r
\r
void main()\r
{\r
    v_texCoords = a_vertex * 0.5 + 0.5;\r
    gl_Position = vec4(a_vertex, 0.0, 1.0);\r
}\r
`},3643:x=>{x.exports=`\r
precision lowp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    attribute vec2 a_vertex;\r
#else\r
    layout(location = 0) in vec2 a_vertex;\r
#endif\r
\r
\r
varying vec2 v_uv;\r
\r
\r
void main(void)\r
{\r
    v_uv = a_vertex * 0.5 + 0.5;\r
\r
    gl_Position = vec4(a_vertex, 0.0, 1.0);\r
}\r
`},5081:x=>{x.exports=`\r
precision highp float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
const float one255ths = 1.0 / 255.0;\r
\r
vec3 float24x1_to_uint8x3(const in float f) {\r
    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\r
    return floor(uint8x3 * 256.0) * one255ths;\r
}\r
\r
vec4 float24x1_to_uint8x4(const in float f) {\r
    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\r
    return floor(uint8x4 * 256.0) * one255ths;\r
}\r
\r
const vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\r
float uint8x3_to_float24x1(const in vec3 v) {\r
    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\r
}\r
\r
const vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\r
float uint8x4_to_float32x1(const in vec4 v) {\r
    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\r
}\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragDepth gl_FragColor\r
#else \r
    layout(location = 0) out vec4 fragDepth;\r
#endif\r
\r
\r
uniform sampler2D u_texture;\r
uniform vec2 u_offset;\r
uniform vec2 u_scale;\r
\r
varying vec2 v_uv;\r
\r
\r
\r
void main(void)\r
{\r
    vec2 uv = vec2(v_uv.x, 1.0 - v_uv.y) * u_scale + u_offset;\r
    float depth = texture(u_texture, uv).r;\r
\r
    fragDepth = vec4(float24x1_to_uint8x3(depth), 1.0);\r
}\r
`},9761:x=>{x.exports=`precision mediump float;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else \r
    #define varying in\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
    #define fragColor gl_FragColor\r
\r
    #ifdef GL_OES_standard_derivatives\r
        #extension GL_OES_standard_derivatives : enable\r
        #define AASTEP\r
    #endif\r
\r
#else\r
    layout(location = 0) out vec4 fragColor;\r
\r
    #define AASTEP\r
\r
#endif\r
\r
\r
uniform sampler2D u_glyphs;\r
uniform vec4 u_color;\r
uniform float u_aaStepScale;\r
uniform int u_aaSampling;\r
\r
varying vec2 v_uv;\r
\r
const int channel = 0;\r
\r
\r
float aastep(float t, float value)\r
{\r
#ifdef AASTEP\r
    /* float afwidth = length(vec2(dFdx(value), dFdy(value))) * u_aaStepScale; */\r
    float afwidth = fwidth(value) * u_aaStepScale;\r
    /* The aa step scale is more of a hack to provide seemingly smoother (e.g., >= 1.0) or crisper (e.g., between 0.0\r
     * and 1.0) contours without specific sampling. It's just scaling the outcome of the derivatives.\r
     */\r
\r
    return smoothstep(t - afwidth, t + afwidth, value);\r
#else\r
    return step(t, value);\r
#endif\r
}\r
\r
float texStep(float t, vec2 uv)\r
{\r
    /*\r
     * This is a workaround for a known bug in Chrome software rendering (SwiftShader), for updates follow\r
     * https://issuetracker.google.com/u/1/issues/146041290\r
     * Workaround: Storing the result of the texture access into another variable that then is passed as parameter.\r
     */\r
    float distanceValue = texture(u_glyphs, uv)[channel];\r
    return step(t, distanceValue);\r
}\r
\r
float texSmooth(float t, vec2 uv)\r
{\r
    /*\r
     * This is a workaround for a known bug in Chrome software rendering (SwiftShader), for updates follow\r
     * https://issuetracker.google.com/u/1/issues/146041290\r
     * Workaround: Storing the result of the texture access into another variable that then is passed as parameter.\r
     */\r
    float distanceValue = texture(u_glyphs, uv)[channel];\r
    return aastep(t, distanceValue);\r
}\r
\r
#ifdef AASTEP\r
\r
float aastep3h(float t, vec2 uv)\r
{\r
    float x = dFdy(uv.x) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2( -x, 0.0))\r
            + texSmooth(t, uv + vec2(0.0, 0.0))\r
            + texSmooth(t, uv + vec2( +x, 0.0));\r
\r
    return v / 3.0;\r
}\r
\r
float aastep3v(float t, vec2 uv)\r
{\r
    float y = dFdy(uv.y) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2( 0.0,  -y))\r
            + texSmooth(t, uv + vec2( 0.0, 0.0))\r
            + texSmooth(t, uv + vec2( 0.0,  +y));\r
\r
    return v / 3.0;\r
}\r
\r
float aastep3x3(float t, vec2 uv)\r
{\r
    float x = dFdx(uv.x) * 1.0 / 3.0;\r
    float y = dFdy(uv.y) * 1.0 / 3.0;\r
\r
    float v = texSmooth(t, uv + vec2(  -x, -y)) + texSmooth(t, uv + vec2(  -x, 0.0)) + texSmooth(t, uv + vec2(  -x, +y))\r
            + texSmooth(t, uv + vec2( 0.0, -y)) + texSmooth(t, uv + vec2( 0.0, 0.0)) + texSmooth(t, uv + vec2( 0.0, +y))\r
            + texSmooth(t, uv + vec2(  +x, -y)) + texSmooth(t, uv + vec2(  +x, 0.0)) + texSmooth(t, uv + vec2(  +x, +y));\r
\r
    return v / 9.0;\r
}\r
\r
float aastep4x4(float t, vec2 uv)\r
{\r
    float x0 = dFdx(uv.x);\r
    float y0 = dFdx(uv.y);\r
    float x1 = x0 * 1.0 / 8.0;\r
    float y1 = y0 * 1.0 / 8.0;\r
    float x2 = x0 * 3.0 / 8.0;\r
    float y2 = y0 * 3.0 / 8.0;\r
\r
    float v = texSmooth(t, uv + vec2(-x2,-y2)) + texSmooth(t, uv + vec2(-x2,-y1))\r
            + texSmooth(t, uv + vec2(-x2,+y1)) + texSmooth(t, uv + vec2(-x2,+y2))\r
\r
            + texSmooth(t, uv + vec2(-x1,-y2)) + texSmooth(t, uv + vec2(-x1,-y1))\r
            + texSmooth(t, uv + vec2(-x1,+y1)) + texSmooth(t, uv + vec2(-x1,+y2))\r
\r
            + texSmooth(t, uv + vec2(+x1,-y2)) + texSmooth(t, uv + vec2(+x1,-y1))\r
            + texSmooth(t, uv + vec2(+x1,+y1)) + texSmooth(t, uv + vec2(+x1,+y2))\r
\r
            + texSmooth(t, uv + vec2(+x2,-y2)) + texSmooth(t, uv + vec2(+x2,-y1))\r
            + texSmooth(t, uv + vec2(+x2,+y1)) + texSmooth(t, uv + vec2(+x2,+y2));\r
\r
    return v / 16.0;\r
}\r
\r
// vec4 subpix(float r, float g, float b, vec4 fore, vec4 back)\r
// {\r
//     return vec4(mix(back.rgb, fore.rgb, vec3(r, g, b)), mix(back.a, fore.a, (r + b + g) / 3.0));\r
// }\r
\r
#endif\r
\r
void main(void)\r
{\r
    /** @todo mipmap access? */\r
\r
    float a = 0.0;\r
    /* When using multiframe sampling, might not be necessary and even tends to add more blur */\r
#ifdef AASTEP\r
    if(u_aaSampling == 0) {         // LabelRenderPass.Sampling.None\r
#endif\r
\r
        a = texStep(0.5, v_uv);\r
\r
#ifdef AASTEP\r
    } else if(u_aaSampling == 1) {  // LabelRenderPass.Sampling.Smooth\r
        a = texSmooth(0.5, v_uv);\r
    } else if(u_aaSampling == 2) {  // LabelRenderPass.Sampling.Horizontal3\r
        a = aastep3h(0.5, v_uv);\r
    } else if(u_aaSampling == 3) {  // LabelRenderPass.Sampling.Vertical3\r
        a = aastep3v(0.5, v_uv);\r
    } else if(u_aaSampling == 4) {  // LabelRenderPass.Sampling.Grid3x3\r
        a = aastep3x3(0.5, v_uv);\r
    } else if(u_aaSampling == 5) {  // LabelRenderPass.Sampling.Grid4x4\r
        a = aastep4x4(0.5, v_uv);\r
    }\r
#endif\r
\r
    /**\r
     * @todo - design decision: Don't discard fragments?, as we might need them for an id-buffer for\r
     * clicking-interaction. Furthermore, using if-statement and discard can slow down performance:\r
     * it's bad for IMR, TBR, TBDR and early-Z optimization\r
     * https://stackoverflow.com/questions/8509051/is-discard-bad-for-program-performance-in-opengl\r
     */\r
    if(a <= 0.0) {\r
        discard;\r
    }\r
    fragColor = vec4(u_color.rgb, u_color.a * a);\r
\r
    /* use when pre-multiplied color is required. */\r
    /* fragColor = vec4(u_color.rgb * u_color.a * a, u_color.a * a); */\r
}\r
`},1176:x=>{x.exports=`precision mediump float;\r
precision lowp int;\r
\r
\r
#if __VERSION__ == 100\r
    #define texture(sampler, coord) texture2D(sampler, coord)\r
#else\r
    #define varying out\r
#endif\r
\r
\r
\r
#if __VERSION__ == 100\r
\r
#extension GL_EXT_draw_buffers : enable\r
attribute vec2 a_vertex;\r
/* [ texture ll: vec2, ur: vec2 ] */\r
attribute vec4 a_texCoord;\r
attribute vec3 a_origin;\r
attribute vec3 a_tangent;\r
attribute vec3 a_up;\r
\r
#else\r
\r
in vec2 a_vertex;\r
/* [ texture ll: vec2, ur: vec2 ]*/\r
in vec4 a_texCoord;\r
in vec3 a_origin;\r
in vec3 a_tangent;\r
in vec3 a_up;\r
\r
#endif\r
\r
\r
uniform mat4 u_viewProjection;\r
uniform vec2 u_ndcOffset;\r
uniform mat4 u_transform;\r
uniform bool u_dynamic;\r
\r
varying vec2 v_uv;\r
\r
\r
void ndcOffset(inout vec4 vertex, in vec2 offset) {\r
    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\r
}\r
\r
\r
\r
void main(void)\r
{\r
    /* TEXTURE COORDS */\r
\r
    /* flip y-coordinates */\r
    vec2 texExt = vec2(a_texCoord[2] - a_texCoord[0], a_texCoord[1] - a_texCoord[3]);\r
\r
    v_uv = a_vertex * texExt + vec2(a_texCoord[0], 1.0 - a_texCoord[1]);\r
\r
    /* POSITIONING */\r
    /* quad data as flat array: [0, 0,  0, 1,  1, 0,  1, 1] (a_vertex), which translates to ll, lr, ul, ur corners.\r
     * 2-------4\r
     * |  \\    |\r
     * |    \\  |\r
     * 1-------3\r
     * The current vertex is calculated based on the current quad corners and the tangent attributes.\r
     * The following lines are optimized for MAD optimization.\r
     */\r
    vec3 tangentDirection = a_origin + a_vertex.x * a_tangent;\r
    vec4 vertex = vec4(tangentDirection + a_vertex.y * a_up, 1.0);\r
\r
    if(u_dynamic) {\r
        vertex = u_transform * vertex;\r
    }\r
    vertex = u_viewProjection * vertex;\r
\r
    ndcOffset(vertex, u_ndcOffset);\r
    gl_Position = vertex;\r
}\r
`},8632:x=>{x.exports=JSON.parse('{"id":"/ColorScalePresets","title":"Color Scale Presets Schema","description":"JSON schema for a color scale presets data, used in the webgl-operate module for validation.","type":"array","items":{"type":"object","properties":{"identifier":{"type":"string"},"type":{"type":"string","enum":["sequential","diverging","qualitative"]},"format":{"type":"string","enum":["rgb","rgbf"]},"colors":{"type":"array","items":{"type":"array","items":{"type":["integer","number"]}}},"positions":{"type":"array","items":{"type":"array","items":{"type":["integer","number"]}}}},"required":["identifier","format","colors"],"additionalProperties":false}}')},1037:x=>{x.exports=JSON.parse('{"kernel":[[[[0.201114,0.016597],[-0.090682,-0.219471],[-0.180852,0.162495],[0.055216,0.398563],[-0.41692,-0.073573],[0.291284,-0.365369],[0.437182,0.252665],[-0.32675,-0.455539]]]],"size":{"depth":1,"height":1,"width":8}}')},6412:x=>{x.exports=JSON.parse('{"kernel":[[[[-0.992216,-0.610879],[-0.975957,0.625189],[-0.965904,-0.138743],[-0.949645,-0.902675],[-0.933385,0.333393],[-0.923332,-0.430539],[-0.907073,0.805529],[-0.89702,0.0415974],[-0.88076,-0.722335],[-0.864501,0.513733],[-0.854448,-0.250199],[-0.838189,0.985869],[-0.811876,0.221937],[-0.795617,-0.541995],[-0.785564,0.694073],[-0.769305,-0.0698586],[-0.753045,-0.833791],[-0.742992,0.402277],[-0.726733,-0.361655],[-0.70042,0.874413],[-0.684161,0.110482],[-0.674108,-0.65345],[-0.657849,0.582618],[-0.631536,-0.181314],[-0.615277,-0.945246],[-0.605224,0.290822],[-0.588964,-0.47311],[-0.572705,0.762958],[-0.562652,-0.000974417],[-0.546393,-0.764906],[-0.52008,0.471162],[-0.503821,-0.29277],[-0.493768,0.943298],[-0.477509,0.179366],[-0.461249,-0.584566],[-0.451196,0.651502],[-0.434937,-0.11243],[-0.424884,-0.876362],[-0.408624,0.359706],[-0.392365,-0.404226],[-0.382312,0.831842],[-0.366053,0.0679097],[-0.33974,-0.696022],[-0.323481,0.540046],[-0.313428,-0.223886],[-0.297168,-0.987818],[-0.280909,0.24825],[-0.270856,-0.515682],[-0.254597,0.720386],[-0.228284,-0.0435462],[-0.212025,-0.807478],[-0.201972,0.42859],[-0.185713,-0.335342],[-0.169453,0.900726],[-0.1594,0.136794],[-0.143141,-0.627138],[-0.133088,0.60893],[-0.116828,-0.155002],[-0.100569,-0.918934],[-0.0905161,0.317134],[-0.0742567,-0.446798],[-0.0479443,0.78927],[-0.0316849,0.0253379],[-0.021632,-0.738594],[-0.00537252,0.497474],[0.0108869,-0.266458],[0.0209398,0.96961],[0.0371993,0.205678],[0.0635116,-0.558254],[0.079771,0.677814],[0.089824,-0.086118],[0.106083,-0.85005],[0.132396,0.386018],[0.148655,-0.377914],[0.158708,0.858154],[0.174968,0.0942221],[0.191227,-0.66971],[0.20128,0.566358],[0.217539,-0.197574],[0.243852,-0.961506],[0.260111,0.274562],[0.270164,-0.48937],[0.286423,0.746698],[0.302683,-0.0172338],[0.312736,-0.781166],[0.328995,0.454902],[0.339048,-0.30903],[0.355308,0.927038],[0.371567,0.163106],[0.38162,-0.600826],[0.397879,0.635242],[0.424192,-0.12869],[0.440451,-0.892622],[0.450504,0.343446],[0.466763,-0.420486],[0.483023,0.815582],[0.493076,0.0516503],[0.509335,-0.712282],[0.535648,0.523786],[0.551907,-0.240146],[0.56196,0.995922],[0.578219,0.23199],[0.604532,-0.531942],[0.620791,0.704126],[0.630844,-0.0598056],[0.647104,-0.823738],[0.663363,0.41233],[0.673416,-0.351602],[0.689675,0.884466],[0.715988,0.120534],[0.732247,-0.643398],[0.7423,0.59267],[0.758559,-0.171262],[0.774819,-0.935194],[0.784872,0.300874],[0.801131,-0.463058],[0.811184,0.77301],[0.827444,0.0090785],[0.843703,-0.754853],[0.853756,0.481215],[0.870015,-0.282717],[0.896328,0.953351],[0.912587,0.189419],[0.92264,-0.574513],[0.9389,0.661555],[0.955159,-0.102377],[0.965212,-0.866309],[0.981471,0.369759]]]],"size":{"depth":1,"height":1,"width":128}}')},9655:x=>{x.exports=JSON.parse('{"kernel":[[[[-0.058976,0.021042],[0.065636,-0.034686],[0.023064,0.111212],[-0.011378,-0.124856],[-0.122834,-0.069128],[0.155806,0.055484],[-0.170432,0.07677],[-0.101548,0.16694],[0.190248,-0.090414],[0.121364,-0.180584],[0.100078,0.201382],[-0.080262,-0.215026],[-0.247446,-0.0134],[-0.024534,0.25711],[-0.204874,-0.159298],[0.267262,-0.000244],[0.22469,0.145654],[0.031194,-0.270754],[-0.213004,0.222668],[-0.303174,0.132498],[0.245976,-0.236312],[-0.13599,0.312838],[0.177092,0.291552],[-0.157276,-0.305196],[0.31486,-0.146142],[0.04435,0.34728],[-0.337616,-0.10357],[-0.04582,-0.360924],[0.168962,-0.326482],[0.357432,0.089926],[-0.372058,0.042328],[-0.281888,-0.249468],[0.301704,0.235824],[-0.067106,0.403008],[0.40503,-0.055972],[0.078792,-0.416652],[-0.350772,0.278396],[-0.4065,-0.19374],[-0.260602,0.368566],[-0.449072,-0.047842],[-0.22616,-0.395366],[0.13452,0.43745],[0.259132,0.381722],[0.426316,0.180096],[-0.114704,-0.451094],[-0.427786,0.188226],[0.370588,-0.29204],[0.280418,-0.38221],[0.482044,0.034198],[0.447602,-0.20187],[0.009908,0.493178],[-0.358902,-0.339638],[-0.191718,0.458736],[-0.49667,0.098056],[0.391874,0.325994],[0.211534,-0.47238],[-0.483514,-0.28391],[-0.462228,0.334124],[-0.393344,0.424294],[0.336146,0.471892],[-0.31633,-0.485536],[0.41316,-0.437938],[-0.440942,-0.429808],[0.460758,0.416164]]]],"size":{"depth":1,"height":1,"width":64}}')},7456:x=>{x.exports=JSON.parse('[{"identifier":"chrome-63","backend":"webgl2","extensions_strive":["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"]},{"identifier":"edge-41","backend":"webgl1","extensions_strive":["ANGLE_instanced_arrays","EXT_frag_depth","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","OES_texture_half_float","OES_texture_half_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_depth_texture"]},{"identifier":"ie-11","backend":"webgl1","extensions_strive":["ANGLE_instanced_arrays","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info"]},{"identifier":"firefox-57","backend":"webgl2","extensions_strive":["EXT_color_buffer_float","EXT_texture_filter_anisotropic","EXT_disjoint_timer_query","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context","MOZ_WEBGL_lose_context","MOZ_WEBGL_compressed_texture_s3tc"]},{"identifier":"safari-10.1","backend":"webgl1","extensions_strive":["compressed_texture_pvrtc","compressed_texture_s3tc","debug_renderer_info","disjoint_timer_query","draw_buffers","element_index_uint","frag_depth","instanced_arrays","lose_context","sRGB","shader_texture_lod","standard_derivatives","texture_filter_anisotropic","texture_float","texture_float_linear","texture_half_float","texture_half_float_linear","vertex_array_object"],"functions_undefine":["readBuffer"]},{"identifier":"no-WEBGL_draw_buffers","backend":"webgl1","extensions_conceal":["WEBGL_draw_buffers"]},{"identifier":"no-readBuffer","extensions_hash":"100000","functions_undefine":["readBuffer"]},{"identifier":"webgl1","extensions_hash":"1+++++"},{"identifier":"webgl2","extensions_hash":"2+++++"}]')},7318:x=>{x.exports=Vu}},A={};function E(x){var c=A[x];if(c!==void 0)return c.exports;var _=A[x]={exports:{}};return T[x].call(_.exports,_,_.exports,E),_.exports}E.d=(x,c)=>{for(var _ in c)E.o(c,_)&&!E.o(x,_)&&Object.defineProperty(x,_,{enumerable:!0,get:c[_]})},E.o=(x,c)=>Object.prototype.hasOwnProperty.call(x,c),E.r=x=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(x,"__esModule",{value:!0})},E(5254);var P=E(9515);nc.exports=P})();export{nc as w};
//# sourceMappingURL=vendor.d5cd230d.js.map
